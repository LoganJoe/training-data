---
title: " DTOJ1813阅读\t\t"
tags:
  - dp
  - 矩阵
url: 3196.html
id: 3196
categories:
  - DTOJ
  - Solution
date: 2018-07-31 11:14:18
---

先考虑一下dp。记$f\[i\]\[j\]$为权值为$i$，最后一个字母为$j$的单词数。 那么显然有 $$f\[i\]\[j\]\\Rightarrow f\[i+val\[j\]\[k\]\]\[k\]$$ 其中，$val\[i\]\[j\]$是字母$i$和字母$j$之间的差异值。 那么答案就是$\\sum_{i=1}^{n}\\sum_{j=1}^{26}f\[i\]\[j\]$。 发现$n$很大，显然不能这么写。同时发现$val\\leqslant 5$。 这说明能转移到$f\[i\]\[j\]$的最多有$f\[i-1\]\[k\],f\[i-2\]\[k\],f\[i-3\]\[k\],f\[i-4\]\[k\],f\[i-5\]\[k\]$。 最多只有$5\\times 26=130$个数。 那么我们可以用矩阵快速幂来优化转移！ 只要把$f$的两维压成一维即可。 注意到题目要求的是权值$\\leqslant n$的单词数。 因此我们还要新建一个点，让$f\[i\]\[j\]$都向它转移，自身也可以转移。 利用$val\[i\]\[j\]$建出$131\\times 131$的转移矩阵即可。