---
title: " BZOJ2565最长双回文串\t\t"
tags:
  - manacher
url: 5775.html
id: 5775
categories:
  - BZOJ
  - Solution
date: 2018-12-23 21:14:13
---

先在字符串相邻字符的中间插入分割字符，然后用manacher求出以每个点为中心的最长回文串长度$R\_i$。 考虑以哪两个点为中心能组成双回文子串。 假设我们选的中心为$i,j(i<j)$，那么一定要满足$i+r\_i-1\\geq j-r\_j+1$，此时最长的双回文子串的长度（在原串的长度）为$j-i$。也就是说我们要对于每个$i$，求出$\\max\\{j\\}$。 可以发现这是一个二维偏序问题，我们每个位置拆成贡献和查询的两个点，贡献点权值为$i-r\_i+1$，查询点权值为$i+r_i-1$，然后所有点按权值从小到大排序。 扫一遍的同时维护贡献点所属的位置的最大值，扫到查询点的时候更新答案即可。