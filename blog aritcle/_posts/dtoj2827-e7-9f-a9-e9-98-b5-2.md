---
title: " DTOJ2827矩阵\t\t"
tags:
  - 二维树状数组
url: 4345.html
id: 4345
categories:
  - Solution
date: 2018-10-22 19:03:09
---

其实这题并不难想。但是就是$+-$和边界容易搞混然后就跪了。

不过这也并不是坑点。

考虑加上一个子矩阵，可以用二维前缀和拆成四个前缀和。现在我们考虑求$(0,0)$到$(x,y)$这个子矩阵的前缀和。

而在$(a,b)$的位置打上一个$+v$的操作对于$(x,y)$的影响是$(x-a+1)(y-b+1)v$。拆一下，就是$(x+1)(y+1)v-(x+1)av-(y-1)bv+abv$。为了解决询问，我们要维护$v,av,bv,abv$四个值的前缀和。

维护四个二维树状数组，分别存$v,av,bv,abv$的前缀和，就可以解决修改和询问。

但是一开始以为只要开1个二维树状数组。结果$4n^2$根本卡不过去。

不过模数$p \\in \[1,256\]$。于是可以用$\[1,256\]的unsigned char直接写过去。

坑爹啊。