---
title: " DTOJ1994序列分割\t\t"
tags:
  - 斜率dp
url: 2601.html
id: 2601
categories:
  - DTOJ
  - Solution
date: 2018-06-25 08:32:21
---

元素和的乘积等于元素乘积和。因此分割的得分和分割的顺序无关，只和分割的位置有关。 容易想到dp，记$f\[i\]\[j\]$为前$i$个数分成$j$段的最大得分。 那么枚举上一段的末尾$k$，有 $$f\[i\]\[j\]=max_{k=1}^{i-1}\\{f\[k\]\[j-1\]+Sum\[k\](Sum\[i\]-Sum\[k\])\\}$$ 其中，$Sum\[i\]$为前$i$个数的和。 把式子拆开，有 $$f\[i\]\[j\]=max_{k=1}^{i-1}\\{f\[k\]\[j-1\]+Sum\[k\]Sum\[i\]-Sum\[k\]^2\\}$$ 在最外层枚举$j$，那么有 $$f'\[i\]=max_{k=1}^{i-1}\\{f\[k\]+Sum\[k\]Sum\[i\]-Sum\[k\]^2\\}$$ 容易发现这是一个斜率的式子。我们将$f'\[i\]$看作$b$，$-Sum\[i\]$看作$k$，$(Sum\[k\],f\[k\]-Sum\[k\]^2)$看成点，那么就是要最大化截距。 $k$和$x$都是单调的，因此拿单调队列维护凸包即可。