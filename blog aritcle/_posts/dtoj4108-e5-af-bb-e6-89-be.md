---
title: " DTOJ4108寻找\t\t"
tags:
  - 凸包
  - 分块
url: 6910.html
id: 6910
categories:
  - DTOJ
  - Solution
date: 2019-03-09 21:57:09
---

不妨认为$S\_i\\leq T\_i$。 先把无解的情况判掉：$k\_i<T\_i-S\_i$和$k\_i-T\_i+S\_i$为奇数。 记$dist\_i$为$\\sum\\limits\_{j=1}^{i-1}d\_j$，即点$1$走到点$i$的距离。 显然$dist\_{T}-dist\_S$这段路径是必须要走的，我们还剩下$t=k\_i-T\_i+S\_i$要在某些路上随便走。也就是我们要最小化这$t$时刻内走过的路程。 先考虑在$\[S,T\]$中间某段路随便走，由于我们一定会经过每一段路，因此在走到最短的路的时候多来回走$t$时刻即可。我们可以用一个ST表预处理区间最小值，这样就可以$\\Theta(1)$找到$\[S,T\]$中的最小值了。 再考虑在$\[1,S)$中间某段路随便走，显然我们是从$S$向左走到某段路，然后来回走，接着直接走到$T$。 不妨假设在$p$与$p+1$来回走，那么我们来回走的时间就是$t-2(S-p)$。 这样走过的路程是$2(dist\_S-dist\_p)+\[t-2(S-p)\]d\_p$。 化简一下就是$2dist\_S-2dist\_p+(t-2S)d\_p+2p\\cdot d\_p$。 显然$2dist\_S$也是独立的，我们考虑最小化$2p\\cdot d\_p-2dist\_p+(t-2S)d\_p$。 我们将$(d\_p,2p\\cdot d\_p-2dist\_p)$看成平面上的一个点，$2S-t$为斜率，那么问题就变成了斜率固定的直线去过一个点使得纵截距最小。 显然可能最优的点在下凸壳上。 考虑分块，对每块的点建出一个下凸壳，然后查询在凸壳上二分。 时间复杂度$\\Theta(m\\sqrt{n}\\log \\sqrt{n})$，不够优秀。 我们离线询问，将询问按斜率排序，这样在凸壳上取的最优点就是单调的了，就不用二分了。 时间复杂度$\\Theta(m\\sqrt{n})$。 还有一种情况是在$(T,n\]$中间某段路随便走的，这种和在$\[1,S)$随便走的一样，我们可以将整个数轴reverse一下再做一遍就好了，这样就不用再写一遍了（雾）。