---
title: " DTOJ3584矩阵\t\t"
tags:
  - dp
url: 1237.html
id: 1237
categories:
  - DTOJ
  - Solution
date: 2018-03-24 23:01:38
---

先化简一下式子，所求的是 $$(n+m-1)\\sum_{i=1}^{n+m-1}(A\_i-A\_{avg})^2$$ $$(n+m-1)\\sum_{i=1}^{n+m-1}{A\_i}^2+{A\_{avg}}^2-2A\_iA\_{avg}$$ 即 $$(n+m-1)\\sum_{i=1}^{n+m-1}{A\_i}^2+\\frac{(\\sum\_{j=1}^{n+m-1}A\_j)^2}{(n+m-1)^2}-\\frac{2A\_i\\sum_{j=1}^{n+m-1}A\_j}{n+m-1}$$ $$\\sum\_{i=1}^{n+m-1}(n+m-1){A\_i}^2+\\frac{(\\sum\_{j=1}^{n+m-1}A\_j)^2}{n+m-1}-2A\_i\\sum_{j=1}^{n+m-1}A\_j$$ $$\\sum\_{i=1}^{n+m-1}(n+m-1){A\_i}^2+(\\sum\_{i=1}^{n+m-1}A\_i)^2-2(\\sum\_{i=1}^{n+m-1}A\_i)^2$$ $$\\sum\_{i=1}^{n+m-1}(n+m-1){A\_i}^2-(\\sum\_{i=1}^{n+m-1}A\_i)^2$$ 发现$\\sum\_{i=1}^{n+m-1}A\_i\\leqslant 3000$。 那么我们可以将$\\sum\_{i=1}^{n+m-1}A\_i$记到状态里面，$\\sum\_{i=1}^{n+m-1}{A_i}^2$用值存起来。 记用$f\[i\]\[j\]\[k\]$表示走到$(i,j)$经过数的和为$k$时最小的经过的数平方的和。直接转移即可。 答案就是$min((n+m-1)f\[n\]\[m\]\[i\]-i^2)$。