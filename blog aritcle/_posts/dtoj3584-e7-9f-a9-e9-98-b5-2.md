---
title: " DTOJ3584矩阵\t\t"
tags:
  - dp
url: 1841.html
id: 1841
categories:
  - Solution
date: 2018-04-30 20:10:23
---

原创题。 我们来看看要我们求什么： $$(n+m-1) \\sum_{i=1}^{n+m-1} {(A\_i-A\_{avg})^2}$$ Sub1 30% 把所有的路径深搜出来取最优，复杂度是$O(TC(2N,N)N)$ 这道题乍一看像是dp，但是问题在于因为求的是方差与平均数有关，每一步的代价似乎不能直接得出。 Sub2 40% 对于另外40%的数据，我们发现路径$A\_i$和$SN$不超过$120$，考虑枚举$SN$，平均值为$av=SN/N$$（N=n+m-1）$，那我们就能得到每一步的代价，但是要保证求的路径符合$A\_i$和为$SN$，设计$f(s,i,j)$表示到$(i,j)$，和为$s$的最小代价 $f(s,i,j)=min{f(s-a\[i\]\[j\],i,j-1),f(s-a\[i\]\[j\],i-1,j)}+(av-a\[i\]\[j\])^2$ 复杂度是$O(T\*SN^2\*n^2)$ Sub3 30% 事实上，路径$A\_i$和不等于$SN$也无所谓，因为对于一条路径，只有我们枚举的$SN$等于路径$A\_i$和时，这条路径的方差才最小。 设我们枚举的$SN$比真实的$A\_i$和小$E$,$E$是任意实数。很容易证明$\\sum(A\_i-A_{avg})^2<\\sum(A\_i-av+E)^2$ 所以直接去掉dp的第一维，复杂度是O(T\*SN\*n^2),可以通过100%的数据 还有另外一种思路，把求方差的式子展开,得到$N*\\sum(A\_i^2)-SN^2$，设计$f(s,i,j)$表示到$(i,j)$，和为$s$的最小的$N*\\sum(A_i^2)$，最后枚举$s$取$f(s,i,j)-s^2$的最小值，复杂度也是$O(T\*SN\*n^2)$