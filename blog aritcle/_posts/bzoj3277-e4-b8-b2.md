---
title: " BZOJ3277串\t\t"
tags:
  - 后缀自动机
url: 5782.html
id: 5782
categories:
  - BZOJ
  - Solution
date: 2018-12-23 22:23:52
---

BZOJ3473字符串是双倍经验。 将所有串建广义后缀自动机。 我们考虑求后缀自动机上的每个结点在几个串中出现过，记为$cnt\[i\]$。 对于每个串，我们要将它所有子串对应的点的次数都$+1$，即每个前缀在parent树上对应的点到根的所有点都要被$+1$。 对于每个前缀，我们暴力在parent树上跳，然后给$cnt+1$，同时打个标记记录当前这个串是否已经加过，避免重复计算。 这样我们就可以知道哪些点代表的子串出现了至少$k​$次，记这样的点的点权为这个点代表的子串的个数，其他的点点权为$0​$。 我们只要统计每个串的所有子串对应的点中点权的和即可。即根到每个前缀在parent树上对应的路径点权和的和。 我们预处理出parent树上根到每个点经过的路径的点权和即可。