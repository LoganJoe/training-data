---
title: " DTOJ4076二分查找\t\t"
tags:
  - dp
  - 思路
url: 5567.html
id: 5567
categories:
  - DTOJ
  - Solution
date: 2018-12-16 16:47:22
---

考虑最普通的区间dp。 记$f\[i\]\[j\]$为当前二分区间为$\[i,j\]$时，最优决策下最坏的代价。 我们枚举这次$mid$要取那个，就可以得到转移： $$ f\[i\]\[j\]=\\min_{k=i}^j\\{\\max(f\[i\]\[k-1\],f\[k+1\]\[j\])+b\_k\\} $$ 时间复杂度$\\Theta(n^3)$。 考虑优化。 注意到$1\\leq b\_i\\leq 9$。那么一定有$f\[i\]\[j\]\\leq 9\\log n$。并且$f\[i\]\[j\]$关于$j$单调不降。 那么我们可以考虑另一种dp方式。 记$g\[i\]\[j\]$为区间左端点为$i$，代价为$\\leq j$，区间右端点最远能到哪里。 我们可以枚举新取的$mid$对应的$b$值$k$，然后在找到$g\[i\]\[j\]+1$左边第一个$k$的位置$p$，那么就有 $$ g\[i\]\[j+k\]=\\max(g\[i\]\[j+k\],g\[p+1\]\[j\]) $$ 时间复杂度$\\Theta(9^2n\\log n)$。离正解就差一点点了。 我们发现，当$j$不变时，$g\[i\]\[j\]$关于$i$单调不降。 也就是说，$g\[i\]\[j\]$能转移的$mid$，$g\[i+1\]\[j\]$再转移一次没有意义。只需要令$g\[i\]\[j\]=\\max(g\[i\]\[j\],g\[i-1\]\[j\])$即可。 那么转移$g\[i+1\]\[j\]$时，我们只用枚举$mid$在$\[g\[i\]\[j\]+2,g\[i+1\]\[j\]+1\]$的情况即可。 这样对于同一个$j$，$mid$只会从$1$到$n$一次。那么时间复杂度就是$\\Theta(9n\\log n)$。