---
title: " DTOJ3626a\t\t"
tags:
  - 点分治
url: 1476.html
id: 1476
categories:
  - DTOJ
  - Solution
date: 2018-04-15 14:54:18
---

一个炸弹会对距离它距离$<power$的点有贡献，这种限制距离的问题常用点分治解决。 考虑点分治。 对于一个重心$x$，我们要处理出每个子树对其他子树的贡献。我们可以先算出将所有炸弹移到重心上还剩下的威力值。记$Sum\_i$为威力值$\\geqslant i$的威力值总和，$cnt\_i$为威力值$\\geqslant i$的个数。对于一个距离重心为$d$的点，所有炸弹对它的贡献就是$Sum\_d-dcnt\_d$。 这样会多算一个子树对子树内的点的贡献。单独考虑每个子树的炸弹，把贡献减去即可。