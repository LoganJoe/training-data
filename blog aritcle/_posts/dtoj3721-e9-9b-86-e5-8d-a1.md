---
title: " DTOJ3721集卡\t\t"
tags:
  - 期望
  - 概率dp
url: 2035.html
id: 2035
categories:
  - DTOJ
  - Solution
date: 2018-05-22 07:41:19
---

记$f\[i\]\[j\]$为现在有$i$种卡，没用的卡（就是每种卡多余的）有$j$张，集齐$n$种卡的期望时间。显然我们要求的是$f\[s\]\[0\]$。 记$g\[i\]\[j\]$为现在有$i$种卡，赢一盘游戏能得到$j$种没有的卡的概率。为了求出$g\[i\]\[j\]$，我们还得设计一个$h\[i\]\[j\]\[k\]$表示现在有$i$种卡，抽$j$张卡得到$k$种没有的卡的概率。 显然有 $$h\[i\]\[j\]\[k\]\\times \\frac{i+k}{n}\\rightarrow f\[i\]\[j+1\]\[k\]$$ $$h\[i\]\[j\]\[k\]\\times \\frac{n-i-k}{n}\\rightarrow f\[i\]\[j+1\]\[k+1\]$$ 显然$g\[i\]\[j\]$就是$h\[i\]\[k\]\[j\]$。 现在考虑如何求$f\[i\]\[j\]$。 我们可以枚举赢一盘游戏得到没有的卡的种类数$x$，然后枚举我们要换几种卡。 那么有 $$f\[i\]\[j\]=\\frac{1}{p\_i}\\sum\_{x=0}^{k}min_{y=0}^{\\lfloor \\frac{y+k-x}{d}\\rfloor}\\{f\[i+x+y\]\[y+k-x-yd\]\\}$$ 记忆化搜索，转移即可。