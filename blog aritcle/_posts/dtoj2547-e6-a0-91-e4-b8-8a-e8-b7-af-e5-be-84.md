---
title: " DTOJ2547树上路径\t\t"
tags:
  - 可持久化线段树
  - 树链剖分
url: 3531.html
id: 3531
categories:
  - DTOJ
  - Solution
date: 2018-08-24 17:33:42
---

很容易想到树链剖分+主席树。我们以时间轴可持久化，树剖序作为下标建主席树。 查询就是在每个重链区间中二分第$k$个没被攻击的城市。 细节很多。 比如要先在$a$到$LCA(a,b)$的路径上找，然后再在$LCA(a,b)$到$b$的路径上找。 在线段树上二分还有先走左儿子还是右儿子的区别。 以及正常的写法会把$a,b$一起考虑进去，为了消除$a,b$的影响，我们可以判断一下$a,b$有没有被攻击过，然后将$k++$或总个数$- -$。