---
title: " DTOJ4124原样输出\t\t"
tags:
  - 后缀自动机
  - 思路
url: 6499.html
id: 6499
categories:
  - DTOJ
  - Solution
date: 2019-02-20 21:31:09
---

当$n=1$时，答案就是这个串的本质不同的子串数量。 考虑拓展到$n>1$的情况。 我们知道，后缀自动机是一个可以识别一个串的所有子串的自动机，并且自动机上从起点出发的每条路径都对应着一个不同的子串。 那我们是否能构造出一个自动机，使得它能识别本题所有可能的输出，并且每种输出都和某个东西对应（比如说路径），这样我们就可以计数了。 我们考虑如何判断一个输出是否合法。 显然我们可以依次在输入的每个字符串中匹配，每次如果在当前字符串中找不到合法匹配后，我们就在下一个字符串中找。 后缀自动机上的匹配是沿着转移边走的，那么我们可以从修改转移边入手。 具体地，我们对于每个串都建出一棵SAM，如果某个SAM上的某个点没有字符$c$的转移边，那么我们就给这个点新建一条字符$c$的转移边，连向后面第一个出现字符$c$的串的SAM上字符$c$对应的节点。 这样的话，所有可能的输出都可以被识别，并且每种输出也对应着从起点出发的一条路径。 那么通过统计路径数就可以求出输出的可能情况数量。 然后按字典序爆搜路径就可以输出方案了。