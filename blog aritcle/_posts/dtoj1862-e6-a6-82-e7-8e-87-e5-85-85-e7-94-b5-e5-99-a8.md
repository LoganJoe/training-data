---
title: " DTOJ1862概率充电器\t\t"
tags:
  - 树形dp
url: 1940.html
id: 1940
categories:
  - Solution
date: 2018-05-11 16:24:16
---

我们考虑一个点不能被充电的概率。 设$f\_i$为节点$i$的子树中，不能给节点$i$充电的概率(包含它本身不通电),$g\_i$为$i$的父节点不能给他充电的概率。 很显然的，$f\_i$有$f\_u*=1-(1-f\_v)*e\[i\].p$,p为这条边不通电的概率。接下来我们考如何求$g\_i$. 我们设我们设res为u除去v这个点连通的概率，那么$res=1−f\_u/(1−(1−f\_v)∗e\[i\].p)$。于是$g\_v=g\_v \\times 1−res∗e\[i\].p$。 最后的答案为$\\sum 1-f\_i\\times g\_i$。