---
title: " DTOJ1226网络管理\t\t"
tags:
  - 树套树
url: 3375.html
id: 3375
categories:
  - DTOJ
  - Solution
date: 2018-08-12 15:30:07
---

树上第$k$大带修改，树套树模板题。 对于树上$a$到$b$的路径信息，我们可以用根到$a$，根到$b$，根到$LCA(a,b)$和根到$fa\[LCA(a,b)\]$四条路径的信息加减来得到。 那么我们就是要维护根到每个点的路径信息，而在这题，信息就是每种权值的点有多少个。 先求出树的dfs序，然后一个点的权值的修改，会影响到它子树里每个点的信息。即原来的权值个数$-1$，新的权值个数$+1$。 那么对于dfs序上的每个点，我们开一棵权值线段树来维护每种权值的个数，修改就是对一段区间内的每棵线段树的某个位置修改。 可以写线段树套线段树，也可以写树状数组套线段树。 时间复杂度$\\Theta(n\\log^2n)$。 据说有$\\log^3$的写法，跑的好像还更快。