---
title: " DTOJ1051画方框\t\t"
tags:
  - 思路
url: 1122.html
id: 1122
categories:
  - DTOJ
  - Solution
date: 2018-03-20 19:28:50
---

显然方框的左上角和右下角是在同一条对角线上的，那么我们考虑枚举对角线，对于每条对角线计算顶点在上面的方框数。 首先预处理每个点，向上/下/左/右连续的$1$的长度。 对于对角线上的每个点，如果以它为左上角，那么右下角只能在它向右和向下的长度的$min$的范围中。同样以它为右下角，同样会限制左上角的范围。每个点限制的范围都是对角线上的一段区间，而区间又分为询问区间和贡献区间。询问就是询问和这段区间相交的贡献区间的个数，顶点在这条对角线上的方框数就是所有询问的和。 区间相交是一个二位偏序问题，排序+树状数组即可。