---
title: " DTOJ4099yjqa\t\t"
tags:
  - dp
  - 单调队列
  - 线段树
url: 5983.html
id: 5983
categories:
  - DTOJ
  - Solution
date: 2019-01-04 17:17:15
---

考虑dp。 记$f\[i\]$为送完前$i$个人且电梯停在$0$层的最短时间。 我们枚举最后一趟送了哪些人，有 $$f\[i\]=\\min_{j=0}^{i-1}\\{\\max(f\[j\],T\_i)+\\max\_{k=j+1}^{i}\\{A\_k\\}\\}$$ 我们用单调栈维护$\\max\_{k=j+1}^{i}\\{A\_k\\}$，同时再用一棵线段树对于每个$j$维护$f\[j\]+\\max\_{k=j+1}^{i}\\{A\_k\\}$以及$\\max\_{k=j+1}^{i}\\{A\_k\\}$的区间最小值。即我们在修改单调栈的同时在线段树上区间修改。 由于$f\[i\]$是单调不降的，因此我们在求$f\[i\]$时，先二分出最大的满足$f\[p\]\\leq T\_i$的$p$，然后找到$\[1,p\]$中$\\max_{k=j+1}^{i}\\{A\_k\\}$的最小值，用$T\_i+\\max_{k=j+1}^{i}\\{A\_k\\}$更新$f\[i\]$。再找到$\[p+1,i-1\]$中$f\[j\]+\\max\_{k=j+1}^{i}\\{A_k\\}$的最小值去更新$f\[i\]$。 $f\[n\]$就是答案。 时间复杂度$\\Theta(n\\log n)$。