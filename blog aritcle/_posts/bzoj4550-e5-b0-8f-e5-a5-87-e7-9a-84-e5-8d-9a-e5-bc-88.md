---
title: " BZOJ4550小奇的博弈\t\t"
tags:
  - dp
  - 博弈
url: 6283.html
id: 6283
categories:
  - BZOJ
  - Solution
date: 2019-01-29 16:04:12
---

我们先考虑$k=2$的情况。 如果白棋往左或者黑棋往右，那么另一方可以跟着走，这样间隔不变，是没有意义的。 所以白棋只会往右，黑棋只会往左。 那么只要一开始棋子没有相邻先手就必胜了。 考虑转换问题。 局面只和棋子的间隔有关，每次我们可以减少$1\\sim d$对棋子的间隔。 我们把间隔看作石子堆，那么我们有$\\frac{k}{2}$堆石子，每次我们可以拿出$1\\sim d$堆中的若干个石子。 这是经典的Nimk游戏。 结论：先手必败当且仅当对于每一个二进制位，这位为$1$的石子堆数$\\%(d+1)$都$=0$。 我们可以求出先手必败的方案数，然后用总方案数$\\binom{n}{k}$去减。 我们考虑dp。 记$f\[i\]\[j\]$为考虑完了二进制的前$i$位，一共有$j$个石子，先手必败的方案数。 我们枚举有多少堆石子下一个二进制位为$1$即可转移。 具体地 $$ \\binom{\\frac{k}{2}}{s\\cdot (d+1)}\\cdot f\[i\]\[j\]\\Rightarrow f\[i+1\]\[j+s\\cdot (d+1)\\cdot 2^i\] $$ 先手必败的方案数就是 $$ \\sum_{i=0}^{n-k}\\binom{n-i-\\frac{k}{2}}{\\frac{k}{2}}\\cdot f\[m\]\[i\] $$ 其中$m$是$n-k$的二进制位数。