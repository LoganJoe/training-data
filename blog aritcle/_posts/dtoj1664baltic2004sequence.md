---
title: " DTOJ1664[Baltic2004]sequence\t\t"
tags:
  - 可并堆
  - 贪心
url: 952.html
id: 952
categories:
  - DTOJ
  - Solution
  - 不会证
date: 2018-03-06 13:08:38
---

题目要求的是上升序列，用很常见的技巧令$a\_i=a\_i-i$。这样就可以变成求不下降序列了。 如果序列$a$是不下降的，那么令$b\_i=a\_i$，答案最优。 如果序列$a$是下降的，那么令所有的$b\_i$等于所有$a\_i$的中位数，答案最优。 那么我们可以想到，将序列分为若干段下降部分，每部分都取中位数，使得最后求出的序列不下降并且答案最优。不下降序列可以拆成若干段长度为$1$的下降序列。 对于每一个序列中的数，从左到右依次考虑每一个数。一开始令它单独成一段，然后判断和前一段合并是否会更优。贪心地想，只有前一段中位数比当前这段中位数大时合并才会更优。 具体证明请看[这](https://wenku.baidu.com/view/20e9ff18964bcf84b9d57ba1.html)。我不会证。 那我们现在只要维护序列的中位数，并且支持合并。单个序列的中位数可以用堆来维护，又要支持合并的话用可并堆就好了。 由于合并完后中位数会变小，因此只能用大根堆维护中位数，用小根堆可能出现合并后中位数不在堆中的情况。