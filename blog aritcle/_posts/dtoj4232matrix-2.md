---
title: " DTOJ4232matrix\t\t"
tags:
  - 思路
url: 7088.html
id: 7088
categories:
  - Solution
date: 2019-03-24 09:42:21
---

考虑怎么暴力求出子矩阵价值和。考虑暴力枚举子矩阵的左右边界，考虑任意一个上下边界对于答案的贡献。

首先考虑将这一行看做整体考虑，维护​表示这一行前面第一个和他相同的行的位置。我们将贡献算到子矩阵第一次出现的行中，那么当前行做贡献，当且仅当上边界在​且下边界在​中。那么其贡献就是​。

考虑快速维护​。固定左边界，考虑右边界后推。那么对于原来​形成的一条链，也即行相同的一组，会因为右字符变化而变成多组。此时一组内的行在前面字符完全相同，仅在最后一个字符不同，那么判定相等就是​的了。那么我们暴力更新一组内的所有pre即可。

这样写时间复杂度是​的，显然不能通过​较大的数据。

考虑不枚举左右边界：我们仅枚举左边界，然后用一个指针维护任意两行第一个不同的位置。那么这样，对于当前​的合法右端点就知道了。由于​仅有​种取值，所以这样维护时间复杂度是​的。

上面两种方法均无法通过所有数据。我们规划一下：对于​的情况用​的做法；对于​的情况用​的做法。那么假设​, 其时间复杂度就是​或更优的。