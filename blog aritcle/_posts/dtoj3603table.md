---
title: " DTOJ3603table\t\t"
tags:
  - 数学
url: 1353.html
id: 1353
categories:
  - DTOJ
  - Solution
date: 2018-04-07 16:07:29
---

先考虑在$p$行下面的数。假如我们要求$f_{x,y}(x>p)$。 考虑第$p$行每个数对$f_{x,y}$的贡献。可以看作初始在第$p$行上有一个值，往下走把值$\\times a$，往右下走把值$\\times b$。那么有 $$f_{x,y}=\\sum_{i=1}^{y}f_{p,i}a^{(x-p)-(y-i)}b^{y-i}\\binom{x-p}{y-i}$$ 显然只有满足$x-p\\geqslant y-i$的$i$有意义。那么就可以在$\\Theta(n)$内完成在$p$行下面的询问。 再考虑在$p$行上面的数。还是假如要求$f_{x,y}(x<p)$。 类似之前的思路，考虑第$p$行每个数对$f_{x,y}$的贡献。可以看作初始在第$p$行上有一个值，往上走把值$\\div a$，往右走把值$\\times(-\\frac{b}{a})$。那么有 $$f_{x,y}=\\sum_{i=1}^{y}\\frac{f_{p,i}(-b)^{y-i}\\binom{p-x+y-i-1}{y-i}}{a^{p-x+y-i}}$$ 同样可以在$\\Theta(n)$内完成在$p$行上面的询问。 注意预处理的某些数组要开到$m$的大小，不想开到这么大也可以每次用的时候重新算。