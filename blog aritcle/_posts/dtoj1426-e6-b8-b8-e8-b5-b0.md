---
title: " DTOJ1426游走\t\t"
tags:
  - 高斯消元
url: 471.html
id: 471
categories:
  - Solution
date: 2018-02-04 13:21:13
---

那个期望是唬人的。很容易想到，对于走到概率较高的边，让它的边权尽量小就可以了。 那么在计算走到边的概率之前，我们先思考如何计算点的概率。 很容易写出式子：

$p\_i=\\sum p\_jdeg_j$

其中，$deg\_i$为该点的度。 由于最后一个点到达就不会出来，那么移项，我们可以得到一个n-1个n-1元的线性方程组。需要注意的是，对于第一个点，到达的概率要先加上1，因为我们是在点1出发的。 然后我们可以构造一个矩阵，通过高斯消元解出$p\_i$。 那么边（u，v）的概率计算就由下式得到：

$P_{uv}=p\_u deg\_u+p\_v deg\_v$

然后贪心计算即可。