---
title: " DTOJ2558基因串模糊比对\t\t"
tags:
  - FFT
  - 卷积
url: 1174.html
id: 1174
categories:
  - DTOJ
  - Solution
date: 2018-03-21 22:58:40
---

FFT还能拿来做字符串匹配…服了。 先了解一下FFT求字符串匹配的方法，从一般的匹配开始，也就是$k=0$的情况。 $S$串从第$i$位开始和$T$串匹配的个数为 $$\\sum_{j=1}^{m}\[s_{i+j-1}=t\_j\]$$ 如果将其中一个串翻转，比如说$T$串，那么就变成了 $$\\sum\_{j=1}^{m}\[s_{i+j-1}=t_{m-j+1}\]$$ 这是一个卷积的形式。那么我们枚举字符集，每次把当前字符的位置对应的多项式系数赋为$1$，然后把代表$S$串和$T$串的多项式相乘，第$i+m$项的系数就是$S$串从第$i$位开始和$T$串匹配的当前这个字符的个数。枚举完所有字符，看看每个位置匹配的个数总和是否为$T$串的长度就知道$S$串从这个位置开始能不能和$T$串匹配了。 再来看看这题。 $S$串的第$i$位能和$T$串的第$j$位匹配的条件是，$s_{i-k\\sim i+k}$其中一个和$t\_j$相同。 那么我们同样枚举字符集，比如说现在枚举到$A$。 若$s\_i=A$，那么说明$S$串的$\[i-k,i+k\]$都能和$T$串的$A$匹配上。那我们对于$S$串的每个$A$，把前后$k$个位置对应的多项式系数都赋为$1$，拿去和翻转后的$T$串的多项式相乘，就可以知道每个位置开始匹配的次数了。 把每次的匹配次数相加就知道有没有匹配上了。