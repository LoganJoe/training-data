---
title: " DTOJ2582Little Elephant and Boxes\t\t"
tags:
  - dp
  - 折半搜索
url: 810.html
id: 810
categories:
  - Solution
date: 2018-02-26 21:36:19
---

我们考虑一个dp，f\[i\]\[j\]\[k\]表示前i个物品取j个，花费k个钻石所需要的最小钱数。这个dp很显然可以通过一个$O(m^3)$的转移得到：f\[i\]\[j\]\[k\]为当前状态，则$$f\[i\]\[j+1\]\[k+s\[i\].d\]=min(f\[i\]\[j+1\]\[k+d\_i\],f\[i-1\]\[j\]\[k\]+c\_i)$$ 那么我们考虑计算期望。由于n也很小，那么我们折半搜索，分别搜出前后可能的方案。 之后我们先将所有方案按照使用钻石数量分类，那么我们可以枚举左右两边共买i个物品，各花费a，b个钻石，很明显所需要的最小钱数为f\[m\]\[i\]\[a+b\].那么我们分别在两边各花费a个钻石和b个钻石中找方案，所得到钱数大于等于f\[m\]\[i\]\[a+b\]的方案均可被计入答案。由于这个满足独立可加性，我们维护一个单调指针便可以很快的查询出相应的方案数量。对于一部分方案，在dfs的时候即可计算出达到这个方案的概率，那么最后答案便可以累积计算出来。 由于不知道每种钻石对应的方案数多少种，因此，对于每种钻石，储存方案数的数组都要开的够大。