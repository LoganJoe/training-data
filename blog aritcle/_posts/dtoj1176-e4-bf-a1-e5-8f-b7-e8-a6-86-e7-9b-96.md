---
title: " DTOJ1176信号覆盖\t\t"
tags:
  - 思路
url: 2595.html
id: 2595
categories:
  - DTOJ
  - Solution
date: 2018-06-21 19:13:10
---

最终的答案是$3+\\frac{所有圆包含的点数}{\\binom{n}{3}}$。 画画图可以发现，所有圆包含的点数是凸四边形个数$\\times 2+$凹四边形个数。 因为三点确定一个圆，然后此时加入第四个点。如果形成的是凸四边形，那么四个点形成的四种圆，有两种会包含一个点，因此对答案有$2$的贡献。如果形成的是凹四边形，那么只有一种圆会包含一个点，因此对答案有$1$的贡献。 凸四边形个数$+$凹四边形个数就是总的四边形个数，即$\\binom{n}{4}$。 那么考虑如何求凸多边形个数。 好像不是很好求，我们可以改成求凹四边形个数。 枚举凹多边形的凹点$A$，和与$A$右边的另一个点$B$。那么剩下两个点只要在直线$AB$的不同侧就合法了。 再转化一下，从所有的情况中减去在同侧的情况数即可。 那么我们按极角排序后，对于每条$AB$，找到最远的$C$，使得$∠BAC<180°$，这样在$B,C$中间的点中任取两个点都是在同侧的情况，减去即可。 显然对于同一个$A$，按顺序枚举$B$，$C$就是单调的。 因此时间复杂度为$\\Theta(n^2\\log n)$，瓶颈在排序上。