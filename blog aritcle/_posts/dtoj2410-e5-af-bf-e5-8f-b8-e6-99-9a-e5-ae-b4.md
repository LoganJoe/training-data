---
title: " DTOJ2410寿司晚宴\t\t"
tags:
  - 奇技淫巧
  - 状压dp
url: 2437.html
id: 2437
categories:
  - DTOJ
  - Solution
date: 2018-06-15 09:50:12
---

和[DTOJ3754Bilibili Summer Camp](http://www.dtenomde.com/2018/06/author=jiangyutong/article=2366/)方法相同。 和谐的方案即两人选的数里的质因子没有重复的。那么也就是说对于每个质因子，最多只能被一个人选择。 我们按$\\sqrt{n}$把质因子分成两类。 对于$\\leqslant \\sqrt{n}$的质因子，我们可以状压起来。即记$f\[i\]\[j\]$为第一个人选的质因子状态为$i$，第二个人选的质因子状态为$j$的方案数。显然$i\\&j=0$。对于只含这类质因子的数，我们可以直接拿去跑dp，即枚举这个数是被第一个人选了还是第二个人选了，或者是都没选来转移。 对于$>\\sqrt{n}$的质因子，显然每个数最多只能包含一个。对于含这类质因子的数，我们按最大质因子给这些数分类。显然一类中只能有一个数被第一个人选或第二个人选，或者都不选。一类数一起跑dp即可。 有点类似背包。因为实际还有一维是维护选了几个数，但是空间可以压掉。