---
title: " DTOJ2055孤独一生\t\t"
tags:
  - dp
  - 奇技淫巧
url: 5007.html
id: 5007
categories:
  - DTOJ
  - Solution
date: 2018-11-04 22:51:45
---

考虑暴力dp。 记$f\[i\]\[j\]$为前$i$个台阶，第一个集合的最后一个台阶为$i$，第二个集合的最后一个台阶为$j$的最小总体力值。 考虑第$i+1$个台阶要放在哪个集合，有 $$f\[i\]\[j\]+|H_{i+1}-H\_i|\\Rightarrow f\[i+1\]\[j\]$$ $$f\[i\]\[j\]+|H\_{i+1}-H\_j|\\Rightarrow f\[i\]\[i+1\]$$ 这样子看好像没有什么优化的余地，我们把主动转移改成被动转移再看看。 注意到$f\[i\]\[j\]$和$f\[j\]\[i\]$是完全等价的，因此我们可以只考虑$i> j$的情况。 那么有 $$f\[i\]\[j\]=\\begin{cases} f\[i-1\]\[j\]+|H\_i-H\_j| & j<i-1\\\ \\min\_{k=1}^{i-2}\\{f\[i-1\]\[k\]+|H\_i-H\_k|\\} & j=i-1\\end{cases}$$ 我们发现，只有$f\[i\]\[i-1\]$是较特殊的。 设$g\[i\]=f\[i\]\[i-1\],Sum\[i\]=Sum\[i-1\]+|H\_i-H\_{i-1}|$。那么$f\[i\]\[j\]$就能被表示成$g\[j+1\]+Sum\[i\]-Sum\[j+1\]$。 那么原本的转移就可以写成 $$g\[i\]=\\min_{j=1}^{i-1}\\{g\[j\]+Sum\[i-1\]-Sum\[j\]+|H\_i-H\_{j-1}|\\}$$ 答案就是$\\min_{i=1}^{n}\\{g\[i\]+Sum\[N\]-Sum\[i\]\\}$。 考虑把绝对值拆开，即根据$H_{j-1}$与$H\_i$的大小关系分开转移。 我们拿一个树状数组维护当前$g\[j\]-Sum\[j\]-H\_{j-1}$的最小值，再拿一个树状数组维护当前$g\[j\]-Sum\[j\]+H_{j-1}$的最小值即可。