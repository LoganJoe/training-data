---
title: " DTOJ2277开场题\t\t"
tags:
  - ST表
  - 二分
  - 数学
url: 782.html
id: 782
categories:
  - DTOJ
  - Solution
date: 2018-02-26 13:10:19
---

考虑暴力的写法，用ST表预处理出区间gcd，再预处理前缀异或和。枚举区间$\[l,r\]$，就可以O(1)求出gcd和xor，从而求出答案。 考虑优化。我们现在只枚举区间左端点$l$，显然对于同一个$l$，$r$在不断右移的时候，$\[l,r\]$的gcd是非增的，且不同的gcd个数不会很多。 对于gcd相同的区间我们一起处理，显然右端点在一段区间内。已知gcd后，我们可以算出要找的区间的xor和右端点的前缀异或和。我们预处理出相同的前缀异或和出现的位置，就可以二分找出一段区间内有没有满足的右端点了。 从小到大枚举左端点，右端点也从小到大考虑，这样第一个找到的满足条件的区间就是答案了。