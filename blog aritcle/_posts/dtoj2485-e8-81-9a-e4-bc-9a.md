---
title: " DTOJ2485聚会\t\t"
tags:
  - 树形dp
url: 1105.html
id: 1105
categories:
  - DTOJ
  - Solution
date: 2018-03-19 20:22:12
---

记$f\[i\]$为从点$i$出发，到所有特殊点再回来的最小代价。显然$f\[i\]$减去以$i$为端点的最长链即为点$i$的答案。 最长链可以两遍dfs通过维护最长链和次长链dp求出。那么就只剩$f\[i\]$。 $f\[i\]$同样可以两遍dfs求出。 第一遍dfs从下到上，先求出从每个点出发，只到所有子树内的特殊点再回来的最小代价。具体地，对于$x$的儿子$son$，如果以$son$为根的子树内有特殊点，$x\\rightarrow son$这条边就要走一个来回，即$f\[x\]$在$f\[son\]$的基础上加上边权$\\times 2$。 第二遍dfs从上到下，加上从每个点出发，到子树外的特殊点再回来的最小代价。具体地，对于$x$的父亲$fa$，如果以$x$为根的子树外有特殊点，那么在$f\[fa\]$的基础上，$fa\\rightarrow x$这条边就要多走一个来回。如果以$x$为根的子树内有特殊点，那么$fa\\rightarrow x$这条边的来回在$f\[fa\]$中已经考虑过，要减去一个来回的代价。 $f\[i\]$和最长链可以在两个dfs中一起求出。