---
title: " DTOJ3681购物\t\t"
tags:
  - dp
url: 1907.html
id: 1907
categories:
  - DTOJ
  - Solution
date: 2018-05-07 21:01:17
---

发现$m$非常大以至于十分不科学，注意到如果两个区间存在包含的关系，肯定是大的排在前更优，此时小的不会对答案造成贡献，因此可以将被包含的区间删去。那么有用的区间就只剩最多$n$个了。 发现每次对答案造成贡献的区间都不相交，因为一个位置只会贡献一次。那么问题就变成了在整个区间中选出一些合法且不相交的区间，使得区间长度的平方和最大。 很容易想到dp：令$f\[i\]$表示前$i$个位置的最大值，那么枚举最后一个区间的左端点$j$，有 $$f\[i\]=max\\{f\[j-1\]+(i-j+1)^2\\}$$ 同时还有 $$f\[i\]=max\\{f\[i\],f\[i-1\]\\}$$ 判断区间左端点$j$是否合法可以通过预处理包含$i$的行动最小的左端点。