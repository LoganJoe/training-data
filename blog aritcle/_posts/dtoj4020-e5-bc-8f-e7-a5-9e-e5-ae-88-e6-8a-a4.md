---
title: " DTOJ4020式神守护\t\t"
tags:
  - 分治
url: 4923.html
id: 4923
categories:
  - Solution
date: 2018-11-01 12:55:33
---

题目大意就是每一次询问$\[l,r\]$，求在$\[l,r\]$中有多少种方案可以使选出的数的和为$m$的倍数。

随便一想就是$n*log_{2}^{3}n$的。线段树就好了。但是并不能过。

所以考虑多项式求逆，计前$i$个数的在模$m$意义下的每一种方案，除回去就好了。然而高斯消元还是3次方的。

然后发现前缀乘后缀是很好求的，直接乘起来就好了。如果把整个数列首尾相接接成环，前缀加后缀是一段连续的区间。那么我们能不能把所谓的端点移动到中间来呢？

以上为考场时的心理活动。

把端点移动的中间后，那么跨过中点的就可以求出了，然后再分成左右两边，递归下去。这就是分治。考虑时间复杂度。

如果没有其他的，分治是$n\*log_{2}n$的，然而我们需要处理每个点到中点的方案数，再乘一个$log_{2}n$，总共$n\*log_2^2 n$。

考虑计算答案，每一个答案只会用两个方案来算，那是$m*log\_2^2 n$的。总时间复杂度为$(n+m)log\_2^2 n$。