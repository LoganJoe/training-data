---
title: " DTOJ3563序列\t\t"
tags:
  - ST表
  - 二分
  - 单调队列
  - 思路
url: 1127.html
id: 1127
categories:
  - DTOJ
  - Solution
date: 2018-03-20 20:28:42
---

最小化最大值，二分的套路。因此先二分答案，问题变成了是否能分段。 $n^2$的dp比较显然。令$f\[i\]$最后一段以$i$结尾的最小的$a$的最大值之和。那么转移就是枚举一个$j<i$，满足$min(b_{1\\sim j})>max(a_{j+1\\sim i})$。 观察一下第一个条件，等价于若$i<j$且$b\_i\\leqslant a\_j$，那么$i,j$在同一段。 那么我们可以用st表预处理出$a$的最大值和$b$的最小值。同时对于序列的位置$i$，用st表找到最远的$j$，使得$a\_j\\geqslant min(b\_{i\\sim j})$，即$\[i,j\]$必须同一段，再从下一段的开头开始，把序列分成若干必须的段。将每一段的$a$变成段中$a$的最大值，$b$变成段中$b$的和，然后将每一段压成一个数，得到一个新的序列。 那么我们就满足了第一个条件，现在的问题就是将新序列划分成满足第二个条件的段。 还是考虑dp。首先有一个显然的性质：$f\[i-1\]\\leqslant f\[i\]$。 对于当前的$i$，能转移到$i$的$j$一定有一个范围限制，因为要满足每段的和$\\leqslant$二分的答案。这个范围同样可以二分求出，并且范围的左端点是单调不减的。那么现在就是求出某个范围中的$f\[j\]+max(a_{ {j+1}\\sim i})$的最小值。 $max(a_{j+1\\sim i})$显然可以拿一个单调队列维护，同时可以拿一个set维护$f\[j\]+max(a_{j+1\\sim i})$，修改单调队列的同时修改set里的值，即删掉一些值再加入一个新的值，因为在最大值相同的情况下决策点越前越优。转移肯定是拿set中的最小值最优，如果set为空，决策点肯定越前面越优，也就是刚好卡在范围的限制上。