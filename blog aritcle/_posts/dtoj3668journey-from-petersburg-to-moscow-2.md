---
title: " DTOJ3668Journey from Petersburg to Moscow\t\t"
tags:
  - 思路
  - 最短路
url: 3338.html
id: 3338
categories:
  - Solution
date: 2018-08-07 22:12:49
---

求$1$到$n$的最短路，最短路上只计算前$k$大的边。

然后这题的做法就很骚皮了。

我们考虑枚举第k大的边的权值x，然后将所有边权小于x的都当做边权为0，其他边的边权减去x,跑完最短路以后$dist\[n\]+kx$的最小值与原图的$dist\[n\]$取min就是答案。正确性很好证明，因为对于其他的路径，如果减去的$x$不是该路径的第$k$大的边的时候，该路径的值$dis\[n\]+k∗x$一定不会比该路径的“长度”小，出现在比较中不会对最终答案造成影响。然后大概发现这个x关于答案的函数是单峰的，三分就可以过了。

但是没必要三分。我们枚举每条边的边权x，然后将所有边的边权减x并与0取max，dijkstra+heap跑出所有答案即可。