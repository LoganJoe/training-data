---
title: " DTOJ3970graph\t\t"
tags:
  - 最短路
url: 4198.html
id: 4198
categories:
  - Solution
date: 2018-10-18 15:46:37
---

题目大意是需要在一个有向图中需要求出一个简单环，满足这个简单环含有点1，并且这个简单环的权值最小。

由于如果在与不1相邻的点中路径有相交，那么一定不如在相交点提取环优。那么就变成求两条最短路径和。现在就是考虑如何处理路径在与1相邻的点相交。

如果把每一个与1相邻的点当做源点，且每个点只有2条路径有用。那么只需要记入每个点的最短路和次短路，并且这两条路径的来源不同。把边反向再跑一次。如果对于每个点，只要两条路径来源不同，那么就可以更新答案。