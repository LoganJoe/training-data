---
title: " DTOJ2152Madoka Magica\t\t"
tags:
  - 博弈
url: 3675.html
id: 3675
categories:
  - Solution
date: 2018-08-27 23:01:56
---

博弈。就死了。

虽然考场上想清楚了很大一部分。但是写成$O(n^3)$被zhshr嘲笑了...

就是你考虑每个灯，将每个熄灭的灯看作是一个子游戏，那么SG函数，$sg\[i\]$就是当前灯是熄灭的，后面灯都是亮着的SG值。于是我们就可以枚举所有可能的子状态，就是从当前灯开始所有熄灯的方式来算出当前位置的SG值，也是对所有状态取mex。

然后对于所有灭着的灯的SG值，异或起来是否为0就是必败。

然后考虑怎么输出方案。那么我们直接枚举第一次操作，假设第一次操作能到一个先手必败的局面，那么这次就是先手必胜的局面。具体的，当前局面先手必败，仅当操作的石子的sg值与ans异或和=0.