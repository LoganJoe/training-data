---
title: " DTOJ2612小星星\t\t"
tags:
  - 容斥
  - 思路
  - 树形dp
url: 3095.html
id: 3095
categories:
  - DTOJ
  - Solution
date: 2018-07-28 10:54:40
---

题意大概就是问有多少种排列$P$，使得如果$i,j$在树上有变，$p\_i,p\_j$在图上有边。 可以想到一种状压dp：记$f\[i\]\[S\]$为以$i$为根的子树，对应了$S$状态中的点的方案数。 这样每次转移都要枚举一个子集，时间复杂度是$\\Theta(3^nn^2)$的。 算法的瓶颈在于枚举子集，因此我们肯定要把这一步给省掉。 然后我觉得思路就很巧妙了，对于这种有限制的计数类问题，用容斥解决。 我们枚举一个状态$S$，然后把所有的点都对应到$S$中的点上，也就是说可以两个点对应同一个点。 求出方案数后，根据$S$中$0$的个数，奇数就减去方案数，偶数就加上方案数，就能求出答案。 那么我们现在就要考虑如何求出方案数。 这就是一个很简单的树形dp了，记$f\[i\]\[j\]$表示以$i$为根的子树对应完，且$i$对应$j$的方案数。然后枚举每个儿子要对应哪个点转移一下即可，注意对应的点在$S$中状态一定要为$1$。 时间复杂度$\\Theta(2^nn^3)$。