---
title: " DTOJ1676水管局长\t\t"
tags:
  - 思路
url: 3469.html
id: 3469
categories:
  - DTOJ
  - Solution
date: 2018-08-16 23:02:52
---

我们要维护mst和mst上两点之间的边权最大值，要支持删边。 注意到$M,Q$都很大而$N$很小，且题目保证了删的边不超过$5000$条，我们考虑利用这个性质搞一些事情。 我们可以每次重构mst。但是删边后重构mst我们不会写，因此我们考虑时间回溯，将删边变成加边。而加边维护新的mst只需要找到两点之间最大的边，然后判断要不要删去即可。找边可以用倍增，也可以暴力dfs。 每次重构mst后再重新dfs一遍维护新的倍增信息，询问两点最大值直接在mst上倍增即可。 如果$N$和$M,Q$同阶的话，就只能用Link-Cut-Tree来维护mst了。