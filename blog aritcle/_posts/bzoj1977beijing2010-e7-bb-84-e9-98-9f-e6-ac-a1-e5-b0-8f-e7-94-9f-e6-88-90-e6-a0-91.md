---
title: " BZOJ1977[BeiJing2010组队]次小生成树\t\t"
tags:
  - 最小生成树
url: 5901.html
id: 5901
categories:
  - BZOJ
  - Solution
date: 2018-12-31 23:08:02
---

次小生成树一定是在最小生成树的基础上删掉一条边再加上一条边得到的。 我们先求出最小生成树。 对于一条$a,b$之间的不在最小生成树上的边，肯定只能替换生成树上$a$到$b$的路径上的某条边。 如果不是严格次小生成树的话，一定是替换掉边权最大的边。 要严格次小的话，当边权最大的边和当前边的边权相同时，这样替换就得不到严格次小生成树。 因此在这种情况我们要替换掉$a$到$b$的路径上严格次大的边。 我们用树上倍增预处理出每个点往上$2^k$经过的边的最大值和严格次大值，每次就可以$\\Theta(\\log n)$内求出两点之间的边权最大值和严格次大值了。 总时间复杂度$\\Theta(n\\log n)$。