---
title: " DTOJ4091dist\t\t"
tags:
  - 思路
  - 最短路
url: 5971.html
id: 5971
categories:
  - Solution
date: 2019-01-04 11:21:56
---

暴力的思路就是建出$O(m)$个辅助点优化连边，然后枚举所有点对算答案。 但是这样做忽略了原图中团的性质。考虑从这一性质下手。 每个点都可以看做一些团的交集。那么这个交集的位置相当于团与团之间可以相互到达。于是我们将团看做点，可以方便的跑出所有团间的最短距离$G(i,j)$。 再考虑$(u,v)$间最短路的组成。其肯定就是$\\min{G(x,y},x \\in S\_u,y \\in S\_v}$。其中$S\_x,S\_y$分别是包含$x,y$的团的集合。 那么枚举$x$，考虑如何计算$y$。注意到这里的最小值其实是满足最短路性质的。因此，我们对于$x$出发的所有最短路从小到大排序。然后当前这个团对于答案的贡献，就是这之前没有被计算进答案的点的数量。 这可以一遍预处理出来。其中，每个点所属团的状态可以状压，这样就方便作转移了。