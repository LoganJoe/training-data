---
title: " BZOJ2251[2010Beijing Wc]外星联络\t\t"
tags:
  - 字符串
url: 5750.html
id: 5750
categories:
  - BZOJ
  - Solution
date: 2018-12-23 15:11:45
---

一看$n\\leq 3000$，这不暴力嘛！ 然后我就直接暴力上map和set了…然后就愉快TLE了。不知道是STL常数太大还是BZOJ太垃圾了。 先考虑给子串排序的问题。 我们只要将后缀排序，然后按顺序扫一遍每个后缀的所有前缀，那么所有子串第一次出现的顺序就是按字典序的。 对于每个子串，我们找到它第一次出现所属的后缀，然后计算出这个后缀和后面多少个后缀的LCP能覆盖到这个子串，就求出了这个子串的出现次数。$n​$很小，我们预处理出相邻两个后缀的LCP，然后直接暴力扫过去即可。 给后缀排序可以使用后缀数组，时间复杂度$\\Theta(n\\log n)$。但这题$n$这么小也没有必要。 暴力排序是$\\Theta(n^2\\log n)$的，不知道在BZOJ上能不能过的去。 二分+hash排序是$\\Theta(n\\log ^2n)$的，稳过。