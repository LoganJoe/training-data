---
title: " DTOJ2347国旗计划\t\t"
tags:
  - 倍增
url: 3471.html
id: 3471
categories:
  - DTOJ
  - Solution
date: 2018-08-16 23:12:00
---

对于这种环形的问题，一般都是将原序列倍长，然后变成序列上的问题来解决。 这题也是这样，我们将边境线拉成一条直线，然后倍长。 这样每个人都能覆盖边境线上的一段区间，我们要求每个区间必选的情况下最少需要多少个区间来覆盖整个边境线。 我们贪心地想，如果现在覆盖到了位置$x$，那么下一个选的区间一定是包含$x$且右端点最靠后的区间。 那么我们对每个区间求一个$nex\_i$，表示如果当前覆盖到了第$i$个区间的右端点，下一个选的区间是哪个。 $nex\_i$显然是单调的，可以移指针求出，当然也可以树状数组…… 那么我们可以一个一个区间选过去直至覆盖边境线。 但这样太慢了，我们可以用倍增优化。 具体地，我们对每个区间求一个$nex_{i,j}$，表示如果当前覆盖到了第$i$个区间的右端点，接下来第$2^j$选的区间是哪个。 那么我们就可以利用$nex_{i,j}$在$\\Theta(\\log n)$的时间内求出第$i$个区间的答案。 总的时间复杂度为$\\Theta(n\\log n)$。