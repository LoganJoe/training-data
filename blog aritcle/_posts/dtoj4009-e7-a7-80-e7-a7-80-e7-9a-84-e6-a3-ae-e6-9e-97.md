---
title: " DTOJ4009秀秀的森林\t\t"
tags:
  - 倍增
  - 并查集
url: 4790.html
id: 4790
categories:
  - Solution
date: 2018-10-30 16:35:31
---

题目就是每一次你要从剩余的边中删除一条边，问每一次删除后这个森林每一棵树的直径的乘积。

由于不会正着写，所以考虑倒着写。从$n$个点每一次加入边。考虑加边，每一次会生成一棵新树，这棵新树的直径只可能是原来的直径，或者这条边引出的两条最长连的和。由于原直径是已知的，现在只需要求最长连。

考虑一棵树，它任意一个节点所引出的最长链一定结束在直径两个端点之一，所以我们只需要求出某个点到直径的距离就好了。由于原来那棵树的形态不会变化，所以你求现在的两点距离与求原来那棵树的两点距离是等价的。所以就可以直接求啦。