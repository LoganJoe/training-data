---
title: " DTOJ2890连通能力\t\t"
tags:
  - 树形dp
url: 2060.html
id: 2060
categories:
  - DTOJ
  - Solution
date: 2018-05-24 07:34:22
---

对于一棵树，代价最小的点一定在这棵树的直径上。因为如果一个点不在直径上，它一定能先走到直径上，然后沿着直径走，这样代价更大。 显然代价最小的点在直径的中间位置。考虑如何维护每个子树的直径和直径中间的位置。 对于每个点，我们先只考虑子树内经过它的直径（最长路）。显然经过它的直径一定是由往下的最长链和次长链组成。 我们可以用树形dp求出最长链和次长链。至于代价最小的点，我们可以记下端点然后倍增往上跳。 但其实不用这么麻烦。 我们记一个$pos\_x$表示以$x$为根的子树内代价最小的点。假如经过$x$的最长链是往$a$，次长链是往$b$，那么只要从$pos\_a$一步一步往上跳就能求出$pos_x$了。