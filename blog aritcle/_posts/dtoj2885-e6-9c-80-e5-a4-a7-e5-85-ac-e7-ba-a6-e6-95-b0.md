---
title: " DTOJ2885最大公约数\t\t"
tags:
  - dp
  - 数学
url: 4714.html
id: 4714
categories:
  - Solution
date: 2018-10-29 07:39:59
---

可以知道的是，数列的gcd前缀和一定是单调不减的。假设一个数加进去以后不会影响某段的gcd，那么将其往前挪一定更优。 令$f\[i\]$为填了$i$的倍数的数之后的最优的答案。考虑其倍数$j$，有$f\[j\]=max(f\[j\],f\[i\]+(cnt\[j\]-cnt\[i\])*j)$。其中$cnt\[i\]$为$A\[i\]$中为$i$的倍数的个数。 总体效率是$O(n \\log n)$。