---
title: " DTOJ3558困难重重\t\t"
tags:
  - 二分图
  - 奇技淫巧
  - 费用流
url: 1084.html
id: 1084
categories:
  - DTOJ
  - Solution
date: 2018-03-18 22:38:42
---

先考虑如果$A=B$怎么做。 惯用套路先二分图染色。发现如果一个点和相邻一个点连边，代价为$0$；和两个点连边，代价为$A$；和三个点连边，代价为$3A$；和四个点连边，代价为$6A$。 据说这是个费用递增模型。即每个点和$S$或$T$连四条边：容量为$1$费用为$0/A/2A/3A$，流了几次就说明这个点和相邻的几个点连边。每个点再和相邻的四个点连容量为$1$费用为$0$的边。跑一遍最小费用最大流就是答案。 再考虑$A<B$的情况。 还是要二分图染色。发现两个直线的情况，每个会多出$B-A$的代价。 同样让每个点和$S$或$T$连四条边。然后特殊处理多的代价，同样可以用费用递增模型。对于点$x$，拆成三个点：$x,x1,x2$，$x1$代表$x$左右的两个点，$x2$代表$x$上下的两个点。$x$向$x1,x2$各连两条边：容量为$1$费用为$0/B-A$，流了两次就说明$x$和左右/上下的点都连了边，因此多出$B-A$的代价。每个点的$x1,x2$分别和相邻的四个点的$x1,x2$连容量为$1$费用为$0$的边。 最小费用最大流即为答案。