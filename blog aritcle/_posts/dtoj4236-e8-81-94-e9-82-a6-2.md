---
title: " DTOJ4236联邦\t\t"
tags:
  - FWT
  - 集合幂级数
url: 7094.html
id: 7094
categories:
  - Solution
date: 2019-03-24 10:07:20
---

定义 $f(S)$ 表示点集 $S$ 构成的图联通方案数, $g(S)$ 表示点集 $S$ 构成的图不一定联通的方案数. 显然$g(S)$很好求： $$ g(s)=\\prod_{(u, v) \\in s}\\left(C_{u, v}+1\\right) $$ 另外，我们考虑另外一种有关$f(S)$的求法：对于当前集合$S$,我们设其编号最小点为$u$，并且暴力枚举$u$所在的联通块$T$。显然，$T$中点的方案是$f(T)$。那么 $$ g(S)=\\sum_{u \\in T, T \\subseteq x} f(T)g(S-T) $$ 那么考虑现在我们要求解的总集$totS$并计算所有包含一号点的集合$s'$的$f(s')$。 回过头来考虑上面那个式子，其实$g(S)$就是$f(S)$与$g(S-s')$的子集卷积。对于子集卷积定义不熟悉的可以参看vfk的论文。 那么固定$u=1​$，相当于$f(s')=g(s)/g(s-s')​$。做子集卷积意义下除法即可。 对于子集卷积与集合幂级数的变换运算不熟悉的还是参看论文吧...