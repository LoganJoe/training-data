---
title: " DTOJ3135朗格拉日计数\t\t"
tags:
  - 线段树
url: 5704.html
id: 5704
categories:
  - DTOJ
  - Solution
date: 2018-12-22 21:20:12
---

我一开始想枚举$b$，然后在$b$的前面和后面找到合法的$a,c$的数量。但由于这是环上的问题，$a,c$的相对位置不好确定，于是我就放弃了这种写法。 我们考虑枚举$a$，然后从$a$把环断成序列。那么$a$后面的每个大于它的数都可能成为$b$来贡献答案。而某个$b$对答案的贡献为$b$后面比$b$大的数。 记$cnt\_i$为权值为$i$的数后面比$i$大的数的个数。当$a$向后移动时，对$cnt\_i$的影响是区间$+1$和单点修改为$0$。 我们可以用线段树来维护$cnt\_i$。当前枚举到的$a$对答案的贡献是$\\sum\_{i=a+1}^{n}cnt\_i$，在线段树上区间查询即可。 $cnt\_i$的初始化也可以用线段树来实现，当然也可以树状数组。 为了不写pushup和pushdown，并且不在线段树上打标记，同时不再写个树状数组，我感觉自己的线段树写的有点花哨。（用单点查+单点加替代了单点赋值）