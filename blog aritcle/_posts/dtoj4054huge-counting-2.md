---
title: " DTOJ4054Huge Counting\t\t"
tags:
  - 奇技淫巧
  - 容斥
  - 数位dp
url: 5527.html
id: 5527
categories:
  - Solution
date: 2018-12-16 11:06:57
---

既然题目将背景设在了高维度，我们不妨将问题放在高维空间考虑。 想象一个高维空间的点$(x\_1,x\_2,\\dots,x\_n)$。那么$f(x\_1,x\_2,\\dots,x\_n)$即是从$(1,1,...,1)$走到$(x\_1,x\_2,\\dots,x\_n)$的方案数$\\mod 2$。 于是$f(x\_1,x\_2,...,x\_n)$就是相当于在$\\sum x$里每次选一位走。为了方便，下面都有$x\_i=x\_i-1$。答案就可以表示为 $$ \\prod_{i=1}^{k-1}\\binom{\\sum_{j=i}^{k}x\_j}{x\_i} $$ 那么考虑$f(x\_1,x\_2,\\dots,x\_n)=1$的充要条件，即$\\forall i \\in\[1,k),\\binom{\\sum\_{j=i}^{k}x\_j}{x\_i}\\equiv 1  \\mod 2$。考虑卢卡斯定理，对于组合数$\\binom{n}{k}$，其$\\binom{n}{k} \\equiv 1 \\mod 2$的充要条件就是$n \\& k =k$。于是原来，$f(x\_1,x\_2,...,x\_n)=1$的充要条件就会变为，$\\forall i,j\\in\[1,k\],i \\neq j$，有$(x\_i+x\_j) \\& x\_i=x\_i$。关于这部分充要性的证明，必要性由前面很好推知，而充分性可以考虑任意位最多只有一个$1$，那么考虑因子交集，其是满足互交的。也可以用反证发现充分性。 于是问题至此转化成了一个数位dp问题。求每一位至多只有一个$x\_i$的$n$元组$(x\_1,x\_2,\\dots,x_n)$的个数。可以很容易做出$l=1$的情况，而对于$l \\neq 1$，我们可以容斥，每次算几个位的$Lim$从$r$被改成$l$即可。