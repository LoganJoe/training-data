---
title: " DTOJ3122染颜色\t\t"
tags:
  - Link-Cut Tree
  - 线段树
url: 5655.html
id: 5655
categories:
  - DTOJ
  - Solution
date: 2018-12-18 23:24:49
---

如果我们把同一种颜色之间的边看作实边，不同颜色之间的边看作虚边的话，那么一个点走到根的代价就是经过的虚边条数。 如果将实边虚边与LCT中的实边虚边对应，那么染色操作就相当于LCT中的access操作。 我们用一棵LCT来维护每次染色带来的变化。 每次access时，会影响到边的虚实转换，从而影响到某个子树的点到根的代价。 注意到树的形态是不会变的，那么我们可以利用dfs序将子树内的点变成一段连续的区间。 那么虚实转换的影响就是对某段区间的点$\\pm 1$，同时我们要支持区间查询。 用线段树或者树状数组维护即可。 时间复杂度$\\Theta(n\\log ^2 n)$。