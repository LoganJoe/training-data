---
title: " DTOJ2268小狐狸\t\t"
tags:
  - 矩阵
url: 4154.html
id: 4154
categories:
  - Solution
date: 2018-10-16 13:19:05
---

考虑如何在知道$t$时刻答案后知道$t+1$时刻的答案。

我们将四个方向分开考虑。以向左的为例，我们记录在t时刻所有方向都为左的狐狸的数量为$num_L$：

*   方向向上的答案$+=num_L*L$;
*   方向向下的答案$+=num_L*R$;
*   方向仍然向左的答案$+=num\_L\*S+sum\_y\*S$。
    *   其中$sum_y$为$t$时刻方向向左的狐狸的纵坐标的和。

其他方向的贡献类似考虑。

这样我们在得以维护$sum\_x,sum\_y$后就可以维护答案了。仍然拿向左的举例：

*   方向向上的$sum\_x+=sum\_x*L$;
*   方向向下的$sum\_x+=sum\_x*R$;
*   同向的$sum\_x+=num\_L$;
    *   其中$num_L$为$t$时刻方向向左的狐狸数量。

那么我们就可以得到一个线性时间复杂度内递推出答案的方式。

同时注意到，这样的一个东西往往都可以用矩阵快速幂优化掉。所以我们构造出矩阵就可以出解了。