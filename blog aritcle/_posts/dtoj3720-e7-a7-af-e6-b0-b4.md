---
title: " DTOJ3720积水\t\t"
tags:
  - 二分
  - 线段树
url: 2024.html
id: 2024
categories:
  - DTOJ
  - Solution
date: 2018-05-21 07:41:57
---

考虑积水后的图形。从左到最高峰一定是单调不减的，从右到最高峰也是。能存放多少积水显然是积水后的图形的面积减去没积水的图形的面积（也就是所有柱子的高度和）。后者我们可以拿一个变量简单维护。 考虑如何维护积水后的两侧单调的图形面积。发现修改只会使柱子变高，而一个柱子的变高可能会使图形好几个位置一起增高（也可能图形不变），并且增高的位置一定是以修改位置为一个端点的一段连续的区间。 考虑线段树。我们可以根据修改的位置再最高峰的左右侧在线段树上对应位置二分找到修改区间的另一个端点，然后在区间赋值。维护区间和即可。 注意判断修改后最高峰改变或者是修改的位置是最高峰。