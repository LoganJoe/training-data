---
title: " BZOJ3771Triple\t\t"
tags:
  - FFT
  - 容斥
  - 生成函数
url: 5519.html
id: 5519
categories:
  - BZOJ
  - Solution
date: 2018-12-15 22:35:58
---

题意就是$n$个物品至多选$3$个，问每种可能的价值和及方案数。 对于选$1/2/3$个分别考虑。 对于选$1$个的情况，我们构造所有物品关于价值的生成函数$A(x)$，那么显然价值为$i$的方案数就是$A(x)\[x^i\]$。 对于选$2$个的情况，容易想到$A^2(x)$。但是这样会算到同一个物品选两个的情况，我们构造同一物品选$2$个的生成函数$B(x)$，显然价值为$i$被多算的方案数为$B(x)\[x^i\]$，那么答案的多项式就是$\\frac{A^2(x)-B(x)}{2}$。 对于选$3$个的情况，也很容易想到$A^3(x)$。但是这样同样会算重。我们构造同一物品选$3$个的生成函数$C(x)$，那么答案的多项式就是$\\frac{A^3(x)-3A(x)B(x)+2C(x)}{6}$。至于为什么是这样运用到了容斥的思想，即把至少重复两个的减掉再加上重复三个的情况。 那么总的答案的多项式就是 $$A(x)+\\frac{A^2(x)-B(x)}{2}+\\frac{A^3(x)-3A(x)B(x)+2C(x)}{6}$$ 用FFT优化多项式乘法即可。