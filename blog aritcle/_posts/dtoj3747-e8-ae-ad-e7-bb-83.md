---
title: " DTOJ3747训练\t\t"
tags:
  - 可持久化线段树
url: 2320.html
id: 2320
categories:
  - DTOJ
  - Solution
date: 2018-06-12 13:22:31
---

和[DTOJ2827矩阵](http://www.dtenomde.com/2018/03/author=jiangyutong/article=2165/)想法相同。 不同的是，这题是先修改再查询，且数据范围增强了。 我们可以先将修改的坐标离散化，然后查询时二分查找到离散化后的查询范围。 我们要维护的是每个点到原点的子矩阵里的信息。 因此我们以$x$为下标，建一棵主席树，也就是很多棵线段树。线段树以$y$轴为下标，存前缀$x$内对应的$y$坐标区间的所有信息。 每次在主席树上查询即可。