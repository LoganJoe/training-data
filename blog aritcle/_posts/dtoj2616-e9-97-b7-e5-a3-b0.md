---
title: " DTOJ2616闷声\t\t"
tags:
  - 最大权闭合子图
url: 2088.html
id: 2088
categories:
  - DTOJ
  - Solution
date: 2018-05-26 21:44:06
---

显然对于每行的$w$，可以取一个后缀最大值。 每个条件等价于给每个$t\_i$一个$\\geqslant $的限制，所有的$t\_i$都满足限制后就能得到$p$的价值。 这些限制很奇怪，所以考虑网络流（雾）。 考虑最大权闭合子图的模型。 先给每个条件新建一个点，点权为$p$。每个$t\_i$的每种取值也建一个点，记$t\_i=j$建的点为$(i,j)$，点权为$w_{i,j-1}-w_{i,j}$，即和前一种取值的价值作差。 由于作差了，所以如过要选$(i,j)$这个点，就一定要选$(i,j-1)$这个点，因此从$(i,j)$向$(i,j-1)$连一条边。 然后连限制边。比如$t_i\\geqslant x$，那么向$(i,x)$连一条边，代表如果要满足这个条件，一定要选这个点，然后由于之前连的边，使得$(i,x-1),(i,x-2)…(i,1)$都要选。 然后求出最大权闭合子图即可。 边数$10^6$……真神奇。 不过正解并不是这样，好像是在后缀数组还是啥上面建图跑网络流。