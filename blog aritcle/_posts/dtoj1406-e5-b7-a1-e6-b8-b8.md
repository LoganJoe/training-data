---
title: " DTOJ1406巡游\t\t"
tags:
  - 二分
  - 单调队列
  - 点分治
url: 1031.html
id: 1031
categories:
  - DTOJ
  - Solution
date: 2018-03-12 21:08:26
---

首先可以二分答案$ans$，将权值$\\geqslant ans$的路径改为$1$，$<ans$的路径改为$-1$。问题转化为是否存在一条长度在$\[L,R\]$内且边权和$\\geqslant 0$的路径。 考虑点分治。$f\[i\]$表示以当前重心为根，到深度为$i$的点最大的边权和。显然可以枚举子树转移。 至于更新答案，若我们在新的子树内选了深度为$x$的点，那就可以和另一个深度在$\[L-x,R-x\]$中的点组成一条合法的路径。注意到，当$x$不断增大的时候，区间$\[L-x,R-x\]$是不断左移的。因此对于每一个新的子树，我们可以开一个单调栈来更新答案。 在二分之间把每次访问的重心预处理出来，可以优化常数。