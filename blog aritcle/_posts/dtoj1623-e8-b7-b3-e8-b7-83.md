---
title: " DTOJ1623跳跃\t\t"
tags:
  - 倍增
url: 2874.html
id: 2874
categories:
  - DTOJ
  - Solution
date: 2018-07-20 21:59:15
---

我们可以预处理每个石头的第$k$近是哪块石头。 前$k$近的石头一定是一段连续的区间，如果能求出所有石头前$k$近的区间，就能知道所有的第$k$近。 具体地，记距离第$i$块石头前$k$近的区间是$\[l,r\]$，当$i$变成$i+1$的时候，到左边的石头的距离可能比到右边的石头距离大，此时就要$l++,r++$了，每次移动$l,r$即可。 然后，由于$m$很大，我们不能每次都跳。 但这显然可以倍增。 但是，$60n$的数组是开不下的！ 发现我们每次只会用到一层的倍增数组，滚动一下即可。