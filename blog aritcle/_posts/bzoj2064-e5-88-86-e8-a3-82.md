---
title: " BZOJ2064分裂\t\t"
tags:
  - 状压dp
url: 2566.html
id: 2566
categories:
  - BZOJ
  - Solution
date: 2018-06-18 20:36:31
---

记原来的序列为$A$，要得到的序列为$B$。 显然是将$A,B$划分成同样数目的集合，且对应的两个集合里的数都相等。 记划分成$x$个集合，那么答案显然是$n\_1+n\_2-2x$。 那么就是要求最大的$x$。 发现$n\_1,n\_2$都很小，我们可以考虑状压。 记$f\[i\]\[j\]$为$A$中选的数状态为$i$，$B$中选的数状态为$j$，最多能形成几对集合。 预处理出每种状态的和，那么我们可以枚举新的集合分别是哪些数来转移。 这样的时间复杂度是$\\Theta(4^{n\_1+n\_2})$。 显然是过不去的。考虑优化。 记$A$序列状态为$i$的数的和是$SumA\[i\]$，同理有$SumB\[i\]$。 对于之前的dp，显然只有$SumA\[i\]=SumB\[j\]$的$f\[i\]\[j\]$才有意义。 那么我们可以理解为当$SumA\[i\]=SumB\[j\]$时，又有一对集合形成了。 将每次选一个集合数改成每次选一个数转移，当转移到$SumA\[i\]=SumB\[j\]$的状态就$+1$，否则不变。 $n\_1+n\_2-2f\[2^{n\_1}-1\]\[2^{n\_2}-1\]$即为答案。