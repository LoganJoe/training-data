---
title: " DTOJ2603不稳定的传送门\t\t"
tags:
  - 思路
  - 期望
url: 3686.html
id: 3686
categories:
  - Solution
date: 2018-08-28 12:08:58
---

首先可以想到的思路是，设$f\[i\]$为从$i$到$n$的最小期望花费。那么这个东西的转移，我们想到的最暴力的方法就是枚举一个点的传送门选择次序然后计算。

但是我们想，可以找出一个次序使得转移最优。对于原来的转移，有:

$$f\[s\]=\\min(f\[s\],w+pf\[t\]+(1-p)f\[s\])$$

考虑两个传送门之间，假设第x个传送门比第y个传送门更优，肯定有：

$$c\_x+p\_xf\[t\_x\]+(1-p\_x)(c\_y+p\_yf\[t\_y\]+(1-p\_y)B) < c\_y+p\_yf\[t\_y\](1-p\_y)(c\_x+p\_xf\[t\_x\]+(1-p\_x)B)$$

即

$$\\frac{c\_x}{p\_x}+f\[t\_x\] < \\frac{c\_y}{p\_y}+f\[t\_y\]$$

那么对于每个时间点，排序做就好了。