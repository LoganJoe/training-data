---
title: " DTOJ2842Wycieczki\t\t"
tags:
  - 矩阵
url: 4499.html
id: 4499
categories:
  - Solution
date: 2018-10-24 19:26:04
---

首先考虑求长度为$k$的路径条数。 原有的边数量很多，拆边过不去。为了使得所有边长度为1，我们可以将一个点拆成3个点，同一个点拆成的三个点要连上边，对于长度不为1的边，向其拆成的点连边，这样边的长度就都是$1$了。而这样就可以用矩阵乘法求出长度为$i$的路径数量。 考虑怎么计算答案。每次二分一个答案再快速幂上去的效率是$O(n^3 \\log^2 n)$的，显然过不去。但是我们可以略去二分这个步骤。我们可以预处理出所有长度$2^i$的路径条数。然后用倍增的方法，从高位往低位跑出答案就好了。