---
title: " DTOJ3931书香\t\t"
tags:
  - 二分
  - 思路
url: 4115.html
id: 4115
categories:
  - DTOJ
  - Solution
date: 2018-10-15 14:28:24
---

这题很巧妙。 两个人的操作是独立的。 为了方便理解，我们可以把问题变成：一开始有$n$座有标号的房子，第$i$座就在位置$i$，每座房子里有个人，第$i$座里住着第$p_i$个人。C操作每次相当于将房子$x$和房子$y$互换位置（人跟着房子一起动），而你可以将房子$x$和房子$y$里的人交换。目标就是使得最后第$i$个人在位置$i$的房子里。 假如知道最终每座房子在哪，我们也就知道了每座房子里应该是什么人，那么我们在C操作的时候把每个人换到对应的房子里即可。 实际上我们并不需要知道第$i$个位置上的房子是什么，只需要根据最后结果知道我们中途要交换哪些人即可。因此我们只需要维护当前每个位置上的人，和每个人的位置。 我们可以枚举最优解要$k$步。然后计算出把人换完需要的步数，如果$\\leq k$就是可行的。 显然答案是可以二分的，那么我们二分答案即可。