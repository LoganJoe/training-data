---
title: " DTOJ1205GT考试\t\t"
tags:
  - KMP
  - 矩阵
url: 469.html
id: 469
categories:
  - Solution
date: 2018-02-04 12:56:59
---

我们可以想到一个DP方程：f\[i\]\[j\]表示前 i 位数字，它的最后 j 位与不吉利串匹配的方案数，显然有$ans=\\sum_{i=0}^{x}f\[n\]\[i\]$. 也就是相当于，从i转移到i+1，很像KMP那样，相同的话就变为j+1，否则的话变为p\[j\]+1; 然后看一眼数据范围，我们选择矩阵乘法加速：

> 也就是说前 i 位匹配到了不吉利串 j 位，加入 i+1 这个字符，有不同情况，有一些会转移到j+1，一些会转移到其他的，写成一些形如f\[i+1 , k\] += f\[i , j\]的式子…… f\[i+1 , 3\] += f\[i , 2\] f\[i+1 , 0\] += f\[i , 2\] 即枚举i+1可能出现的字符，然后看n个f\[i , j\]分别转移到哪去，就在转移矩阵的这个转移路径上+1

然后就是对于转移矩阵跑矩阵快速幂...