---
title: " PKUWC2018乱写\t\t"
url: 2174.html
id: 2174
categories:
  - Solution
date: 2018-05-29 20:57:14
tags:
---

（借助题解下）写了写今年的PKUWC。 心中有998244353条可怜在打斗地主。

### loj2537. 「PKUWC 2018」Minimax

与期望无关系列。 记￥maxa(x)￥为当前点左子树权值大于x的概率，￥maxb(x)￥为当前点右子树权值大于x的概率。 那么若一个出现在左子树的权值v成为了最终权值，概率应为$maxb(v)∗(1−p)+(1−maxb(v))∗p)=maxb(v)+p−2∗maxb(v)∗p$ 同理一个出现在右子树的权值v成为最终权值的概率应为$maxa(v)∗(1−p)+(1−maxa(v))∗p)=maxa(v)+p−2∗maxa(v)∗p$ 那么要考虑在线段树上维护这个东西。 我们可以先维护右子树的答案。可以保证左边均没有被合并过而右边已经合并完全。这时候maxa和maxb恰好就是对应的函数值。 到根节点以后遍历所有叶节点就可以得到答案了。中间离散化加上权值线段树搞一搞也就妥了? 然鹅话是这么说...写起来比较...

### loj2538. 「PKUWC 2018」Slay the Spire

明显优先打强化牌更优，因为强化牌对于答案的贡献是累乘的。 设$f\[i\]\[j\]$为抽到$i$张强化牌打出$j$张，所有抽卡方案，每种方案可以得到的最大的权乘积的和。 设$g\[i\]\[j\]$为抽到$i$张攻击牌打出$j$张，所有抽卡方案，每种方案可以得到的最大的权加和的和。 这很绕是不是。 然后我们就分类讨论情况。 可以枚举抽到了几张强化牌。如果大于k-1张明显用k-1张强化牌，1张攻击牌最优。否则用光所有的强化牌。 比较难处理的是f\[\]\[\]和g\[\]\[\]。具体的我们可以先排序，然后预处理一个f(i,j)表示选了i张且最靠前的是第j个，所具有的最大价值。然后就可以再O(n)一下计算出f\[\]\[\]。

### 2540\. 「PKUWC 2018」随机算法

貌似只有这题是独立思考出来的。。。 设f\[i\]\[s\]为最大独立集大小为k，不可选择的点集为s（包括最大独立集和最大独立集的相邻点）,所具有的方案数。容易发现这个东西的转移为$f(S \\cup w\_j,i+1) \\leftarrow f(S \\cup w\_j,i+1) + f(S,i) \\times A_{n-|S|-1}^{|w\_j-(w\_j \\cap S)|-1}$ 然后....dp？