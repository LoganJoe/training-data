---
title: " DTOJ1323树上路径问题\t\t"
tags:
  - 点分治
url: 5632.html
id: 5632
categories:
  - DTOJ
  - Solution
date: 2018-12-17 13:25:47
---

注意到$k\\leq 10^6$。 考虑点分治。 每次找出重心后，从重心出发dfs。记$f\[i\]$为从重心出发路径权值为$i$最少要经过几条边。 更新$f\[i\]$的时候同时用$f\[i\]+f\[k-i\]$更新答案即可。 注意要保证$f\[i\]$和$f\[k-i\]$不是来自同一棵子树的路径。我们可以分两遍dfs，一次更新答案，一次更新$f$。