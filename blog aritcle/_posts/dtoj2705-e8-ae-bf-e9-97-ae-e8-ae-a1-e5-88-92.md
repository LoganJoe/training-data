---
title: " DTOJ2705访问计划\t\t"
tags:
  - 树形dp
url: 2090.html
id: 2090
categories:
  - DTOJ
  - Solution
  - 不会证
date: 2018-05-26 22:19:53
---

发现$k=0$肯定是边权和的两倍，因为你一条边要从上往下和从下往上走两次。 发现$k=1$时我们可以少走一些边，使得这些边只经过一次，很容易发现答案是两倍边权和减去最长链。 模拟几种情况，发现好像跳一次就能少走一条链的边一次。选的链边不能重合但点可以重合。不会证。 假设选$i$条链最大的权值和是$val\_i$，边权和是$Sum$，那么答案为 $$max\\{2Sum-val\_i+iC\\}$$ 显然的问题就是求$val\_i$。 考虑树形dp。记$f\[i\]\[j\]\[0/1\]$为以$i$为根的子树，已经选了$j$条链，与点$i$相连且被选的边为偶数/奇数。第三维的作用是判断再选一条与$i$相连的边，选的链数是否要$+1$。 那么初始时有$f\[i\]\[j\]\[0\]=0,f\[i\]\[j\]\[1\]=-inf$。 记$i$的儿子为$son$，枚举已经考虑过的$i$的子树内选了几条链，要在以$son$为根的子树内选几条链，以及$i$与$son$的边选不选即可转移。 那么$val\_i=max\\{f\[1\]\[i\]\[0\],f\[1\]\[i\]\[1\]\\}$。