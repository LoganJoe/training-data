---
title: " DTOJ2911分组\t\t"
tags:
  - dp
url: 5175.html
id: 5175
categories:
  - DTOJ
  - Solution
date: 2018-11-17 21:22:37
---

将所有人按$s\_i$从小到大排序，我们称一组中最小的$s\_i$为这组的左端点，最大的$s\_i$为这组的右端点。一组的不和谐度就是左右端点形成的区间长度。 那么每个人可能是左/右端点或者在某对左右端点形成区间中。 我们考虑dp。 记$f\[i\]\[j\]\[k\]$为前$i$个人，有$j$个左端点还未和右端点匹配，当前不和谐度为$k$的方案数。 对于第$i$个人，他可以成为一个新的左端点，或者成为右端点去和一个左端点匹配，或者自己既是左端点又是右端点，亦或者什么都不是。 记$k'=k+(s\_i-s_{i-1})\\times j$。然后开始分类讨论。

*   成为一个左端点：$f\[i-1\]\[j\]\[k\]\\Rightarrow f\[i\]\[j+1\]\[k'\]$
*   成为一个右端点：$f\[i-1\]\[j\]\[k\]\\times j\\Rightarrow f\[i\]\[j-1\]\[k'\]$
*   成为左端点和右端点：$f\[i-1\]\[j\]\[k\]\\Rightarrow f\[i\]\[j\]\[k'\]$
*   什么都不是（在某对左右端点形成的区间中）：$f\[i-1\]\[j\]\[k\]\\times j\\Rightarrow f\[i\]\[j\]\[k'\]$

最后$\\sum_{i=0}^{k}f\[n\]\[0\]\[i\]$就是答案。 注意空间，要滚动数组压掉一维。