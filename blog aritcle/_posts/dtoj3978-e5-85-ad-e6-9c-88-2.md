---
title: " DTOJ3978六月\t\t"
tags:
  - 思路
url: 4914.html
id: 4914
categories:
  - DTOJ
  - Solution
date: 2018-10-31 23:25:57
---

打反了三个$n,m$，然而只找出来了两个…… 记$n$为a串的长度，$m$为b串的长度。 假设我们删掉的是b串的$\[l,r\]$，那么我们要保证$\[1,l)$和$(r,m\]$拼起来是a串的子序列。 怎么判断是否合法呢。 我们从前往后在a串中匹配b串的$\[1,l)$，从后往前在a串中匹配b串的$(r,m\]$，如果前者的结束位置小于后者的结束位置，那么就是合法的。 记$f\[i\]$为从前往后在a串中匹配b串的$\[1,i\]$的结束位置，$g\[i\]$为从后往前在a串中匹配b串的$\[i,m\]$的结束位置。这两个都可以递推求出。 我们要求出满足$i<j,f\[i\]<g\[j\]$的最小的$j-i$，以及这时$i,j$的取值。 这是一个二维偏序问题，可以用树状数组维护。 我们从小到大枚举$i$，然后把之前的每个$f\[i\]$都塞到树状数组里，然后拿$g\[i\]-1$去查询最大值即可。 最后区间$(i,j)$就是我们要删的连续子串。$i=0$或$j=m+1$的情况要特判。 还要注意$f\[i\]$和$g\[i\]$不合法的情况。