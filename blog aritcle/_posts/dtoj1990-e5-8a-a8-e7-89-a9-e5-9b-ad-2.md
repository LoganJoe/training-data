---
title: " DTOJ1990动物园\t\t"
tags:
  - KMP
url: 1467.html
id: 1467
categories:
  - Solution
date: 2018-04-15 13:26:42
---

首先理解一下num数组的含义： 记某子串既是他的后缀又是他的前缀的字符串数量为num\[i\]。这与kmp中的next数组定义十分相似，区别在于num数组记录的是数量，并且前缀后缀不重叠。 我们回顾next数组的求解方法：对于匹配串的一个位置提出一个指针j，表示1...j的字符串与i-j+1...i的字符串匹配。对于向后推的一个i，其对应的j可以由上一个位置的next推得。那么我们发现，只需要稍加改动就可以实现num数组的计算：我们记两个指针$j\_1$,$j\_2$,分别表示上一个匹配到的前缀位置（就是kmp中的j指针）和上一个匹配到的前缀与后缀不重叠的位置，即保证$j\_2 \\leq \\frac{i}{2}$。那么我们可以利用$j\_1$递推求出num\[i\]数组的值，并且对于位置i，可以由$j_2$计算出ans。