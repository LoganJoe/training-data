---
title: " DTOJ4081春空\t\t"
tags:
  - 思路
  - 莫比乌斯反演
url: 5709.html
id: 5709
categories:
  - DTOJ
  - Solution
date: 2018-12-22 23:27:38
---

经过试验打表我们发现Fibonacci数列有的性质这个数列都有。 我们要用到的其实只有一点：$gcd(Fib\_i,Fib\_j)=Fib_{gcd(i,j)}$。 考虑多个数的$lcm$怎么算。我们有 $$ lcm(a\_1,a\_2,,…,a\_n)=\\prod\_{T\\subseteq S,T\\neq \\varnothing}gcd(a\_i)^{(-1)^{|T|+1}}i\\in T $$ 其中$S$是全集。 简单来说就是我们从$n$个数中选出奇数个数，求出$gcd$，然后全部乘起来；选出偶数个数，求出$gcd$，然后全部除掉。这样就能求出$n$个数的$lcm$。 应用到这道题当中，我们就是把$gcd$变成$Fib\_{gcd}$，然后进行对应的乘除。 我们可以枚举$gcd$为$g$，然后问题就变成了：从$n$个数中选出若干个数，使得它们$gcd$为$g$，求数的个数为奇数和为偶数的方案数。 记$f\[i\]\[0/1\]$为$gcd=i$，选的个数为偶数/奇数的方案数。 直接求$gcd$为$i$不太好求，我们可以反演一下，变成求$gcd$为$i$的倍数的方案数，记为$g\[i\]\[0/1\]$。 记所有数中是$i$的倍数的数有$cnt\_i$个，那么有 $$ g\[i\]\[0\]=2^{cnt\_i-1}-1 $$ $$ g\[i\]\[1\]=2^{cnt\_i-1} $$ 反演一下，我们就得到了 $$ f\[i\]\[0\]=\\sum\_{i|d}\\mu(\\frac{d}{i})g\[d\]\[0\] $$ $$ f\[i\]\[1\]=\\sum_{i|d}\\mu(\\frac{d}{i})g\[d\]\[1\] $$ 通过$f\[i\]\[0/1\]​$直接计算数列每项对答案的贡献即可。 Jyc神仙直接用小学奥数解决了这道题，暴踩标算。 而我可能一辈子都学不会小学奥数。