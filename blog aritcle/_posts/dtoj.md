---
title: " DTOJ3639林克卡特树\t\t"
tags:
  - dp
url: 6358.html
id: 6358
categories:
  - Solution
date: 2019-02-06 21:24:54
---

其实题目抽成这样，问题还是等价于选择$K+1$条不相交的链，使得链上边权和最大。 $F(x, k, i)$ 表示考虑以 $x$ 为根的子树，选了 $k$ 条链，点 $x$ 的度数为 $0/1/2$ 的最优解。 这样就可以O(nk)欢乐的dp了。 但是还是做不出来。 但是考虑某个子树。$f(n,k)$表示其选了$k$条链的最优答案，其中记录了最优解和其联通块数。可以发现其最优解关于$k$差分后是递减的。也就是说，多选一条链，其给到的贡献一定没有上一次的大（好像这是废话）。 那么，既然$f(n,k)$一定是一个上凸的函数，我们考虑用一条直线去切这个函数。对于当前这个斜率$a$，我们用这个斜率取切这个凸壳，得到的切点就相当于每选一条边，额外付出$a$的代价。现在我们即是要找一个$a$，使得切点能落在$(K,f(n,K))$上。 二分这个斜率以后做dp即可。最后的答案即是这个最优解加上$a \\times K$。