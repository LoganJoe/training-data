---
title: " DTOJ2834Podział naszyjnika\t\t"
tags:
  - 线段树
url: 4525.html
id: 4525
categories:
  - DTOJ
  - Solution
date: 2018-10-25 12:51:20
---

md暴力和正解写错同一个地方，对拍没拍出错样例也过了。直接从100炸到51，这场测试真的是体现出我有多沙雕。 这题正常的解法应该是hash的，这里讲不正常的线段树做法、（一场测试两题码线段树真是爽 先将环断开，变成$\[1,n\]$的区间。 考虑如何判断切在$x$和$y$是否合法。即每种颜色，要么全部都在$\[x,y\]$中，要么全部都不在$\[x,y\]$中。 我们称在区间中全部出现或全部没出现的颜色种类数为这个区间的$val$。那么我们要统计的就是$val=k$的区间个数和最小的$|n-2\\times 区间长度|$。 考虑枚举区间左端点，然后用线段树维护右端点在每个位置时的区间$val$。线段树上同时维护右端点在对应区间的$val$的最大值和最大值个数以便计算方案。 那么就是当左端点右移时如何维护信息的问题了。 维护每个位置后面第一个和它颜色相同的位置，当左端点右移时根据左端点的颜色已经出现的次数来进行对应的修改，稍微分讨一下即可。 接下来考虑怎么求最小的$n-2\\times 区间长度$。即我们要找到最接近$\\frac{n}{2}$的合法区间长度。 那么我们枚举左端点时，假设左端点为$x$，我们在$x+\\frac{n}{2}$的左边和右边找第一个合法的右端点，然后计算答案即可。