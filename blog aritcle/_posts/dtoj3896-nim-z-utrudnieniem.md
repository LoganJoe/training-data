---
title: " DTOJ3896 Nim z utrudnieniem\t\t"
tags:
  - dp
url: 4142.html
id: 4142
categories:
  - Solution
date: 2018-10-16 12:49:03
---

不如设计一个dp

容易想到的是可以用dp计算方案数。设$f\[i\]\[j\]\[k\]$为考虑前$i$堆，扔掉石子堆数模$d$为$j$，没扔掉的石子异或和为$k$的方案数。直接转移不可行，但是我们将石子从小到大排序后再做转移，那么转移的效率就可以做到$O(md)$的了。

注意到后一维可以到$10*1048576$,第一维可以滚动。但是由异或的性质可知，$f\[i\]\[j\]\[k\]$与$f\[i\]\[j\]\[k^{}a\[i\]\]$是的转移是一对“蝴蝶转移”，所以我们可以免去滚动数组，直接在原地做dp即可。