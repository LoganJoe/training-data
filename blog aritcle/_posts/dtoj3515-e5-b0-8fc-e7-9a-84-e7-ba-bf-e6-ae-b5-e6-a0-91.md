---
title: " DTOJ3514小C的线段树\t\t"
tags:
  - dp
  - 奇技淫巧
url: 400.html
id: 400
categories:
  - DTOJ
  - Solution
date: 2018-01-23 20:05:18
---

注意到如果$n>m$，答案为$0$。 又因为$nm<=10^5$，所以我们可以认为$n<320$。 将一个区间$\[l,r)$看作在位置$l$上$+1$，在位置$r$上$-1$，位置$i$最终的值就是$i$的前缀和。 用$f\[i\]\[l\]\[r\]$表示在位置$i$，左边有$l$个$+1$，$r$个$-1$的方案数，$g\[i\]\[l\]\[r\]$表示当前这些方案的贡献和。每次先让$g\[i\]\[l\]\[r\]$加上$f\[i\]\[l\]\[r\]\\times (l-r)^k$，再枚举位置$i+1$要是否$+1$，$-1$或者先$+1$再$-1$转移。注意保证$l\\geqslant r$。 我们可以把第一维的空间压掉变成$f\[2\]\[l\]\[r\]$，即可满足空间限制。