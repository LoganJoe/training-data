---
title: " BZOJ3498[PA2009]Cakes\t\t"
tags:
  - 思路
url: 6749.html
id: 6749
categories:
  - BZOJ
  - Solution
date: 2019-03-03 13:54:13
---

三元环计数板子题。 我之前那种常数大的写法居然！被卡了！ 我们预处理出每个点的度数，然后将边重定向，变成度数大的点向度数小的点连边（度数相同就编号小的连向标号大的）。 然后我们枚举每个点，计算度数最大的点为它的三元环的贡献。 记当前点为$x$，对于所有$x\\rightarrow y$的边我们先给$y$打上标记。然后我们再依次枚举$x\\rightarrow y$的边，然后再枚举$y\\rightarrow z$的边。 如果$z$是被标记过的点，就说明存在一个$(x,y,z)$的三元环，将$\\max\\{A\_x,A\_y,A_z\\}$计入答案即可。 时间复杂度$\\Theta(m\\sqrt m)$。