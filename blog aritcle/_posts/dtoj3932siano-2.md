---
title: " DTOJ3932Siano\t\t"
tags:
  - 二分
  - 线段树
url: 4165.html
id: 4165
categories:
  - DTOJ
  - Solution
date: 2018-10-17 15:15:31
---

为了使收割看起来整齐一点，我们可以重新排列一下草的相对顺序，把$a\_i$大的草排在前面。这样我们每次收割，都是收割以$1$为左端点的某段区间的草。且在任何时刻，草的高度都是非增的。 割草区间的右端点我们可以考虑二分。即维护区间最矮的草（相同的认为右边更矮），区间最矮的草一定是增长最慢的草，也就是最右边的草。由于有区间修改（割草和草的生长），我们可以用线段树维护区间最矮的草的高度，然后二分就在线段树上二分即可。 求出割草区间右端点$r$后，我们只要用$\[1,r\]$所有草的高度和减去$r\\times b\_i$就是答案了。 因此我们还要维护区间草的高度和。 割草的影响就是区间赋值，我们给割草区间的草的高度重新赋值即可。 天数的变化影响的是区间草的高度和及最矮的草的高度，通过维护区间的$a\_i$的和及$a\_i$最小值即可维护。 因此线段树要维护$2$个区间和、$2$个区间最小值、$1$个加法标记和$1$个赋值标记。 其中有$1$个区间和$1$个区间最小值不会被修改。 要注意标记的优先级，以及可能会区间赋值成$0$。