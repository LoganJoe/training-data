---
title: " DTOJ2970Shell Necklace\t\t"
tags:
  - FFT
  - 分治
  - 多项式
url: 5737.html
id: 5737
categories:
  - Solution
date: 2018-12-23 12:22:04
---

考虑dp怎么做。 $f\[i\]$为长度为$i$的项链装饰的方案数。那么有 $$f\[i\]= \\sum_{j=0}^{i-1}f\[j\]a\[i-j\]$$ 注意到后面是个卷积的形式。但是这不能简单地用多项式乘法来计算。我们要知道前面的$f\[i\]$才能计算后面的$f\[i\]$。 考虑分治。 对于当前区间$\[l,r\]$，我们考虑$\[l,mid\]$对于$\[mid+1,r\]$的贡献。每次作出的贡献就是前半段的$f$与$a$卷在一起。 分治FFT即可。 另外的思路是，其实这个东西就是$A(x)=\\sum_{i=1}a\[i\]x^i$与$B(x)=x^n$的复合。考虑求$A \\circ B(x)$。 注意到，实际上有$B(x)=\\frac{1}{1-x}$。因此这其实是一个多项式求逆。 另外我们还可以考虑多项式对数的性质。多项式对数实际上就是多项式与对应麦克劳林级数的复合。因此我们可以用多项式ln加上求$\\frac{1}{x}$的复合逆求出两个东西的复合。那么这也就是答案了。