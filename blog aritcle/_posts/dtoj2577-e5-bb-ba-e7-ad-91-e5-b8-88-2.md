---
title: " DTOJ2577建筑师\t\t"
tags:
  - 斯特林数
url: 5108.html
id: 5108
categories:
  - DTOJ
  - Solution
date: 2018-11-13 16:10:57
---

考虑把最高的建筑删掉，把剩下的建筑分成左右两个部分。 对于左边，每个能被看到的建筑都会挡住一些建筑（可能是$0$个），右边同理。 那么我们将每个能被看到的建筑和它挡住的建筑看作一个序列，那么$n-1$个建筑就被分成了$A+B-2$个序列。 对于每个序列，最前面的数一定是最大的。这其实就相当于一个圆排列从最大的数那里断开。 那么就变成了求$n-1$个数划分成$A+B-2$个圆排列的方案数乘上选$A-1$个圆排列放在左边的方案数。 圆排列的方案数是第一类斯特林数，选$A-1$个放在左边的方案数是组合数。 那么答案就是 $$\\left \[ \\begin{matrix} n-1 \\newline A+B-2 \\end{matrix} \\right \]\\times \\binom{A+B-2}{A-1}$$ 预处理出第一类斯特林数和组合数就可以$\\Theta(1)$回答询问了。