---
title: " DTOJ2533狼群\t\t"
tags:
  - dp
  - 二分
url: 236.html
id: 236
categories:
  - DTOJ
  - Solution
date: 2018-01-15 20:13:31
---

先考虑没有修改，我们在$\[l,r\]$中二分一个答案$mid$。 如果存在一条路径的第$K$大$>mid$，则答案在$(mid,r\]$，否则在$\[l,mid\]$。 即我们要判断一条路径有多少个点的值比$mid$大，如果有$\\geqslant K$个，则这条链的第$K$大就一定$>mid$。 这个可以用$dp$简单解决：$f\[x\]$表示从$x$往下走最多能经过的有贡献的点的个数，$g\[x\]$表示从$x$往下走不经过$f\[x\]$的路径最多能经过的有贡献的点的个数。这样经过某个点的路径最多可以有$f\[x\]+g\[x\]$或$f\[x\]+g\[x\]+1$个的点值比$mid$大。就能解决第一问。 现在考虑修改的情况。 令第一问的答案为$ans$。则如果$x$修改后的点权$v\\leqslant ans$就对答案没有影响。 如果$v>ans$，则在经过$x$的路径中，$v$一定是前$K$大。若$v$是第$K$大，则答案就为$v$；否则答案为这条路径的第$K$大，也就是除了$x$的第$K-1$大。因此我们要找到经过$x$的路径中除了$x$最大的第$K-1$大是多少。可以用第一问的$dp$解决。 因为$m\\leqslant 5$，所以我们只要预处理经过每个特殊点的路径，除了特殊点最大的第$K-1$大是多少，就可以$O(1)$回答询问。