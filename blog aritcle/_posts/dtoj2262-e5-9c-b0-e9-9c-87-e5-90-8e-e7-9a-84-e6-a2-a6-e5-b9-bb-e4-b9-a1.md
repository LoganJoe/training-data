---
title: " DTOJ2262地震后的梦幻乡\t\t"
tags:
  - 期望
  - 概率
  - 状压dp
url: 3340.html
id: 3340
categories:
  - DTOJ
  - Solution
date: 2018-08-07 22:59:01
---

这是一道很…奇怪的题。 那个提示挺有用的…但是好像证明特别复杂…所以直接当结论用吧。 然后我们就可以想到一个暴力（没有想到），我们去枚举每条边是第几大的，然后求一下mst，假设mst最大边是第$k$大的，那么再用提示的结论算一下这条边的期望，最后再除总方案数即可。 我们记$p\_i$为mst最大边排名为$i$的概率，那么答案就是 $$\\sum\_{i=1}^{m}\\frac{ip\_i}{m+1}$$ 那么我们只用求出$\\sum\_{i=1}^{m}ip\_i$。 记$P\_i$为mst最大边排名$\\geqslant i$的概率，那么答案就变成了 $$\\sum_{i=1}^{m}P\_i$$ 记$P'\_i$为用排名$\\leqslant i$的边不能组成生成树的概率，那么答案就是 $$\\sum_{i=0}^{m-1}P'\_i$$ 对于$P'\_i$，等同于选$i$条边不能组成生成树的概率，我们只用求出方案数然后除以总方案数就能得到概率了。 我们用$f\[S\]\[i\]$表示在点集$S$中选了$i$条边，$S$仍然不连通的方案数。 转移的话，我们任选一个$S$中的点$p$，考虑$p$在哪个连通块里。即枚举$S$的一个子集$T$，使得$p\\in T$，然后有 $$(\\binom{edge(T)}{j}-f\[T\]\[j\])\\times \\binom{edge(S∧T)}{i-j}\\Rightarrow f\[S\]\[i\]$$ 那么$P'_i=\\frac{f\[2^n-1\]\[i\]}{\\binom{m}{i}}$。 其实这题正解是什么多项式积分…但是这个方法应该也没错。