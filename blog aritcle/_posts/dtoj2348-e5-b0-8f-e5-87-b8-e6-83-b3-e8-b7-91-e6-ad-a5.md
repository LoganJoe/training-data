---
title: " DTOJ2348小凸想跑步\t\t"
tags:
  - 半平面交
url: 529.html
id: 529
categories:
  - DTOJ
  - Solution
date: 2018-02-05 13:43:20
---

假设选的点为$P(a,b)$。 则题目的限制可以写成不等式。即（$\\times$为叉积）

$(P\_1-P)\\times (P\_2-P)<(P\_i-P)\\times (P\_{i+1}-P)i\\in \[2,n\]$

把叉积拆开

$(x\_1-a)(y\_2-b)-(x\_2-a)(y\_1-b)<(x\_i-a)(y\_{i+1}-b)-(x_{i+1}-a)(y_i-b)$

$x\_1y\_2-ay\_2-bx\_1-x\_2y\_1+ay\_1+bx\_2<x\_iy\_{i+1}-ay_{i+1}-bx\_i-x\_{i+1}y\_i+ay\_i+bx_{i+1}$

$a(y_{i+1}-y\_i+y\_1-y\_2)+b(x\_i-x_{i+1}-x\_1+x\_2)<x\_iy\_{i+1}-x_{i+1}y\_i-x\_1y\_2+x\_2y_1$

$b(x\_i-x\_{i+1}-x\_1+x\_2)<a(y\_i-y\_{i+1}-y\_1+y\_2)+x\_iy\_{i+1}-x_{i+1}y\_i-x\_1y\_2+x\_2y_1$

令$A=y\_i-y\_{i+1}-y\_1+y\_2$，$B=x\_i-x\_{i+1}-x\_1+x\_2$，$C=x\_iy\_{i+1}-x_{i+1}y\_i-x\_1y\_2+x\_2y_1$。 将$a$看作$x$，$b$看做$y$，则有

$By<Ax+C$

这是半平面的形式。 由于点要在凸包内部，用凸包的边当半平面限制一下。 按$A$，$B$的正负和是否为$0$分类讨论一下做半平面交即可。 注意$A=0$，$B=0$时可能会出现的无解。