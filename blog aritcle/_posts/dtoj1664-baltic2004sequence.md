---
title: " DTOJ1664 [Baltic2004]sequence\t\t"
tags:
  - 可并堆
url: 459.html
id: 459
categories:
  - Solution
date: 2018-02-04 12:23:01
---

我们先整体考虑两种情况。对于原序列： 1.当整个序列单调递增时，很明显令$b\_i=a\_i$,ans=0; 2.当整个序列单调递减时，我们可以贪心选择，令$b_i$为原序列的中位数。 那么我们大概可以得到一个思路，将序列划分为多个单调递减的子序列。对于子序列的中位数不单调的情况，我们与前一个子序列合并，确保当前栈中的中位数单调不降。 为了维护一个子序列的中位数，我们可以使用左偏树来维护。可以知道，合并后的中位数肯定不会比之前的中位数更大，那么我们在左偏树中保存一个子序列的前一半，大根堆堆顶就是中位数了。