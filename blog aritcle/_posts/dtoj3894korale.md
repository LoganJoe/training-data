---
title: " DTOJ3894Korale\t\t"
tags:
  - 二分
  - 线段树
url: 4052.html
id: 4052
categories:
  - Solution
date: 2018-09-23 17:17:07
---

先考虑第k大的怎么计算吧。

将所有项链从小到大排序，用堆处理操作。保存一个二元组$(v,id)$表示当前做到第$id$个珠子，权值为$v$。小根堆以$v$做关键字，每次取出堆顶并且拓展$(v+A\[id+1\],id+1)$和$(v-A\[id\]+A\[id+1\],id+1)$。第$k$个就是第$k$小项链的价值。

转而考虑第二问。首先第$k$大的那个价值，可能会有好多个。我们要找到最早的那个。可以直接dfs来找到第k小，只要保证搜索的状态在$1 \\to k$中即可。

dfs的时候我们保存做到第$x$步，还能取的价值为$v$。那么每次在线段树上，要得到的是位置$p$之后，值比$t$小的第一个元素。这个可以在线段树上二分得到。这样保证只会搜到第k大的。