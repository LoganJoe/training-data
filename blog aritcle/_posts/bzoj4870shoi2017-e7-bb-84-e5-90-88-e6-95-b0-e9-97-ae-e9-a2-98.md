---
title: " BZOJ4870[Shoi2017]组合数问题\t\t"
tags:
  - dp
  - 思路
  - 矩阵
url: 6419.html
id: 6419
categories:
  - BZOJ
  - Solution
date: 2019-02-08 12:14:12
---

我感觉这题思路挺好的。 我们要求的是 $$ \\sum_{i=0}^{\\infty}\\binom{nk}{ik+r} $$ 也可以写成 $$ \\sum_{i\\%k=r}\\binom{nk} i $$ 组合意义是，从$nk$个物品中，选的个数$\\%k=r$的方案数。 考虑dp。 记$f\[i\]\[j\]$为从$i$个物品中，选的个数$\\%k=j$的方案数。 那么有 $$ f\[i\]\[j\]=f\[i-1\]\[j\]+f\[i-1\]\[(j-1+k)\\% k\] $$ 显然可以写成矩阵的形式，然后用矩阵快速幂优化。 时间复杂度$\\Theta(k^3\\log nk)$。 观察一下可以发现，转移矩阵实际上是个循环矩阵，即每行循环位移一位就是下一行。 那么我们只用维护循环矩阵的一行即可。 时间复杂度$\\Theta(k^2 \\log nk)​$。 循环矩阵的乘积实际上是一个卷积，可以用FFT优化。 时间复杂度$\\Theta(k\\log k\\log nk)$。但这题模数不适合NTT，用FFT会炸精度。