---
title: " DTOJ3971circle\t\t"
tags:
  - 倍增
url: 4231.html
id: 4231
categories:
  - Solution
date: 2018-10-19 16:29:48
---

题目大意是给你一个$n$个点$m$条边的图，每一条边都有一个权值。要求图中的最小正权环。

吐槽：数据太弱，原数据可以用各种方法水过。

各种暴力方法:

1.可以用拆点跑$SPFA$。本来是$n^2m$的，但是注意到一个正环一定有一种遍历方法，这种遍历顺序上走过的边权和始终大于0，所以在$SPFA$中只加入当前权值大于0的点。

2.也可以用$dfs$加剪枝。

当然，现数据把以上2种算法都卡死了。

正解:

考虑倍增。如果我们能预处理出所有在$2^i$步内，任意两点之间的最大距离，那么用倍增的做法就可以在$log_2 n$的时间复杂度内求出最小的正环。

对于$k$步内任意两点间的最小值可以用一个矩阵表示，两个矩阵的合并类似$Floyed$。