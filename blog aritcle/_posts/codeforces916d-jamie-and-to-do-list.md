---
title: " Codeforces916D Jamie and To-do List\t\t"
tags:
  - 可持久化线段树
url: 5198.html
id: 5198
categories:
  - Codeforces
  - Solution
date: 2018-11-21 20:37:00
---

### 题意

维护一个集合$S$，里面每个数有一个价值。 要求支持插入/删除/修改/撤销/查询集合中比某个数的价值小的数的个数。

### 题解

我们可以开一个权值线段树来记录每种价值的数量。由于要支持撤销，因此要写可持久化线段树。 这样就可以实现插入了。 删除和修改时我们只需要知道这个数对应的价值即可在线段树上修改。 本来可以直接用map存下每个数对应的价值，但是有撤销，因此每个数对应的价值会改变。所以我们还要再开一棵可持久化线段树维护每个数对应的价值，实际上是用可持久化线段树实现可持久化数组。 查询时我们也是求出这个数对应的价值，然后在线段树上查询即可。