---
title: " DTOJ3657排列\t\t"
tags:
  - 思路
  - 最小割
url: 1572.html
id: 1572
categories:
  - DTOJ
  - Solution
date: 2018-04-19 19:18:50
---

将$x\_a$要在$x\_b$之前的限制看作从$a$到$b$的一条边。 考虑选一些数组成最大子段和。一个方案合法当且仅当：如果存在路径$i->j->k$且$i$和$k$都选了，那么$j$也必须要选。 那么每一条路径都可以分为不选->选->不选的三段。 将每个点$i$拆成$i\_1,i\_2$，$S$到$i\_1$，$i\_1$到$i\_2$，$i\_2$到$T$三条边，割了哪条就表示在这个数在对应的段里。最优解肯定是所有正数，那么对于$x\_i>0$的$i$，建$S$到$i\_1$，$i\_2$到$T$，容量为$x\_i$的边；对于$x\_i<0$的$i$，建$i\_1$到$i\_2$，容量为$-x\_i$的边。最终的答案为所有正数的和减去最小割。 限制的建边很巧妙。对于每个限制$(a,b)$，$a\_1$到$b\_1$，$a\_2$到$b\_2$连容量为$inf$的边。这样如果有路径$i->j->k$，且$i,k$都选了，那么就有一条$S->i\_1->j\_1->j\_2->k\_2->T$的路径，必须割掉其中的一条边，也就是改变$i,j,k$其中一个选择的状态才行。