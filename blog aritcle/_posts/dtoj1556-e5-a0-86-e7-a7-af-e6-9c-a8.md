---
title: " DTOJ1556堆积木\t\t"
tags:
  - LIS
url: 4349.html
id: 4349
categories:
  - Solution
date: 2018-10-22 19:20:07
---

求出的最长序列，对于序列中$\\forall i,j: j<i,a\[j\]<a\[i\],j-a\[j\]\\leq i-a\[i\]$

因为不管怎么剔除，相对位置一定不会改变，并且后面的移动不会比前面的移动的更少。

看着像一个三维偏序问题。

但是注意到$i=(i-a\[i\])+a\[i\]$。这说明，当$a\[i\]$单调递增，$i-a\[i\]$单调不减的时候，$i$也肯定是单调递增的。

于是现在就剩下二维偏序了。一维排序，树状数组维护最长LIS就好了。