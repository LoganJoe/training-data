---
title: " BZOJ4589Hard Nim\t\t"
tags:
  - FWT
  - 博弈
url: 6177.html
id: 6177
categories:
  - BZOJ
  - Solution
date: 2019-01-24 17:05:15
---

玩的游戏就是NIM游戏。后手必胜的条件就是石子的异或和为$0$。 那么问题就转化成了求$n$堆石子，每堆个数是$\\leq m$的质数，石子异或和为$0$的方案数。 记$f\[i\]\[j\]$为$i$堆石子，每堆个数是$\\leq m$的质数，石子异或和为$j$的方案数。 那么有 $$ f\[i\]\[j\]=\\sum_{k=2,k为质数}f\[i-1\]\[j\\oplus k\] $$ 其中$\\oplus$表示异或。 我们可以先筛出$\\leq m$的质数，然后转移用FWT优化，每次$\\Theta(m\\log m)$。 一共要转移$n$次，那就用快速幂优化即可。