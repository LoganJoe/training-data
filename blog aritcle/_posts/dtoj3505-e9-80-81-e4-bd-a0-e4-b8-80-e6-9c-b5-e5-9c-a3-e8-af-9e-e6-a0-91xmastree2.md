---
title: " DTOJ3505送你一朵圣诞树xmastree2\t\t"
tags:
  - 奇技淫巧
  - 并查集
url: 290.html
id: 290
categories:
  - DTOJ
  - Solution
date: 2018-01-18 20:06:36
---

这题的解法有点巧妙。 首先我们肯定是要枚举根节点。 然后发现，对于于权值最小的点，能选它的时候立刻把它选了才会使答案最优，也就是选了它父亲后就马上选它。说明它和它父亲选择的相对顺序已经确定了。 每个相对顺序已经确定的点集，可以用一个二元组$(v,w)$表示，其中$v$是点权之和，$w$是点数。 现在考虑如果有多个可以选的点集，先选点集$i$会比先选点集$j$更优的条件是

$v\[i\]+w\[i\]\\times v\[j\]>v\[j\]+w\[j\]\\times v\[i\]$

即$w\[i\]\\times v\[j\]>w\[j\]\\times v\[i\]$

$\\frac{w\[i\]}{v\[i\]}>\\frac{w\[j\]}{v\[j\]}$

因此我们用堆维护可以选的点集，然后把最优的点集和点集祖先的父亲所属的点集绑定起来，重新放入堆中，同时计算答案即可。