---
title: " Codeforces 828\t\t"
url: 2170.html
id: 2170
categories:
  - Solution
date: 2018-05-29 20:09:24
tags:
---

题目见[http://codeforces.com/gym/224278](http://codeforces.com/gym/224278)

### A. String Reconstruction

大概就是给你字符串上面几个位置的字符，要你还原出原串。 这个暴力赋值肯定不可取的。于是我们可以想到，既然保证合法，那么赋值顺序随意。那么我们可以用并查集维护这个串，对于赋值过的部分合并成一块，下次就不用再次赋值了。理论复杂度$O(len)$

### B. High Load

大概就是构造一个$n$个点的图，使得其中有$k$个度为$1$的点，并且之间距离的最大值最小。 我们可以想到构造一棵树，同样会满足要求。问题在于构造一棵树，其中有$k$个叶子节点的同时，令树的直径最小。 可以想到一个（比较靠谱的）思路，就是要让树的深度尽量平均。那么就会想到让树从根出发的链的条数为k，并且每条链长度相差不超过1.直接构造就可以了。

### C. DNA Evolution

一看到基因我就倒胃口。基因字符串。 给定一个基因（字符）串，要求支持以下两种操作：

1.  修改一个位置的字符
2.  查询$\[l,r\]$中,与串$AAAA$...(循环相接直至长度大于$r-l+1$）匹配的位置数。

题意有点意会，可以结合样例理解以下问题。$len,Q \\leq 10^5$ 发现这样一个问题并不好处理。但是观察数据范围，发现每次仅更新一个字符，并且有模式串（2操作中串）长度小于等于10。 由以上性质，问题简单很多。相当于我们只需要查询在$\[l,r\]$中，字符$A_i$在$l+i,l+i+len,l+i+2len...$等位置中出现了几次。 那么我们记$f\[i\]\[j\]\[k\]\[pos\]$为从第$i$个位置开始的，循环节为$j$，第$K$个字符$(A,T,G,C \\Rightarrow 0,1,2,3)$在$1...pos$中出现了多少次。为支持修改，第四维我们用树状数组解决。于是这个问题就变成了修改与查询问题。 好像跟字符串一点关系都没有了。