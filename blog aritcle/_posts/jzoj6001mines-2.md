---
title: " JZOJ6001Mines\t\t"
tags:
  - tarjan
  - 线段树
url: 6074.html
id: 6074
categories:
  - Solution
  - 其他OJ
date: 2019-01-16 23:13:00
---

如果第$i$个地雷爆炸会引爆第$j$个地雷，那么就连一条$i\\rightarrow j$的边。 对于一个强连通分量，只要引爆其中一个炸弹，所有地雷就都会爆炸。 那么我们可以用tarjan缩点，将新点的点权设为强连通分量中所有点的点权最小值。由于有修改，最小值可能会发生变化，因此我们要对于每个强连通分量开个set动态维护最小值。 缩完点后，我们得到了一个DAG。 显然入度为$0$的点一定要被引爆。并且将所有入度为$0$的点引爆后，剩下的所有地雷都会爆炸。 因此答案就是所有入度为$0​$的点权和。 我们在修改时处理一下被修改的点对答案的影响即可。 问题在于怎么建图然后去缩点。 暴力建边是$\\Theta(n^2)$的，显然不能接受。 我们将地雷按照坐标从小到大排序，那么一个点一定是向一段区间里的所有点连边。 我们用线段树优化建图即可。 要注意优化建图的辅助点和辅助边有时候并不能使入度$+1$（否则图中就永远只有$1$个入度为$0$的点了），只有和叶子节点有关的点才可以使入度$+1$，至于什么事有关的留给读者自行思考。 时间复杂度$\\Theta(n\\log n)。$