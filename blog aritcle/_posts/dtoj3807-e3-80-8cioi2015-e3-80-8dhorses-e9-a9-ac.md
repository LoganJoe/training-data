---
title: " DTOJ3807「IOI2015」horses马\t\t"
tags:
  - 线段树
url: 6723.html
id: 6723
categories:
  - DTOJ
  - Solution
date: 2019-02-28 22:41:08
---

首先，只会在某一年末卖出所有的马。如果在两年末都卖出了马，把其中一年卖的在另一年卖掉肯定更优。 那么在第$i$年末卖出所有的马的收益就是$Y\_i\\cdot \\prod\\limits\_{j=1}^iX_j$。 考虑如何维护收益的最大值。 乘积肯定很大，我们无法直接比较两个收益的大小。 有一个小trick，我们对要乘的每个数取个对数，然后相加，这样比较乘积的大小就变成了比较对数和的大小。 数据范围较大时容易被卡精度，但这题好像不会。 这样就变成了动态维护前缀和的最大值了。 可以用线段树直接维护每个区间的最大前缀和，或者直接维护前缀和序列，修改变成区间加即可。 线段树上既要存对数和，也要存对数和对应的乘积在$\\bmod 10^9+7$意义下的值。 时间复杂度$\\Theta(n\\log n)$。