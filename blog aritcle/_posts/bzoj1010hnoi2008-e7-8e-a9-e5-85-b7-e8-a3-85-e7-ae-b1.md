---
title: " BZOJ1010[HNOI2008]玩具装箱\t\t"
tags:
  - 单调队列
  - 斜率dp
url: 6327.html
id: 6327
categories:
  - BZOJ
  - Solution
date: 2019-02-05 13:49:09
---

考虑dp。 记$f\[i\]$为将前$i$个玩具放完的最小费用。 枚举最后一个容器放了哪些，有 $$ f\[i\]=\\min_{j=0}^{i-1}\\{f\[j\]+(Sum\[i\]-Sum\[j\]+i-j-1-L)^2\\} $$ 其中，$Sum\[i\]=\\sum_{j=1}^i C_j$。 拆开平方 $$(Sum\[i\]-Sum\[j\]+i-j-1-L)^2$$ $$=(Sum\[i\]+i-L)^2+(Sum\[j\]+j+1)^2-2(Sum\[i\]+i-L)(Sum\[j\]+j+1)$$ $(Sum\[i\]+i-L)^2$只和$i$有关，单独拎出来算即可。 熟悉的话可以很容易看出来这是个斜率的式子。 将$Sum\[j\]+j+1$看成横坐标，$(Sum\[j\]+j+1)^2$看成纵坐标。 然后我们要拿一条斜率为$2(Sum\[i\]+i-L)$的直线去过其中一个点，使得纵截距最小。 显然只有在下凸壳的点才有用。 每次插入的点横坐标都是递增的，很容易维护下凸壳。 每次查询的直线的斜率也是递增的，这说明最优的转移点也是右移的。那么我们可以用单调队列维护最优的转移点。 时间复杂度$\\Theta(n)$。