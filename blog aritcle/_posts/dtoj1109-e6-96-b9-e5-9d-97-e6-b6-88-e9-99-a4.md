---
title: " DTOJ1109方块消除\t\t"
tags:
  - 区间dp
  - 奇技淫巧
url: 1773.html
id: 1773
categories:
  - DTOJ
  - Solution
date: 2018-04-28 23:32:26
---

特殊的区间dp。和[DTOJ1095小火鸡](http://www.dtenomde.com/2018/04/author=jiangyutong/article=1766/)类似。 记$f\[l\]\[r\]\[k\]$表示区间$\[l,r\]$后面还有$k$个和第$r$位相同的字符被消除完能得到的最高分数。 转移有两种。一种是消除最后一段 $$f\[l\]\[r-1\]\[0\]+(k+1)^2\\rightarrow f\[l\]\[r\]\[k\]$$ 第二种转移比较神奇。找到和第$r$位相同的一个位置$i$，然后消除$\[i+1,r-1\]$，把剩下的两段拼一起。即 $$f\[l\]\[i\]\[k+1\]+f\[i+1\]\[r-1\]\[0\]\\rightarrow f\[l\]\[r\]\[k\]$$ 因为如果这次消除的区间右端点不是$r-1$的话，会在其他的区间被考虑到。 考虑到效率问题可以一开始就把相同颜色的块压在一起存下长度。 用记忆化搜索写起来会比较方便。