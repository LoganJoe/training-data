---
title: " DTOJ3130流浪者\t\t"
tags:
  - dp
  - 容斥
url: 5003.html
id: 5003
categories:
  - Solution
date: 2018-11-02 13:52:23
---

题目大意是求有一个人在网格图上走，走到一个障碍上就除以2，求最后值的期望。

这种题是经典模型，所以直接考虑dp和容斥。

首先由于值是不会超过$10^6$的，所以碰到障碍20次后再碰就没有什么意义了。

然后设$f\[i\]\[j\]$表示走到第$i$个障碍，此时恰好经过$j$个（若$j=21$，则为大于$j$）障碍的路径条数，然后就不会做了。

所以我们稍微改动一下方程，设$g\[i\]\[j\]$表示走到第$i$个障碍，此时恰好经过$j$个障碍的路径条数（$j\\leq 20$）。设$f\[i\]\[j\]$为走到第$i$个障碍，此时经过$j$个以上的障碍的路径条数。显然$g\[i\]\[j\]=f\[i\]\[j\]-f\[i\]\[j+1\]$。然后用$g\[i\]\[j\]$去更新$f\[k\]\[j+1\]$，就不会重复了。