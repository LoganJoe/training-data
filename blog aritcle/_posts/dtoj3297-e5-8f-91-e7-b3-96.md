---
title: " DTOJ3297发糖\t\t"
tags:
  - dp
  - 分治
  - 线段树
url: 2362.html
id: 2362
categories:
  - Solution
date: 2018-06-12 20:11:00
---

EFina原创题。 那么cthulhu fhatgn是什么意思呢。 对于这个题，我们可以看做是一个价值为$v$,重量为￥w￥的物品，在时间$\[l,r\]$中存在。 那么我们建立时间轴，然后考虑用数据结构维护答案。 对于根到某一叶子节点的一条树链，其上面所有的标记总和，相当于覆盖到l的所有物品，那么我们可以考虑做背包dp。但是由于其要利用到上面链的所有dp，因此开销很大。因此我们存$f\[deep\]\[i\]$为做到当前深度deep，覆盖到当前区间$\[l,r\]$的所有物品中，背包容积为$i$所能获得的最大价值和。M比较小。 于是就可以看做是每到一个节点新加一些物品，同时利用$deep-1$的历史信息，做一下dp，然后得到当前节点的答案。 这样子在每个节点做一次dp,效率应该是$O(n m log n)$