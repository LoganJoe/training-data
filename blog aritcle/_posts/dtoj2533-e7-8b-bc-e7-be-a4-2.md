---
title: " DTOJ2533狼群\t\t"
tags:
  - 二分
  - 树形dp
url: 5137.html
id: 5137
categories:
  - Solution
date: 2018-11-16 13:30:58
---

首先可以想到二分答案，然后转化为判定性问题。具体就是对于二分到的答案，找是否有路径上大于答案的点数量大于$k$的路径。这个可以用树上dp求出权值最长链和次长链计算答案。

那么考虑一个修改。那么对于这个修改，假设其在答案路径上并且改到了比第$k$小大的权值，那么答案显然是路径上$k-1$大的。反之，答案不会有变化。

那么我们就可以对于每个关键点，求出将这个关键点删除后，$k-1$大的路径上的点。注意到$M \\leq 5$，所以这个是可以接受的。

然后对于每个询问，我们可以得到一个可行解就是$\\min(v_i+\\Delta,ans\[p\])$。然后还要考虑对于答案没有贡献，与未操作的答案取个$\\max$就是最优的答案了。