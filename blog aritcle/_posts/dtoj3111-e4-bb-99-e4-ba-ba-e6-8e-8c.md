---
title: " DTOJ3111仙人掌\t\t"
tags:
  - dp
  - 思路
url: 3716.html
id: 3716
categories:
  - DTOJ
  - Solution
date: 2018-08-28 20:52:57
---

第$\\infty$次被仙人掌吓到弃疗。 发现部分分有树，我们先来考虑树要怎么做。 我们把每条边看成有两条，即假装它有重边。 那么问题就变成了用边不相交的链覆盖所有边的方案数。 考虑与某个点相连的所有边，这些边可以两两配对（一条链最多只能同时覆盖两条），也可以不配对。 记$f\[i\]$为$i$条边配对的方案数，那么有 $$f\[i\]=f\[i-1\]+(i-1)f\[i-2\]$$ 即考虑第$i$条边要不要配对。 记第$i$个点的度数为$deg\_i$，那么答案就是$\\prod\_{i=1}^{n}f\[deg_i\]$。 现在考虑无向图要怎么做。 如果原图不是仙人掌的话，那么答案一定是$0$。 如果是仙人掌的话，我们把环上的边删掉，因为这些边直接肯定不能再加边了。那么就变成了很多棵树。 我们把每棵树的方案数乘起来就是答案了。