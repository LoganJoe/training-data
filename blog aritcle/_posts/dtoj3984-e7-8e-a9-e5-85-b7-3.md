---
title: " DTOJ3984玩具\t\t"
tags:
  - 期望
  - 概率dp
url: 5055.html
id: 5055
categories:
  - DTOJ
  - Solution
date: 2018-11-13 15:56:33
---

神仙期望题。 直接抄题解了。 记$p\[i\]\[j\]$为$i$个点的森林，其中第一棵树有$j$个点的概率。 考虑第$i$个点是否在第一棵树中可以转移，即 $$p\[i\]\[j\]=p\[i-1\]\[j-1\]\\times \\frac{j-1}{i!}+p\[i-1\]\[j\]\\times \\frac{i-j}{i!}$$ 记$f\[i\]\[j\]$为$i$个点的树，深度不超过$j$的概率。$g\[i\]\[j\]$为$i$个点的森林，深度不超过$j$的概率。 那么显然有$f\[i\]\[j\]=g\[i-1\]\[j-1\]$。 那我们考虑求出$g\[i\]\[j\]$。 我们可以枚举第一棵树的大小$k$，那么有 $$g\[i\]\[j\]=\\sum_{k=1}^{i}f\[k\]\[j\]\\times g\[i-k\]\[j\]\\times p\[i\]\[k\]$$ 最后$f\[n\]\[i\]-f\[n\]\[i-1\]$就是$n$个点深度为$i$的树的概率，乘上$i$再加起来就是期望了。