---
title: " DTOJ4084演艺\t\t"
tags:
  - dp
  - 思路
  - 拓扑序
  - 最短路
url: 5916.html
id: 5916
categories:
  - Solution
date: 2019-01-01 13:53:54
---

我们发现题目给的定义很像“互斥割点”的定义。 不妨放在最短路网上面考虑。那么考虑任意一条最短路网上面的路径。在DAG上很容易用拓扑图dp求出经过某点的最短路径数$f\[x\]$。 对于不同的路径数量，我们对于一个大质数取模再离散，假装他不会冲突的样子。那么考虑所选的$A,B$两点，一定满足的条件是$f\[A\]+f\[B\]=f\[S\]$。这个限制很好满足，我们排个序推一推就可以求出来了。另外考虑处理路径不相交的限制。这个限制要求我们不能找到一条$A \\to B$或者$B \\to A$的路径。 依然在最短路网上面考虑，原图已经没用了，记$MarbS\[x\]$为$x$出发可到达的点和能到达$x$的点的状态，可以用bitset存下。这个可以在上面的拓扑图dp时顺带求出。 我们还要存下所有满足$f\[i\]=x$的点的状态为$MarbT\[x\]$。同样用bitset可以完成。 那么对于某个$A$点，其合法的$B$点数目就是$count(MarbT\[x\])-count(MarbS\[A\] & MarbT\[x\])$。 Marb是什么意思？Marble？Marburg。   .