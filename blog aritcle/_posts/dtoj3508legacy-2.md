---
title: " DTOJ3508Legacy\t\t"
tags:
  - 奇技淫巧
  - 线段树
url: 3334.html
id: 3334
categories:
  - Solution
date: 2018-08-07 21:57:28
---

这题很花哨啊...

线段树优化连边的模板。

建立两颗线段树$A$、$B$，其中$A$线段树每个非叶子节点的儿子向该节点连边，长度为$0$，$B$线段树每个非叶子节点向该节点的儿子连边，长度为$0$；$B$线段树的叶子结点向$A$线段树对应的叶子结点连边，长度为$0$。

这里面仅有$A$线段树的叶子结点代表原图中的节点，其余节点都用来优化建图。

*   对于$x$到$y$的边，$A$中对应$x$的叶子节点向$B$中对应$x$的叶子节点连边。
*   对于$x$到$\[l,r\]$的边，$A$中对应$x$的叶子节点向$B$中$\[l,r\]$对应的区间节点连边。
*   对于$\[l,r\]$到$x$的边，$A$中$\[l,r\]$对应的区间节点向$B$中对应$x$的叶子节点连边。

最后用dijkstra+heap出解。