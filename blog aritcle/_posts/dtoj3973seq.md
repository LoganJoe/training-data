---
title: " DTOJ3973seq\t\t"
tags:
  - 线段树
url: 4247.html
id: 4247
categories:
  - Solution
date: 2018-10-19 16:48:12
---

题目大意就是一个序列，要求支持单点修改棵询问$\\sum_{i=1}^n p\_i$，而$p\_i=Max_{j=1}^i s_j$。

很明显是线段树（虽然我一开始想分块）。然后单点修改。现在只需要考虑如何拿左区间的值去影响右区间的值。

如果没有左区间的影响，右区间也一定是上升的序列。有了左区间的影响，右区间一定是一段会被影响，一段不变。那么线段树上二分就好了。每一次更新会影响$log$的区间，每一个区间的二分又只要$log$次。所以总时间复杂度为$nlog^2 n$。