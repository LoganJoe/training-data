---
title: " DTOJ1748树的重心\t\t"
tags:
  - 树形dp
url: 1660.html
id: 1660
categories:
  - DTOJ
  - Solution
date: 2018-04-24 07:38:04
---

重心有一个性质：一个点是重心当且仅当以这个点为根的最大子树$\\leqslant$总点数的一半。 当取到等号时，重心是一条边的两个端点，且这条边两端的点数相同。 那我们可以根据重心的数量分情况讨论。

*   只有一个重心。那么以重心为根的最大子树$<$总点数一半。让树以重心为根。记$f\[i\]\[j\]$为以$i$为根的子树内选出$j$个点的方案数（$i$必选且$j$个点要连通），$g\[i\]\[j\]$为选出$i$个点，最大的子树大小为$j$的方案数。$f$就是一个简单的树上背包问题，dfs一遍即可求出。求出$f$后，枚举重心的每个子树的大小，就能通过$f$用类似背包的方法求出$g$。最后的答案是$\\sum_{i=1}^{n}\\sum_{j=0}^{\\lfloor \\frac{i}{2}\\rfloor -1}g\[i\]\[j\]$。
*   有两个重心。以重心相连的那条边将树拆开，成为以重心为根的两棵树。那么这两棵树内选的点数要相同且选的点要连通。记$f\[i\]\[j\]$为在第一棵树中以$i$为根的子树内选出$j$个点的方案数（$i$必选且$j$个点连通），同理，$g\[i\]\[j\]$为在第二棵树内的方案。同样dfs一遍求出。那么最后的答案就是$\\sum_{i=1}^{n}f\[root\_1\]\[i\]\\times g\[root\_2\]\[i\]$。