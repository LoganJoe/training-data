---
title: " DTOJ2277开场题\t\t"
tags:
  - ST表
  - 数学
url: 823.html
id: 823
categories:
  - Solution
date: 2018-02-27 13:25:58
---

我们考虑枚举一个左端点l，然后找到一个右端点。 因为区间gcd不满足规范可加性，因此无法用前缀和维护。但是可以注意到，连续的一段的gcd随着右区间的右移，肯定是单调不增的，并且存在一段区间内gcd都相同的情况。因此我们可以用倍增的方法，找到一段区间内gcd都相同的情况，即gcd\[l,a\]=gcd\[l,a+1\]=...=gcd\[l,b\]的一段区间\[a,b\]，记这段区间内的gcd为m。那么我们需要找到这段内异或和为$\\frac{k}{m}$的端点。其中要求$m|k$。由于区间异或满足前缀和性质，因此我们只需在\[a,b\]中找到异或前缀和为$\\frac{k}{m} ^ sum_{l-1}$，其中sum为异或前缀和。我们可以针对每种异或前缀和，保存其所有出现的位置，之后二分查找第一个大于等于a的位置，判断其是否小于等于b即可。遇到第一个满足条件的答案即可直接输出。