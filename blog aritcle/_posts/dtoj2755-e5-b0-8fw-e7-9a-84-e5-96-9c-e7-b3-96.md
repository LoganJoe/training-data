---
title: " DTOJ2755小w的喜糖\t\t"
tags:
  - dp
  - 容斥
url: 4651.html
id: 4651
categories:
  - Solution
date: 2018-10-28 11:37:15
---

对于相同的糖我们要一并考虑。 $f\[i\]\[j\]$为当前做到第$i$种喜糖，至少有$j$个人拿到与原来相同的糖的方案数。 每新增加一种糖，枚举现在几个人拿到自己的糖，一个人拿到自己的那种的糖要在所有的同种糖中选择。具体地： $$ \\frac{f\[i - 1\]\[j\] \\binom{cnt\[i\]}{k}} {(cnt\[i\] - k)!}  \\Rightarrow f\[i\]\[j+k\]$$ 转移后所有的$f\[i\]\[j\]$乘上$(n-j)!$，表示剩下的糖任意交换，而不会发到自己的糖。 最后计算答案的时候，由于算的是至少$j$个，所以需要容斥。 我们要求的是$0$个人拿到自己相同的糖的方案数。于是根据奇偶乘上$-1$的容斥系数。这样就可以算出答案了。