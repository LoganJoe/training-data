---
title: " DTOJ4067鸡\t\t"
tags:
  - 最小生成树
  - 最短路
url: 5594.html
id: 5594
categories:
  - DTOJ
  - Solution
date: 2018-12-16 22:21:47
---

我们将L，R用二进制的$0,1$替换，那么每个字符串就对应着一个二进制数。 我们将每个二进制数看成一个点，我们一共有$2^m$个点，其中有$n$个点是特殊的。 每个点向与自己二进制位只有一位不同的点连边，即每个点连出去$m$条边，一共有$nm$条边。 我们要将$n$个特殊的点连接在一起，两个点连起来的代价是在图中最短路的长度，即我们要求出最小生成树。 从每个点出发跑一遍bfs肯定不可取，我们考虑$n$个点一起bfs。 我们在bfs的过程中，记录下哪个这个点的最短路的来源，也就是哪个特殊的点离这个点最近。 如果遍历的过程中，遍历到一个已经被遍历过的点，并且两个点的来源不同，那么我们就有一条连接这两个点来源的边。 假设到当前点的距离为$d$，已经被遍历的点的距离距离为$<d-1$，我们可以不管这条边。因为它们一定会在$d$更小的时候被考虑到。 那么就只有当前点距离为$d$，已经被遍历的点距离为$d-1$或$d$的情况了。 如果是$d$和$d-1$，根据Kruskal的原理，如果这两个点来源还未连通，此时这条边一定是在最小生成树中的。 对于$d$和$d$的情况，得等到$d$和$d-1$的边连完后再考虑。我们可以先存下来。 时间复杂度应该是$\\Theta(m2^m+n\\log \\alpha)$。 我怕过不去卡了卡常跑的飞快。