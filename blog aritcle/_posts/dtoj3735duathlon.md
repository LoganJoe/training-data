---
title: " DTOJ3735Duathlon\t\t"
tags:
  - 圆方树
url: 3733.html
id: 3733
categories:
  - DTOJ
  - Solution
date: 2018-08-28 21:09:47
---

考虑枚举起点$a$和终点$b$，那么合法的中间点$c$就是$a$到$b$之间所有简单路径的并。 而两点之间所有简单路径的并是圆方树上这两点路径中经过的所有方点。 建出圆方树。设方点权值为点双的大小，圆点的权值为$-1$。那么对于$a,b$，合法的$c$的数量就是圆方树上$a$到$b$的路径点权和。 枚举一个点，考虑这个点的权值会被计算多少次，即考虑有多少条路径经过了这个点。 这个跑一遍dfs就可以算出来了。