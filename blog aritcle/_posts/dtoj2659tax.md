---
title: " DTOJ2659tax\t\t"
tags:
  - 最短路
url: 4168.html
id: 4168
categories:
  - Solution
date: 2018-10-17 15:33:24
---

原来的边权限制就没有用了。我们不妨拆边成点。由于新图中每条边的权值取决于两端点的最大值，那么我们可以对于原图中的每个点，其所有入边向所有出边连边，边权为两边权最大值。这样建出所有边是$O(n^2)$的。考虑其他建边优化。我们其实可以对于每个点，用差分法减少总边数。

首先将原来一条边拆成作为入边和作为出边考虑：

*   将入边与出边按照从小到大排序。
*   对于所有的入边，向其第一条比它大的路边连一条权值为$\\Delta$的边，反向连一条费用为￥0￥的边。
*   对于所有入边，向权值比其大的最小出边连一条费用为出边权值的边，向权值比其小的最大出边连一条费用为入边权值的边。
*   另外新建源汇，作为$1$点与$n$点。

这样边数就得以被降到线性级别了。