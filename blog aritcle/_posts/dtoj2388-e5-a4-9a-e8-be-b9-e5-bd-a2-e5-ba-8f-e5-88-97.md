---
title: " DTOJ2388多边形序列\t\t"
tags:
  - FFT
  - 高精
url: 389.html
id: 389
categories:
  - DTOJ
  - Solution
date: 2018-01-23 17:46:07
---

由于题目说序列是由多边形是按逆时针顺序转的，所以序列中$L$的数量一定要比$R$的数量多$4$个才合法。因此$L$的数量是$\\frac{n}{2}+2$，$R$的数量是$\\frac{n}{2}-2$。 并且两个$R$不能相邻，第一个和最后一个也不能同时为$R$。不然图形会有凹进去的一块，一定有一部分是看不到的。 为了防止两个$R$相邻，我们让$R$和$L$绑在一起，也就是放一个$L$后面要跟着一个$R$。 先考虑以$LR$开头的序列，相当于把$\\frac{n}{2}-2$个球放入$5$个无差别的盒子的方案数（$\\frac{n}{2}-2$个$LR$用$4$个$L$隔开），为$\\binom{\\frac{n}{2}+2}{4}$。 再考虑以$R$开头的序列，这时最后一位不能放$R$，只能放$L$，即把一个$LR$拆开，一个放前面，一个放后面。这相当于把$\\frac{n}{2}-1$个求放入$5$个无差别的盒子的方案数，为$\\binom{\\frac{n}{2}+1}{4}$。 所以最终答案为$\\binom{\\frac{n}{2}+2}{4}+\\binom{\\frac{n}{2}+1}{4}$。 由于$n$很大，所以要写高精，要实现高精加，高精乘高精，高精除以低精。 高精乘用FFT优化即可。