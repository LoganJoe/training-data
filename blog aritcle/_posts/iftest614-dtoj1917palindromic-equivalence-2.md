---
title: " DTOJ1917Palindromic Equivalence\t\t"
tags:
  - manacher
url: 825.html
id: 825
categories:
  - Solution
date: 2018-02-27 13:36:26
---

考虑符合方案的充要条件，假设原串中存在该回文串，那么后半段一定无法被改变。并且原串的回文串两侧的字符不能相同。我们用manachar求出$S$中的回文串，那么对于一个中心mid，可以拓展出$\[mid-p\_i,mid+P-i\]$的回文串，而$\[mid,mid+p\_i\]$的字符由前面决定。我们用并查集合并起来。对于\[mid-p\_i-1,mid+p\_i+1\]存在一个不等关系。我们将这两个地方连一条边，代表他们不能相同。 之后从小到大枚举每个没有被前半个回文串固定的位置，通过当前位置向前面的连边的等价类判断有几种字母会导致不合法，就可以计算方案数了。有可能连出去的两条边会连到同一个等价类，我们要减去这种情况。