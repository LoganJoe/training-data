---
title: " DTOJ3076太空飞船\t\t"
tags:
  - 三分
  - 斜率dp
url: 3319.html
id: 3319
categories:
  - DTOJ
  - Solution
date: 2018-08-07 18:22:29
---

先化简一下答案的式子。 记总长度为$Sum$。 $$ \\begin{aligned} ans&=K^2\\sum_{i=1}^{K}(s\_i-\\bar{s})^2\\newline &=K^2\\sum\_{i=1}^{K}s\_i^2+\\bar{s}^2-2s\_i\\bar{s}\\newline &=K^2\\sum_{i=1}^{K}s\_i^2+\\frac{Sum^2}{K^2}-2s\_i\\frac{Sum}{K}\\newline &=KSum^2-2KSum^2+K^2\\sum_{i=1}^{K}s\_i^2\\newline &=-KSum^2+K^2\\sum\_{i=1}^{K}s\_i^2 \\end{aligned} $$ 那么我们就是要最小化$\\sum\_{i=1}^{K}s\_i^2$。 首先我们可以枚举第一段从哪里开始，也就是枚举从哪里把环切开，那么就变成了序列上的问题。 记$f\[i\]\[j\]$表示前$i$个数被分为$j$段的最小的代价，那么有 $$f\[i\]\[j\]=\\min\\{f\[k\]\[j-1\]+(Sum\_i-Sum\_k)^2\\}$$ 其中，$Sum\_i$表示前$i$段的和。 这是最基本的斜率优化题目，用斜率优化可以做到$\\Theta(NK)$。 但是我们还要枚举开头，因此总的时间复杂度是$\\Theta(N^2K)$。 发现当$K=2$或$K=3$的时候过不去。 我们考虑这两类有什么特殊的地方。 当$K=2$时，我们就是要将中间一部分单独分成一段，剩下的成为另一段。发现两段的和一定是尽量均匀比较优。那我们枚举中间那段的右端点，左端点关于右端点是单调的，可以在移动右端点的时候推一下左端点。 当$K=3$时，我们要将中间一部分分成两段。同样枚举右端点推左端点，然后我们还要把左右端点中间再分一段。发现中间分的位置和代价的关系是一个单峰的函数，那么我们三分中间分的位置即可。