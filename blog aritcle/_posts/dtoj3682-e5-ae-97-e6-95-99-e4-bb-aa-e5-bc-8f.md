---
title: " DTOJ3682宗教仪式\t\t"
tags:
  - ST表
  - 后缀数组
url: 1669.html
id: 1669
categories:
  - DTOJ
  - Solution
date: 2018-04-24 11:15:36
---

问题等价于重新定义匹配，然后问匹配次数。 匹配的含义变成了：长度相同的串$A$和串$B$匹配，当且仅当不相同的位数$\\leqslant k$。 注意到$k$很小，如果每次匹配我们都能快速找出每个不同的位置，问题即可解决。 那么问题变成了，如何快速找到两个串第一个不同的位置。 找第一个不同的位置等价于求两个串最长的公共前缀。 这个显然可以用后缀数组和在$height$数组上RMQ解决。预处理是$\\Theta(n\\log n)$的，查询是$\\Theta(1)$的。 如果能找出$k+1$个不同的位置，这次匹配就失败了，否则匹配成功。 （这其实也是道fft模板题，但需要做$26$次fft，常数太大过不了233，但是测试时坑到了所有人。