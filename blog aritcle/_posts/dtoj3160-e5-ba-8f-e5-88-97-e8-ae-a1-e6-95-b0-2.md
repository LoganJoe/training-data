---
title: " DTOJ3160序列计数\t\t"
tags:
  - dp
  - 矩阵
url: 2580.html
id: 2580
categories:
  - Solution
date: 2018-06-18 21:24:30
---

我们考虑计算所有的方案数和不含质数的方案数。 设dp f\[i\]\[j\]为前i个数中，选数，总和mod p为j的方案数。 然后有一个很显然的转移。我们可以用矩阵快速幂优化。 对于不含质数的，则矩阵中不考虑所有质数即是答案。