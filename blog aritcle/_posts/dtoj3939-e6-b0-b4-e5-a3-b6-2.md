---
title: " DTOJ3939水壶\t\t"
tags:
  - 奇技淫巧
  - 最小生成树
url: 4240.html
id: 4240
categories:
  - DTOJ
  - Solution
date: 2018-10-20 23:08:48
---

显然我们要考虑建出建筑物之间的最小生成树。 但是从每个建筑物开始bfs一遍肯定T了。 我们考虑从所有建筑物一起开始bfs，同时记下这个最短路的起点。 那么我们每次拿出队头元素去更新其他点时，如果其他点已经被更新且起点不同的话，就说明两个起点建筑物之间可以连一条权值为这两点最短路之和的边。 注意我们不能直接把这条边加入mst，因为这条边可能不是最优的。虽然bfs是从小到大更新最短路的，但是在之后可能会有比当前边权小$1$的边被加进mst。 因此我们要存下所有可能被加进mst的边，然后再用Kruskal求mst。