---
title: " DTOJ1676水管局长\t\t"
tags:
  - 倍增
  - 思路
url: 3435.html
id: 3435
categories:
  - Solution
date: 2018-08-12 22:24:37
---

这题在WC2006上的原题数据范围可以用暴力写过去。

我们注意到，题目只有两个操作：删边，与查询路径边权最大值的最小值。一个转化是路径上关键边一定在最小生成树上。这个证明很显然，因为如果有更小的边使得两个联通块联通，那么这条边一定会更先被加进去。

那么我们倒着处理，将删边操作转化为加边操作。路径上的最大值我们可以对最小生成树用dfs预处理然后树上倍增查出来，时间复杂度是$O(log n)$的。加入一条边，仅当两点之间最大边币当前边大。我们同样在树上倍增找到这条边，然后将这条边删掉，再加进新的边。这一步操作是log的，然后我们需要重新处理生成树，每次加边要$O(nlogn)$的效率。由于删边次数不超过5000次，所以这个做法稳了。

比LCT维护都快。