---
title: " DTOJ4046括号序列\t\t"
tags:
  - hash
  - 贪心
url: 5248.html
id: 5248
categories:
  - DTOJ
  - Solution
date: 2018-11-23 09:34:13
---

原题目题意严重不明差评。但是出题人好像是吉老师我就不骂出题人了。 考虑暴力。 我们枚举子串左端点$l$和右端点$r$。 当右端点右移时，我们把当前字母加入到一个栈中，如果栈顶的两个字母都相同，我们就把它们一起删掉，即贪心地去匹配括号。 当栈为空时，说明这个子串是合法的。 这样是$\\Theta(n^2)$的。 现在我们只考虑做一遍这个过程，即我们只从$1$到$n$枚举一遍右端点。记右端点在$i$时的栈为$S\_i$。 那么如果$\[l,r\]$是合法的，说明有$S\_{l-1}=S\_r$。 那么我们把每个$S\_i$hash起来，即一边修改栈一边维护hash值，然后根据相同hash值的个数来计算一下子串个数即可。 时间复杂度$\\Theta(n\\log n)$，瓶颈在于sort。