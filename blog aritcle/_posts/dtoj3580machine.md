---
title: " DTOJ3580machine\t\t"
tags:
  - 卷积
  - 数论
url: 1228.html
id: 1228
categories:
  - DTOJ
  - Solution
date: 2018-03-24 21:36:18
---

这题好像以前写过…但为什么还是不会呢。 狄利克雷卷积有结合律，因此可以看作答案是卷上一个全为$1$的函数的$k$次方。快速幂即可。 还有一种方法。 考虑初始的$f\_0$对$f\_k(x)$的贡献。显然只有$d|x$的$f\_0(d)$才会有贡献。 考虑计算每一个$f\_0(d)$的贡献次数。 先考虑$f\_0(1)$。 也就是说$1$要乘$k$个数然后$=x$。等价于将$x$的质因数分解后，把每种质因子看作物品，每种物品有不同的个数，丢到$k$个不同的盒子的方案数。 显然每种物品之间的方案数是独立的，可以直接相乘。那么考虑一种物品，有$cnt$个，放入$k$个不同的盒子的方案数。也就是拿$k-1$个隔板将$cnt$个物品隔开，隔板可以放在同一个位置。那么方案数就是$C\_{k+cnt-1}^{k-1}$。 那么我们就可以计算$f\_0(1)$会被$f\_k(x)$计算多少次了。 对于任意一个$f_0(d)$，$d$乘$k$个数到$x$的方案数其实和$1$乘$k$个数到$\\frac{x}{d}$的方案数是一样的。那么同样用上面的方法算即可。