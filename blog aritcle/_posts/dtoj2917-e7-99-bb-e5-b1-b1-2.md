---
title: " DTOJ2917登山\t\t"
tags:
  - 容斥
url: 4657.html
id: 4657
categories:
  - DTOJ
  - Solution
date: 2018-10-28 12:02:26
---

这题是DTOJ2431棋盘路径的加强版。 记$f\[i\]$为走到第$i$个坑且之前没有经过坑的方案数。 我们把$(N,N)$当做第$C+1$个坑，那么$f\[C+1\]$就是答案。 考虑如何求$f\[i\]$。 考虑容斥，用总方案数减去不合法方案数。不合法方案数就是至少经过一个坑的方案数。 记$F(x,y,a,b)$为从$(x,y)$走到$(a,b)$，不管有没有经过坑的方案数。即每次可以向右走向上走，但不经过$y=x+1$的方案数。 那么有 $$F(x,y,a,b)=\\binom{a-x+b-y}{a-x}-\\binom{b-x+a-y}{b-x-1}$$ 即把经过$y=x+1$的路线关于$y=x+1$对称一下计算方案数然后减掉。 这样我们就可以求$f\[i\]$了，有 $$f\[i\]=F(0,0,x\_i,y\_i)-\\sum_{j=1}^{i-1}f\[j\]\\times F(x\_j,y\_j,x\_i,y\_i)$$ 时间复杂度$\\Theta(C^2)$。