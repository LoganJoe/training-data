---
title: " DTOJ3553stone\t\t"
tags:
  - dp
url: 1029.html
id: 1029
categories:
  - DTOJ
  - Solution
date: 2018-03-12 19:18:16
---

若选择位置$i$放石头会失败，一定是选择$i$及之前的次数$\\geqslant i$次。记选择$i$及之前的次数为$cnt\_i$次，则失败的次数为$max(cnt\_i-i+1)$。 有了这个性质后，我们就是要求$max(cnt\_i-i+1)=p$的方案数。显然这个只与选择每个位置的次数有关。 考虑dp。令$f\[i\]\[j\]\[0/1\]$为现在考虑到第$i$的位置，之前已经放了$j$次，$max(cnt\_i-i+1)$是否到达$p$。 枚举在第$i$个位置放的次数$k$，就可以转移了。 由于原题中与选择的顺序有关，因此答案还要$\\times m!$。但这样同一个位置放的顺序会被重复计算，记选择第$i$个位置$a\_i$次，那么答案还要$\\div a\_i!$，这个可以在dp转移的过程中先处理掉。