---
title: " DTOJ3906字符串大师\t\t"
tags:
  - KMP
  - 字符串
url: 3883.html
id: 3883
categories:
  - DTOJ
  - Solution
date: 2018-09-09 14:27:12
---

这个循环节的定义其实就是字符串的周期，而字符串的周期等于串长减去border的长度。 $per\_i$是长度为$i$的串的最小周期，说明$i-per\_i$是长度为$i$的串最长的border的长度。 而字符串每个前缀的最长border的长度就是KMP匹配中的$nex$数组。 那么题目就变成了，给你一个串的$nex$数组，要求字典序最小的合法串。 我们按位考虑。假设现在在考虑第$i$位的答案，我们分两类考虑。

*   如果$nex\_i>0$，那么第$i$位的答案一定和第$nex\_i$位的答案相同，而第$nex_i$位的答案已经知道了。
*   如果$nex\_i=0$，那么第$i$位的答案不能和第$nex\_{i-1}+1$位的答案相同，否则$nex\_i$就会$>0$。同理也不能和第$nex\_{nex_{i-1}}+1,nex_{nex_{nex_{i-1}}}+1,…$位相同。给这些不能相同的字母打个标记，最小的没被标记过的字母就是第$i$位的答案了。

由于保证有解，即$nex$数组是合法的，那么暴力跳打标记的复杂度其实和KMP的复杂度是一样的。 也可以用和KMP类似的方法，方法都是等价的。