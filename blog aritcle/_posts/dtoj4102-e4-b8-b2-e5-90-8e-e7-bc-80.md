---
title: " DTOJ4102串后缀\t\t"
tags:
  - 后缀自动机
url: 6202.html
id: 6202
categories:
  - Solution
date: 2019-01-26 13:58:55
---

JLS已经给出了一份详细的题解了。 考虑题目中给出的式子的含义，实际上相当于要给串s的每个后缀求得一个概率分布，然后取其中一个与其它后缀的lcp期望值最小的后缀，要做的就是求出一种最优的概率分布使得最后的最小值最大。 考虑若干个lcp为0的后缀怎么分配。我们在其称之为无关后缀。 对于$m​$个长度为$l\_1,l\_2,...,l\_m​$的后缀$s\_1,s\_2,...,s\_m​$。其中每个串对于答案的贡献$p\_il\_i​$一定相等。因为假设取到了最小那个，也一定可以通过调整概率分布使其更优。那么此处，我们称满足$\\forall i,p\_il\_i=k​$的概率分布为最优概率分布，其$p\_il\_i=k​$成为最优概率下期望分布。考虑求出最优期望分布。很显然，$k​$即是答案，有 $$ k=\\frac{1}{\\sum_{i=1}^{m}l_i^{-1}} $$ 考虑在后缀树上处理。对于后缀树，一个节点所有的后继节点以及向下的子树所表示的字符串在这个点向后的部分都是没有公共前缀的。因此我们对于一个节点，其底下的子节点都是一个独立的子问题。在后缀树上直接dfs即可。