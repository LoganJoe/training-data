---
title: " DTOJ3838绳子\t\t"
tags:
  - 奇技淫巧
  - 思路
url: 3033.html
id: 3033
categories:
  - DTOJ
  - Solution
date: 2018-07-24 22:58:34
---

为什么ysy这么喜欢出折纸题啊…（apio wyy英文折纸讲座的阴影还历历在目） 注意到先染再折和折完再染是没有差的，那我们就可以当做先染再折。 假设绳子上只有两种颜色，那么能折到长度为$2$。当且仅当除了头尾以外，每个极长颜色相同段长度都为偶数。也就是说，除了第一段以外，每一段的开头的下标是同奇偶的。 那么折法只有两种：开头下标为奇数和开头下标为偶数。我们可以分开考虑。 那么我们就只用考虑染成什么颜色了。 记$cnt\_i$为颜色为$i$的段数。 假设我们最终染成颜色$a$和颜色$b$，那么至少需要$n-cnt\_a-cnt_b$的代价。因为不是这两种颜色的段都要改掉。 但我们有时候也要把$a,b$改掉，因为我们要保证极长颜色相同段长度为偶数。那么也就是要减去$a$和$b$相邻且奇偶性不对的个数。 我们可以按颜色存下所有的相邻段。 最暴力的做法就是枚举$a$枚举$b$然后计算代价。 注意到枚举$a$的时候，$b$的选择是一个取最小值的过程，由于代价会因为$a$修改，那么我们可以用线段树维护。 时间复杂度$\\Theta(n\\log n)$。 但这样可能会被卡常。 注意到代价的修改只有$\\pm 1$，那么我们可以暴力维护每种代价和每种代价的出现次数，然后暴力移动最小值更新答案。 时间复杂度$\\Theta(n)$。