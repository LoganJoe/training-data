---
title: " DTOJ3558困难重重\t\t"
tags:
  - 思路
  - 费用流
url: 3575.html
id: 3575
categories:
  - Solution
date: 2018-08-25 22:15:52
---

yy出了$A=B$ 然后GG了。看Jyt的题解勉强意会出来了。

先考虑￥A=B￥的情况。首先二分图染色，然后连边用费用流解决。那么对于一个点，与周围$1/2/3/4$个点相邻的代价分别为$0/A/3A/6A$。那么我们可以对于每个点，按照染色向$S/T$连四条边，容量为1，费用为$0/A/2A/3A$，根据最小费用最大流的性质，有几条边有流量就说明有多少个相邻。对于每个点，再和相邻的点连容量为$1$，费用为$0$的边。就可以跑最小费用最大流出答案了。

再考虑$A<B$的情况。发现对于I形的一个接头，会多出$B-A$的代价。

那么同样的建出上面的费用递增模型，接下来特殊处理多余的代价。对于一个点$x$，连上上述四条边。另外拆出两个点$x\_h,x\_w$,分别与$x$连上各两条容量为$1$，费用为$0/B-A$的边，说明这个方向上连出I形要增加的费用。每个点的$x\_h,x\_w$再向对应方向上的相邻点的$x\_h,x\_w$连边，这时候跑最小费用最大流就是答案了。