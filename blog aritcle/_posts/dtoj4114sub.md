---
title: " DTOJ4114sub\t\t"
tags:
  - FWT
url: 6037.html
id: 6037
categories:
  - Solution
date: 2019-01-15 20:27:49
---

考虑将原问题转化为"在所有数中删去最少的数，使得删去的数异或和为$Xor$"。其中，$Xor$为所有数的异或和。 回顾一下线性基的性质。我们将所有的数丢进线性基里面，线性基里最多有$\\log$ 个数。而线性基是可以且仅可以表示出原来所有数的异或和的值域的。那么我们可以想到，可以将线性基外的所有数均保留，然后这些数的异或和可以由线性基中的若干个数凑出，其他的部分删去就好了。 那么，删去的数不会超过$\\log$个。让这个值尽量小。考虑哪些位在线性基里面比较优这一做法没有太多优化空间。直接考虑最少要几个数才能凑出$Xor$。 放在所有数考虑这个问题。那么这就是一个异或卷积问题。要找到$\[x^0\]f^k(i)>0$的最小的$k$。直接二分$k$然后$FWT$即可。 可以将多项式先求出所有点值即$FWT$，然后在点值下求出$f_\\mathbb{U}^k(i)$。二分后只需要将对应的点值插值即$IFWT$回去就好了。效率是$T(n \\log n \\log (\\log n)=O(n \\log n)$。