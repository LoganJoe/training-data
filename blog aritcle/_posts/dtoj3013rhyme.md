---
title: " DTOJ3013Rhyme\t\t"
tags:
  - hash
  - 拓扑序
url: 1613.html
id: 1613
categories:
  - DTOJ
  - Solution
date: 2018-04-23 13:59:23
---

一开始的字符串一定是一个长度为$k$的字符串，如果要在后面加一个字符，则后$k-1$位一定要在模板串出现过且加的字符是出现的位置的后一个字符。 显然我们只关心后$k-1$位和新增的字符，那么我们可以把后$k-1$位hash起来，作为一个点，向能走到新的后$k-1$位代表的点连边。因为如果我们知道原来的后$k-1$和现在的后$k-1$位，等价于知道新加的字符。 那么问题就变成了求最长路。 边权都为正可以直接在拓扑序上求，如果有环答案就是INF。 注意特判$k=1$的情况。