---
title: " DTOJ1169重复次数最多的连续重复子串\t\t"
tags:
  - ST表
  - 后缀数组
url: 5687.html
id: 5687
categories:
  - DTOJ
  - Solution
date: 2018-12-22 21:08:11
---

考虑枚举子串的长度$L$，然后求长度为$L$的子串的最大重复数。 我们只考虑重复数$>1$的情况。 假设长度为$L$的串出现了两次，那么这个串出现的位置一定至少包含了第$L,2L,3L,…,kL$中相邻的两个。 我们求出原串中第$iL$个后缀和第$(i+1)L$个后缀的最长公共前缀以及第$iL$个前缀和第$(i+1)L$个前缀的最长公共后缀。记最长公共前缀和最长公共后缀拼起来长度为$x$，那么就存在一个长度为$L$的子串出现了$\\left \\lfloor \\frac x L\\right \\rfloor+1$次。 利用后缀数组中的$height$数组和$ST$表，即可在$\\Theta(1)$内求出两个后缀的最长公共前缀。 只要把串反过来再建一个后缀数组就可以$\\Theta(1)$求出原串的两个前缀的最长公共后缀了。 时间复杂度$\\Theta(n\\log n)$。 这题的思路和[DTOJ2594字符串](http://www.dtenomde.com/author=jiangyutong/article=3994/)有点像。