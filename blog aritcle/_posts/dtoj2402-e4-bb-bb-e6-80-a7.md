---
title: " DTOJ2402任性\t\t"
tags:
  - 思路
  - 状压dp
url: 3762.html
id: 3762
categories:
  - DTOJ
  - Solution
date: 2018-08-30 18:05:05
---

一堆数的$lcm$就是将这些数质因数分解后，每个质因子次方取最大值后的乘积。 将质因子分为两类：$\\leq \\sqrt{200}$的和$>\\sqrt{200}$的。 第一类只有$6$个数，我们可以暴力枚举这些数在$lcm$中的幂。 记这些数的乘积为$mul$，那么选出来的数的$lcm$可以表示成$k\\times mul(k\\in \\mathbb{Z})$的形式，我们考虑求出$\\sum k$。 我们对于给定的$n$个数做质因数分解，每个数至多只有一个$>\\sqrt{200}$的质因子，我们按这个质因子给数分组，如果没有就单独成一组。 考虑用状压dp求出$\\sum k$。 记$f\[i\]\[j\]$为前$i$组数中，第一类质因子的次方达到枚举的最大值的状态为$j$，此时的$\\sum k$是多少。 由于给定的数$\\leq 200$且不相同，所以每组的数不会很多。我们可以枚举新的一组中选数的状态，然后转移即可。 可以用滚动数组压掉第一维。