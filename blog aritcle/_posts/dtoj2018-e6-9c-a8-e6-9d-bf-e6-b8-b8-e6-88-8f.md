---
title: " DTOJ2018木板游戏\t\t"
tags:
  - 无标签
url: 4665.html
id: 4665
categories:
  - Solution
date: 2018-10-28 13:39:54
---

首先要知道的是，通过输入的行走序列，我们可以模拟出路径中每一层分别在那个点上。 那么对于同层到达某个点，假设点的标号分别为$a,b$，花费就会是$|a-b|$。 考虑不同层两点间的最短路径，可能会有如下奇怪的样子： ![](http://www.dtenomde.com/wp-content/uploads/2018/10/捕获-1.png) 将路径拆成三个部分，从a到某一层，从某一层走到另外一边，往下走到b。 记两个节点到根的深度分别为$len\_1,len\_2$,$pref(n,len)$为对应点n走了$len$步二进制表示中数字长度的前缀。 容易将这样走在$L$层的答案表示为$(len\_1-L)+|pref(a,L)-pref(b,L)|+(len\_2,L)$。 $L$是当前层。 而$pref(a,L)-pref(b,L)=a\[L-1\]-b\[L-1\]+2\\times (pref(a,L-1)-pref(b,L_1))$。 其中，$a\[L\]$与$b\[L\]$相当于表示在这层中向侧向移动了几个节点。 答案就可以被计算出来了。