---
title: " DTOJ3741多笔画\t\t"
tags:
  - 奇技淫巧
  - 费用流
url: 2292.html
id: 2292
categories:
  - DTOJ
  - Solution
  - 不会证
date: 2018-06-11 22:08:14
---

这是道玄学题，所有证明我都不会。 先考虑是有向图的情况。 记$a\_i$为第$i$个点的入度-出度。 那么至少要$\\frac{\\sum\_{i=1}^{n}|a\_i|}{2}$遍才能画完。可以证明这个下界是可以取到的，但我不会。 再考虑是无向图的情况。 那么至少要$\\frac{\\sum\_{i=1}^{n}|a\_i|\\%2}{2}$遍才能画完。同样地，这个下界也是可以取到的，但我不会。 但要注意下界要和$1$取max。 对于既有有向边又有无向边的图，我们先给无向边随意地定一个方向，然后算出所有的$a\_i$，得到答案$ans$。 考虑如何给某些无向边改个方向使得答案更优。假如$a\_x<-1,a\_y>1$，且有一条$x$到$y$的有向边，把这条边反向后，$a\_x+2,a\_y-2$，此时$\\frac{\\sum_{i=1}^{n}|a\_i|}{2}$会$-2$。但如果$a\_x=-1,a\_y=1$，且有一条$x$到$y$的有向边，反向后答案不变。如果只有一个$=\\pm 1$，那么反向后答案$-1$。 考虑网络流。（我也不知道为什么） 对于$a\_i>0$的点，和$S$连一条容量为$\\lfloor \\frac{a\_i}{2}\\rfloor$，费用为$1$的边，代表这些边反向可以使答案$-1$。如果$a\_i\\%2=1$，那么再和$S$连一条容量为$1$，费用为$0$的边，代表这条边反向不改变答案。 对于$a\_i<0$的点，同理，和$T$连一条容量为$\\lfloor \\frac{-a\_i}{2}\\rfloor$，费用为$1$的边。如果$(-a_i)\\%2=1$，那么再和$T$连一条容量为$1$，费用为$0$的边。 对于一条被定向成$a\\rightarrow b$的无向边，$b$到$a$连一条容量为$1$，费用为$0$的边，代表这条边可以被反向。 $ans$减去最小费用最大流就是下界。 注意连通块个数可能不为$1$。要注意判断连通块的下界是否要和$1$取$max$。细节很多。