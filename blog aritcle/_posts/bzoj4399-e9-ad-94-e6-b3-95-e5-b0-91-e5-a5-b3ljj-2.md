---
title: " BZOJ4399魔法少女LJJ\t\t"
tags:
  - 线段树
url: 6760.html
id: 6760
categories:
  - Solution
date: 2019-03-03 14:52:28
---

考虑每个操作分别可以怎么维护： 首先将权值离散，权值区间为$\[1,tot\]$。 1. 新建一棵线段树，将这个点作为一个新的联通块处理。线段树内维护权值线段树，计算每个权值的数量。 2. 合并两个点所在联通块的线段树。 3. 相当于在线段树上对于$\[1:x\]$的权值区间清空，并且将里面的节点个数记到$x$权值上。 4. 相当于在线段树上对于$\[x:tot\]$的权值区间清空，并且将里面的节点个数记到$x$权值上。 5. 一个简单的线段树第$k$大。 6. 考虑其只询问我们两个联通块的大小关系。那么我们可以取对数然后化乘为加。这样就可以在变换值域内比较两个数的大小了。 7. <del>你他妈都会算线段树第$k$大了还不会算线段树上的全树和？</del> 8. 我们可以启发式分裂，另外维护一个LCT，将线段树放在LCT上面维护，每次相当于动态Link，cut操作顺便维护线段树。 9. 删去一个点，顺便删掉这个点的权值。我们对于每条边依次cut，最后删去这个点即可。 由于$c \\le 7$，所以最后两个都是我不过脑子瞎掰的。 至于前面七个都是很简单的线段树操作。随便维护一下就可以了。