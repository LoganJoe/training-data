---
title: " DTOJ2302序列统计\t\t"
tags:
  - NTT
  - 生成函数
url: 351.html
id: 351
categories:
  - DTOJ
  - Solution
date: 2018-01-21 15:23:43
---

我们要算$\\prod_{i=1}^{n}a\_i\\equiv x(mod\\space M)$的序列$A$个数。 注意到$M$是个质数，所以存在原根$g$，似的$1\\sim M-1$的每个数都能用$g^k(k\\in\[0,m-2\])$表示。 因此我们要算的就变成了$\\sum\_{i=1}^{n}a_i\\equiv x'(mod\\space M-1)$的序列$A$个数，其中$g^{x'}\\equiv x(mod\\space M)$。 可以用生成函数解决。 由于运算对$M-1$取模，所以我们每次做完多项式乘法后都要把第$M-1$项及之后的系数加到第$M-1$项之前，也就是系数下标要对$M-1$取模。 但由于$n$很大，乘$n$次肯定会TLE。发现每次乘的多项式都是一样的，可以用快速幂优化。再用NTT加速多项式乘法就可以了。 求原根就直接枚举原根再验证即可。