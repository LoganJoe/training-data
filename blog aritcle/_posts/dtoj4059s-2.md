---
title: " DTOJ4059s\t\t"
tags:
  - 奇技淫巧
  - 贪心
url: 5550.html
id: 5550
categories:
  - Solution
date: 2018-12-16 14:59:07
---

神仙题。 首先注意到，对于每次翻转一定会跨过中间那个十字架。那么记$A\[i\]\[j\]$为这个某格最后是否被翻转。那么有 $$ \\forall i, j, j \\le m: A\[i\]\[j\] \\oplus A\[i\]\[m\] \\oplus A\[i\]\[j+m\] = 0 $$ $$ \\forall i, j, j \\le m: A\[j\]\[i\] \\oplus A\[m\]\[i\] \\oplus A\[j+m\]\[i\] = 0 $$ 其中$m=\\frac{n+1}{2}$。这个性质不难证明正确性，不过根本想不到...因为假设对于同行进行操作，其一定会覆盖$A\[i\]\[j\]$和$A\[i\]\[j+m\]$其中一个，列同理，加上一定会覆盖$A\[i\]\[m\]$，那么每次对这个异或值也就不会改变了。 ![](http://www.dtenomde.com/wp-content/uploads/2018/12/186425FD-371E-4295-AE5E-2D685479ADA6.jpg) 如上图，中间的是关键的十字架。而紫色四个格子间是关联的。这就意味着，我们可以将四个绿色区域都叠到左上那个一并考虑。 而每行中可以确定的个数是根据中间的十字架来的，列同理。这说明我们可以枚举中间反L形的状态然后贪心的确定绿色区域的翻还是不反。 回过头来考虑异或的性质，不可以发现，假设将操作看做向量$(A\[i\]\[j\],A\[i\]\[m\],A\[i\]\[j+m\])$的异或加减，那么向$(A\[i\]\[j\],A\[i\]\[m\],A\[i\]\[j+m\])$与$(A\[j\]\[i\],A\[m\]\[i\],A\[j+m\]\[i\])$是两个线性无关组。那么其中一个线性无关组的答案对于另外一个是没有干涉的。于是我们在两边分别取最优解，两个合并就是最后的最优解。 但是，其中一个线性无关组它可以关联到所有的格子，于是我们就不需要考虑列的最优解，取到行上的最优就可以形式化地取到列上最优，进而就是全局最优了。 于是我们只需要$O(2^m)$枚举$A\[i\]\[m\]$的状态，之后其他部分的就可以贪心确定了。