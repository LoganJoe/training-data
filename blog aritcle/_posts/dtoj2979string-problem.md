---
title: " DTOJ2979String problem\t\t"
tags:
  - 思路
  - 最大权闭合子图
url: 5607.html
id: 5607
categories:
  - DTOJ
  - Solution
date: 2018-12-16 23:31:18
---

我觉得这题很妙啊。 你看这个得分，又有价值又有花费，计算规则还十分复杂，一看就不是dp能写的东西。 然后看看这个范围，往网络流去想。（反正我想不到） 网络流最大化的问题，规则又这么复杂，我们考虑最大权闭合子图。 我们有三类点。 第一类点为第$i$个位置和第$j$个位置同时选的点，点权为$w\[i\]\[j\]+w\[j\]\[i\]$。 第二类点为第$i$个位置对应的点，点权为$-a\[S\_i\]$。 第三类点为第$i$个数字第一次取对应的点，点权为$a\[i\]-b\[i\]$。 如果第一类点中选位置$i,j$同时选对应的点，就必须选第二类点中的第$i$个位置和第$j$个位置对应的点。 如果第二类点中选第$i$个位置对应的点，就必须选第三类点中$S\_i$对应的点。 这个建图十分巧妙。第一类点计算出了总价值，第二类点计算出了以$a$算的总花费，第三类点把第一次出现的花费为$b$补了上去。 然后再根据最大权闭合子图转网络流的建图，求出最大流就是答案了。