---
title: " DTOJ3750多边形\t\t"
tags:
  - 容斥
  - 思路
url: 2346.html
id: 2346
categories:
  - DTOJ
  - Solution
date: 2018-06-12 18:43:31
---

这题思路很巧妙。直接照搬原题解吧。 令$P=\\frac{N+1}{2}$。记$x\_i$表示第$i$段跨过了多少条边。那么答案就是满足$\\sum\_{i=1}^{M}x\_i=N$，且$\\sum\_{i=1}^{M}\[x\_i+x\_{i+1}\\geqslant P\]=K$的正整数解的个数。注意到这里认为$x_{M+1}=x_1$。 显然$K>3$的时候无解，其实这想想内角和外角和就知道了。 直接算锐角个数为$K$不太好算，我们考虑算至少$K$个的方案数，然后容斥。 注意，以下的计数全部是固定了第一个点的位置，且没有考虑同构。也就是说，最终的答案要乘$\\frac{n}{m}$。

1.  $K=0$。插板法，将$N$分成$M$份，即$\\binom{N-1}{M-1}$。
2.  $K=1$。假设$x\_a+x\_{a+1}\\geqslant P$，那么$x_{a+1}\\geqslant min(P-x_a-1,0)+1$。 再分两种情况讨论。
    *   如果$x\_a\\leqslant P-1$，那么$x\_{a+1}\\geqslant P-x\_a$，那么我们让$x\_{a+1}$减去$P-x\_a-1$，相当于求$\\sum\_{i=1}^{M}x\_i=N-P+x\_a+1$，即$\\sum_{i=1}^{M-1}x\_i=N-P+1$的方案数，显然为$\\binom{N-P}{M-2}$。注意到$x\_a$有$P-1$种取值，因此还要乘$P-1$，$x_a$可以是$M$中任意一个，因此还要乘$M$。
    *   如果$x\_a\\geqslant P$，那么$x\_{a+1}\\geqslant 1$，那么我们让$x\_a$减去$P-1$，相当于求$\\sum\_{i=1}^{M}x_i=N-P+1$的方案数，显然为$\\binom{N-P}{M-1}$，同样要乘$M$。
3.  $K=2$。不难发现有贡献的$x$一定是三个连续的，不然$x$的和一定会$>N$。记有贡献的$x$分别为$x_{a-1},x\_a,x\_{a+1}$，即有$x_{a-1}+x\_a,x\_a+x_{a+1}\\geqslant P$。 同样再分两种情况讨论。
    *   如果$x\_a\\leqslant P-1$，那么$x\_{a-1},x_{a+1}\\geqslant P-x\_a$，将$x\_{a-1},x_{a+1}$减去$P-x\_a-1$，相当于求$\\sum\_{i=1}^{M}x\_i=N-2P+2x\_a+2$，即$\\sum_{i=1}^{M-1}x\_i=N-2P+x\_a(原来的)+2$的方案数。手动补一个$x\_M=P-x\_a$上去，得到$\\sum_{i=1}^{M}x_i=N-2P+2$，显然为$\\binom{N-2P+1}{M-1}$，要乘$M$。
    *   如果$x\_a\\geqslant P$，那么$x\_{a-1},x_{a+1}\\geqslant 1$，同样让$x\_a$减去$P-1$，相当于求$\\sum\_{i=1}^{M}x_i=N-P+1$的方案数，显然为$\\binom{N-P}{M-1}$，也要乘$M$。
4.  $K=3$。显然只有$M=3$时有解。可以变成$K=2$时的$x_i\\leqslant P-1$的情况，化简一下答案就是$\\frac{p(p-1)}{2}$。

然后容斥一下即可，容斥的系数是组合数，