---
title: " DTOJ1873神奇化合物\t\t"
tags:
  - 并查集
  - 思路
url: 4898.html
id: 4898
categories:
  - DTOJ
  - Solution
date: 2018-10-31 22:41:33
---

题目给出的那个性质很怪。这个性质保证了图中任意一个$>3$的环，环的中间一定还有边相邻。 也就是说，一个大环会不断地被划分成小环，至少只有大小为$3$的环，即每个环都能由多个大小为$3$的环拼成。 那么如果两个点在一个连通块内，当且仅当这两个点直接相连或者通过一个点相连。 假如加入$x$与$y$之间的边时，$x$与$y$没有都与同一个点相连，那么说明$x$与$y$之前不在同一个连通块里，即加完边后连通块数量$-1$。 加入删除$x$与$y$之间的边时，$x$与$y$没有都与同一个点相连，那么说明$x$与$y$只通过这条边相连，即删完边后连通块数量$+1$。 那么我们就是要快速判断两个点有没有与同一个点相连。 对每个点用一个二进制状态表示与它相连的点，如果两个点的二进制状态与起来为$0$，就说明它们没有与同一个点相连。 我们可以用bitset优化，时间复杂度$\\Theta(\\left \\lfloor \\frac{nm}{32}\\right \\rfloor)$。 初始状态加边时不保证满足性质，因此要写个并查集或者dfs一遍来计算最初的连通块数量。