---
title: " DTOJ2783LYK loves string\t\t"
tags:
  - hash
url: 4802.html
id: 4802
categories:
  - DTOJ
  - Solution
date: 2018-10-30 20:50:22
---

我们发现$n\\leq 10$，而$k$很大。 而字符串的不同子串数只和每位字符间的相对关系有关。 那么我们可以只考虑字符串每位的相对关系，即如果有$tot$种不同的字符，我们将它们重新编号为$1\\sim tot$，并且仍然满足相同的相同，不同的不同。 为了计算方案数方便，我们规定编号完后的第$i$种字符不能在第$i-1$种字符出现前出现。 这其实就是最小表示法的定义。 那么我们爆搜出字符串的最小表示，我们发现这个数量不是很多。 然后我们对于每个最小表示，用hash+sort计算出不同的子串个数，如果$=m$就将这个最小表示的方案数计入答案。用了$tot$个不同的字符的方案数就是$\\binom{K}{tot}$。注意这个组合数要暴力拆开算。