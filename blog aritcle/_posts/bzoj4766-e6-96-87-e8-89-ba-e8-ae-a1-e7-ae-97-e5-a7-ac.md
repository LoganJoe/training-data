---
title: " BZOJ4766文艺计算姬\t\t"
tags:
  - prufer序列
url: 3239.html
id: 3239
categories:
  - BZOJ
  - Solution
date: 2018-08-01 22:43:17
---

算是结论题吧，一边$n$个点一边$m$个点的完全二分图的生成树个数是$n^{m-1}m^{n-1}$。 听说用矩阵树定理打表找规律……也可以用这个证明。然而我不会。 考虑从prufer序列的角度证明。不了解prufer序列请戳[这](http://www.dtenomde.com/2018/07/author=jiangyutong/article=3148/)。 那我们就是有要求有多少个合法的prufer序列。 考虑prufer序列的构造，最后剩下来的两点之间有边，那么它们一定属于不同集合。 也就是说，要删去A集合的$n-1$个点和B集合的$m-1$个点。 删一个叶子节点会把与它相连的点加入prufer序列，也就是说prufer序列中有$n-1$个B集合的点和$m-1$个A集合的点。 A集合的一个点有$n$种方案，B集合的一个点有$m$种方案，那么总方案数就是$n^{m-1}m^{n-1}$。 由于$n,m,p$都是$10^{18}$级别的，要写一个快速乘（慢速乘）以免爆longlong。