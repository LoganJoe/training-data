---
title: " DTOJ2806Calvinball championship\t\t"
tags:
  - dp
url: 1164.html
id: 1164
categories:
  - DTOJ
  - Solution
date: 2018-03-21 17:45:40
---

发现常数小点的$n^2$可能能过。 然后就很容易想到二维的dp来计算方案数。我原本是想先不管限制算出方案数，再枚举限制是在哪里卡到的，想着想着可以带着限制dp。 令$f\[i\]\[j\]\[0/1\]$表示前$i$个人，分了$j$队，是否紧压着限制的前$i$位。 $0$到$0$的转移十分显然，就是讨论第$i$个人是否要自己新开一队，因此有 $$f\[i\]\[j\]\[0\]=f\[i-1\]\[j-1\]\[0\]+f\[i-1\]\[j\]\[0\]\\times j$$ $f\[i-1\]\[j-1\]\[1\]$也有可能转移到$f\[i\]\[j\]\[0\]$，保证第$i$位严格小于限制即可。 然后考虑转移到$1$的。 显然有$f\[i\]\[j\]\[1\]=f\[i-1\]\[j\]\[1\]$。同时如果第$i$个人新开一队刚好和第$i$位的限制相同，也可以从$f\[i-1\]\[j-1\]\[1\]$转移过来。 空间开不下，所以要把第一维滚掉。 $\\sum_{i=1}^{n}f\[n\]\[i\]\[0\]+f\[n\]\[i\]\[1\]$即为答案。 实际上没有$0/1$那维也是可以做的，可能细节会比较多。