---
title: " BZOJ4564[Haoi2016]地图\t\t"
tags:
  - 仙人掌
  - 圆方树
  - 线段树合并
url: 6190.html
id: 6190
categories:
  - BZOJ
  - Solution
date: 2019-01-25 23:16:00
---

题意有点不清，品尝次数指的是出现次数。 这是一棵仙人掌，我们先建出仙人掌的圆方树。 那么询问$x$就相当于查询以$x$为根的子树的信息。 对于圆方树上的每个点，我们开一棵线段树，维护以这个点为根的子树中油腻程度在某段区间且出现次数为奇数/偶数的个数。 方点的信息就是所有儿子的信息合并，圆点的信息除了儿子的信息外还要加上自己的信息。 合并儿子的信息我们可以使用线段树合并。 每次查询就直接查线段树上对应区间即可。 时间复杂度$\\Theta(n\\log n)$。