---
title: " DTOJ4128排序\t\t"
tags:
  - 思路
url: 6549.html
id: 6549
categories:
  - Solution
date: 2019-02-22 16:55:22
---

显然，我们可以快速处理整段的影响，然后剩余的残缺段暴力处理。 考虑每次归位一个数对于后面的影响: 其实质是每次贪心找一个下降子序列，然后将这个子序列作一次循环右移。 如果一个数前面有比它小的数，那么这个数不会移动，因为基于贪心的下降子序列一定会选到它前面某个比它小的数,  且一轮操作后，比它小的数个数 $-1$。反之，这个数就会移动到后面第一个比它小的位置，前面第一个比它大的数会移动过来。而假设一个数开始移动，那么其显然一定会继续移动直至归位。 于是，我们维护一个$k-$大根堆，直接维护前$k$小，就可以处理前$k$轮的答案了。