---
title: " DTOJ4046括号序列\t\t"
tags:
  - hash
  - 思路
url: 5427.html
id: 5427
categories:
  - Solution
date: 2018-12-10 22:33:21
---

题意错了差评。要求有多少个子串可以构出括号序列。 首先考虑一个暴力。我们枚举起点然后暴力匹配括号。维护一个栈，随着右端点右移，如果当前字母与栈顶字母相同，就将其一并删掉。对于所有栈为空的位置就是匹配位置了。 考虑优化。 我们将栈均从$1$位置开始推。维护$Sta\_i$为到$i$位置的栈的状态。 那么假设有一个解是合法的，那么中间新加入栈的元素都被弹出来了。那么就是$Sta\_r=Sta_{l-1}$。 于是我们对于每个位置的栈状态都hash起来，然后根据hash值个数就可以算出所有符合条件的子串个数了。 效率是$O(n \\log n)$的。