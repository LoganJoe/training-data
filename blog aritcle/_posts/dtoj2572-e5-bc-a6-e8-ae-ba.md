---
title: " DTOJ2572弦论\t\t"
tags:
  - 后缀自动机
url: 3516.html
id: 3516
categories:
  - DTOJ
  - Solution
date: 2018-08-21 22:51:10
---

好像是SAM的模板题，并且SA写不了。 我们建出$S$的SAM，如果$T=0$就把所有点的$right$集合大小当作$1$，否则算出每个点的$right$集合大小。 然后预处理出从每个点沿着转移边能走到的点的$right$集合大小的和。即维护有多少个子串能匹配当前前缀。然后利用这个依次确定答案每位是什么即可。 注意SAM预处理的信息都要按照拓扑序来求，拓扑序可以对每个点的$Max$做基数排序在$\\Theta(n)$内求出。