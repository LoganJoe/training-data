---
title: " DTOJ2917登山\t\t"
tags:
  - 思路
  - 数学
url: 4549.html
id: 4549
categories:
  - Solution
date: 2018-10-25 13:53:58
---

考虑首先计算不考虑障碍点，只考虑不穿过对角线的方案数。 而所谓的不穿过对角线，即就是我们不能走到$y=x+1$。而我们考虑走到终点关于$y=x+1$的对称点的一条路径，其一定会穿过$y=x+1$并且可以对称得到只碰到粉线而回到终点的路径。那么考虑减去这样的方案数，所以不穿过对角线的方案数就是无限制走到终点的方案数-无限制走到对称点的方案数。 而对于无限制走到某个点的方案数，由于只能向上向右走，那么 从$(0,0)$走到$(x,y)$，相当于在$x+y$步中插入$x$步走右边，那方案数就是$\\binom{x+y}{x}$。 推广的，走$(x\_1,y\_1)$走到$(x\_2,y\_2)$，不穿过对角线的方案数，即是 $$ \\binom{x\_2-x\_1+y\_2-y\_1}{x\_2-x\_1}-\\binom{x\_2-x\_1+y\_2-y\_1}{y\_2-x\_1-1} $$ 考虑不经过障碍点的方案数。我们可以拿总方案数减经过障碍点的方案数。因为障碍点个数比较小。我们考虑针对障碍点算答案。对于每个障碍点，之前可能经过一些障碍点。 先按照$x$轴排序。设$f\[i\]$为从$(0,0)$走到第$i$个关键点，前面不经过任何关键点的方案数。$g\[i\]$为从$(0,0)$走到第$i$个关键点，会经过其他关键点的方案数。$cal(a,b)$为从$a$点走到$b$点，不穿过对角线的方案数。明显，有$f\[i\]=cal(0,i)-g\[i\]$。对于$g\_i$的计算，我们考虑枚举前面走到的那个关键点，那么有$g\[i\]=\\sum\_{j=1}^{i-1}f\[j\]cal(j,i)$。 那么这样我们就可以$O(c^2)$算出答案了。