---
title: " BZOJ4259残缺的字符串\t\t"
tags:
  - FFT
  - 卷积
url: 1180.html
id: 1180
categories:
  - BZOJ
  - Solution
date: 2018-03-21 23:25:07
---

定义两个字符$a,b$的距离为 $$dist(a,b)=(a-b)^2\[a\\neq *\]\[b\\neq *\]$$ 把$*$定义为$0$，那么有 $$dist(a,b)=(a-b)^2ab$$ 如果两个字符串每个对应位置的距离都为$0$，那么我们称这两个字符串匹配。 令$f\[i\]$为从$B$串第$i$个位置和$A$串匹配的距离之和，如果$f\[i\]=0$就说明从$B$串第$i$个位置可以和$A$串匹配。那么有 $$f\[i\]=\\sum_{j=0}^{m-1}dist(a\_j,b\_{i+j})$$ 把$A$串翻转，那么有 $$f\[i\]=\\sum_{j=0}^{m-1}dist(a_{m-1-j},b_{i+j})$$ $$f\[i\]=\\sum_{j=0}^{m-1}(a_{m-1-j}-b_{i+j})^2a_{m-1-j}b_{i+j}$$ $$f\[i\]=\\sum_{j=0}^{m-1}({a_{m-1-j}}^2+{b_{i+j}}^2-2a_{m-1-j}b_{i+j})a_{m-1-j}b_{i+j}$$ $$f\[i\]=\\sum_{j=0}^{m-1}{a_{m-1-j}}^3b_{i+j}+a_{m-1-j}{b_{i+j}}^3-2{a_{m-1-j}}^2{b_{i+j}}^2$$ 显然这是卷积。分三次FFT求出$f\[i\]$的值即可。