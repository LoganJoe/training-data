---
title: " DTOJ3220区间\t\t"
tags:
  - 思路
url: 5713.html
id: 5713
categories:
  - Solution
date: 2018-12-23 10:51:43
---

明显有一种倍增的做法。这里考虑另外一种做法。 由于gcd单调不升，所以我们可以将gcd抽象成阶梯状下降的。 那么对于当前右端点，我们可以倒着做，计算从当前开始gcd每次变化的位置。 考虑单调向后推右端点，相当于每次加入一个数。计算对于后面gcd区间的影响。 不考虑每个区间的gcd值，可以发现，原有的gcd区间是会合并的。因为增加了一个数，当前数可能不具有某种质因子，而这个数又是全部区间的公共部分。因此有一部分的gcd会减小。 考虑每次暴力合并这些区间。每次要维护端点gcd，然后沿着端点向后跳即可。 可以发现gcd端点（即分界点）最多有log个，所以效率就是对的了。