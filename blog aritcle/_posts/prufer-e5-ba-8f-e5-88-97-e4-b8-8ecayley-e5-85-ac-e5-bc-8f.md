---
title: " Prufer序列与Cayley公式\t\t"
url: 3148.html
id: 3148
categories:
  - 笔记
date: 2018-07-29 14:02:40
tags:
---

Prufer序列
--------

prufer序列是一种无根树的编码表示，对于一棵$n$个节点带编号的无根树，对应唯一一串长度为$n-2$的prufer编码。 也就是说，prufer序列和无根树是可以互换的。

### 无根树$\\rightarrow$prufer序列

定义无根树中度数为$1$的点是叶子节点。 找到编号最小的叶子节点$x$，在prufer序列中添加与$x$相连的点，然后删除$x$，不断重复，直到只剩下**$2$**个节点。 具体可以用一个set，实时维护度数为$1$的点。

### prufer序列$\\rightarrow $无根树

记点集为$V$，每次取出prufer序列第一个元素$x$，然后在$V$中找到最小的没有在prufer序列中出现的元素$y$，然后在$x$和$y$之间连一条边，然后在prufer序列中删除$x$，点集$V$中删除$y$，不断重复，直到$V$中剩下两个点，最后在这两个点中连一条边。 具体也可以用一个set，实时维护prufer序列中没有出现过的点。

Cayley公式
--------

$n$个点有标号的无根树的个数：$n^{n-2}$。 因为一棵$n$个节点无根树唯一地对应了一个长度为$n-2$的数列，数列中的每个数都在$\[1,n\]$中。 有一些推广： $n$个点，第$i$个点的度数为$d\_i$的无根树个数：$\\frac{(n-2)!}{\\prod\_{i=1}^{n}(d\_i-1)!}$ 因为prefer序列中数字$i$恰好出现$d\_i-1$次。即$n$种元素，共$n-2$个，其中第$i$种元素有$d\_i-1$个，求排列数。 $n$个点，第$i$个点的度数为$d\_i$，另外还有$m$个节点度数未知的无根树个数：$\\frac{(n-2)!m^x}{x!\\prod_{i=1}^{n}(d\_i-1)!}$，其中$x=n-2-(\\sum\_{i=1}^{n}d_i-1))$ 相关证明可以看[这](http://www.matrix67.com/blog/archives/682)和[这](http://www.cnblogs.com/zhj5chengfeng/archive/2013/08/23/3278557.html)。