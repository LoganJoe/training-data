---
title: " BZOJ2654tree\t\t"
tags:
  - 带权二分
  - 最小生成树
url: 2987.html
id: 2987
categories:
  - BZOJ
  - Solution
date: 2018-07-23 10:02:35
---

wqs二分（带权二分）的经典题。 先考虑直接求一遍mst。 如果白色边数$<need$，那么我们给所有白色边的权值减去一个数再求一遍mst，白色边数会变多。 如果白色边数$>need$，那么我们给所有白色边的权值加上一个数再求一遍mst，白色边数会变少。 那么我们可以二分加/减的值，然后求一遍mst，根据当前白色边的数量来调整二分的值。 但这样会有一个问题。当我们加上$x$时，白色边数$>need$，而当我们加上$x+1$时，白色边数就$<need$了。也就是说我们无法恰好找到一个值使得白色边数$=need$。 注意到这种情况的出现，肯定会有很多边权相同的黑边和白边，因为数据保证合法。 我们做Kruskal给边排序时，如果边权值相同，那么令白边排在前面。因为有很多权值相同的黑边，所以我们可以用黑边把多余的白边替换掉。 也就是说，当白边个数$>need$时，用$mst-mid*need$更新答案即可。