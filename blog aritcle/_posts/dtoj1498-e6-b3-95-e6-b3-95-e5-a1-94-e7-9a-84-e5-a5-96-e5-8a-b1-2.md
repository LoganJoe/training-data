---
title: " DTOJ1498法法塔的奖励\t\t"
tags:
  - LIS
  - 线段树合并
url: 2398.html
id: 2398
categories:
  - Solution
date: 2018-06-14 12:51:43
---

求解LIS一般有两种方法：单调队列和线段树。 观察在序列上求解LIS的dp：$f\[i\]$为第i个位置之前的最长不下降子序列长度，其中i在序列中。$f\_i=\\min \\{f\_j+1\\},a\_j \\leq a\_i$。 那么相当于在第i个位置查询前$1 \\dots a_i-1$中所有点的$f$的最大值，然后将当前这个数插进去。 在树上的问题,我们可以用线段树合并解决。对于每个点，处理完子树的答案后，将所有子树合并到当前点的树上。由于是权值线段树+保存最大值，这个最粗暴的合并就可以解决。然后就是查询区间最大值。时间效率$O(n log n)$