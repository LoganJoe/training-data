---
title: " DTOJ3969pq\t\t"
tags:
  - dp
  - 思路
url: 4780.html
id: 4780
categories:
  - DTOJ
  - Solution
date: 2018-10-29 23:23:28
---

在测试中写出优秀的暴力然后过了才发现其实效率是对的，真是神奇的经历。 发现数据范围中，$P,Q\\geq 50$，这说明一个数最多被减$40$次。即所有数最多被减$2000$次。 显然每个数都是消到不能消最优。 考虑暴力dp。 记$f\[i\]\[j\]\[k\]$为前$i$个数，还剩$j$个$P$和$k$个$Q$可以给别的数消，已经消掉的最多的$P,Q$对数。 那么我们枚举一个数要消多少次$P$，记为$s\_1$。然后计算出同时最多能消多少次$Q$，记为$s\_2$。 那么我们要尽量和之前剩下的$P,Q$抵消。 记$cnt=\\min(j,s\_2)+\\min(k,s\_1)$，即最多能消掉的$P,Q$对数。 那么有 $$f\[i\]\[j\]\[k\]+cnt\\Rightarrow f\[i+1\]\[j+s\_1-cnt\]\[k+s\_2-cnt\]$$ 最后最大的$f\[n\]\[i\]\[j\]$就是答案。 转移的过程中高端优化一下，发现就过了……比如说把不合法的状态减掉。 其实效率是正确的。 由于一个数上最多只能消$40$次，对于$j>0,k>0$且$j+k>40$的状态$f\[i\]\[j\]\[k\]$是没有意义的，在之前的dp也不会被转移到。 那么我们直接删掉这些状态，再去dp复杂度就是靠谱的了。