---
title: " DTOJ2626TATT\t\t"
tags:
  - CDQ分治
url: 210.html
id: 210
categories:
  - DTOJ
  - Solution
date: 2018-01-10 14:38:33
---

这是道CDQ好题，严重加深了我对CDQ的印象，写+调了两天。 显然题目是关于四维偏序的DP。 令$f\[i\]$为在$i$点结束能经过的最多的点数，要找满足条件的$j$转移。 先用sort维护$x$有序，CDQ1（l,r）维护$y$有序并且维护每个点的$x$是属于哪个部分，CDQ2（l,r）在$y$有序的基础上归并维护$z$有序，同时用树状数组计拿$\[l,mid\]$中$x$小的点去更新$(mid,r\]$中$x$大的点。 由于这是dp，所以我们在求$f\[i\]$之前，要先求每一个$f\[j\]（j<i）$。因此要在CDQ1（l,r）中要先处理$\[l,mid\]$，然后调用CDQ2转移dp，使得左边的$f$值达到最优后，再去处理$(mid,r\]$。