---
title: " DTOJ1213极地旅行社\t\t"
tags:
  - 并查集
  - 树链剖分
  - 线段树
url: 3071.html
id: 3071
categories:
  - DTOJ
  - Solution
date: 2018-07-25 22:39:26
---

显然加边会加出一个树的结构。那么我们可以用并查集维护连通性，然后把这棵树的结构求出来。 发现操作3是询问两点之间的路径信息，由于是树上两点的路径，很容易想到树链剖分+线段树。 同时操作2也是线段树可以维护的。 那么就是线段树维护单点修改和区间求和即可。 那么我们处理询问时再维护一遍所有点的连通性，对于操作3如果两点连通就在线段树上查询即可。