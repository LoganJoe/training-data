---
title: " DTOJ2455有趣的有趣的家庭菜园\t\t"
tags:
  - dp
  - 线段树
url: 503.html
id: 503
categories:
  - Solution
date: 2018-02-04 20:27:55
---

首先考虑一半的单调的情况： 很显然写出DP式子： ![](http://106.14.145.88/wp-content/uploads/2018/02/捕获-2-300x50.png) 那么考虑如何优化。 考虑将h\[i\]离散化以后建立一棵以h\[i\]为下标的线段树，记录这一高度下可以得到的最大价值。 然后需要实现以下操作：

1.  区间询问：询问高度在0-h\[i\]之间的最大价值。
2.  区间减：将区间0--h\[i\]-1的所有值减去cost\[i\].
3.  单点修改。给h\[i\]的值改为当前的f\[i\].

这样就可以求出一个单增的f\[i\]. 另外一边从n开始的单调递减同理。时间复杂度O(nlogn) 说实话，这个题目真的够扯。