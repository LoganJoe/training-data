---
title: " DTOJ2699道路建造\t\t"
tags:
  - 容斥
  - 欧拉回路
url: 1096.html
id: 1096
categories:
  - DTOJ
  - Solution
date: 2018-03-19 19:12:11
---

答案其实是联通的欧拉图的个数$\\times C_{n}^{2}$。因为对于每一个欧拉图，任选两个点，如果这两点有边就删去，没有就添加，得到的图都是答案所求的。根据欧拉图的度数全为偶数可知是不会有重复的，因为删/加一条边会有两个度数为奇数的点，再删/加另一条边是不会得到新的欧拉图的。 那么现在问题就是如何求联通的欧拉图的个数。 设$f\[i\]$为$i$个点联通的欧拉图的个数，$g\[i\]$为$i$个点度数为偶数的图的个数（不一定联通）。 那么有 $$g\[i\]=2^{C_{i-1}^{2}}$$ 因为点$1$可以与剩下的$n-1$个点连出去最多$n-1$条边，但确定其中$n-2$条边连或不连后，为了保证度数为偶数，剩下那条边连或不连是确定的了。同理点$2$只能选择$n-3$条边连或不连（与$1$的边在考虑$1$的时候已经确定了）。那么一共就只能选择$C_{i-1}^{2}$条边连或不连。 而$f\[i\]$可以通过容斥得到，即用总的度数为偶数的图个数减去不连通的度数为偶数的图个数。即 $$f\[i\]=g\[i\]-\\sum_{j=1}^{i-1}f\[j\]\\times g\[i-j\]\\times C_{i-1}^{j-1}$$ 意思就是，枚举点$1$所在的联通块大小$j$，剩下$i-j$个点联通不连通皆可，再乘上从除点$1$外的$i-1$个点中选出点$1$联通块的剩下的$j-1$个点的方案数。 $f\[n\]\\times C_{n}^{2}$即为答案。