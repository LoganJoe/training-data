---
title: " DTOJ3919树\t\t"
tags:
  - 二分
  - 点分治
url: 3917.html
id: 3917
categories:
  - DTOJ
  - Solution
date: 2018-09-12 13:37:40
---

求第$k$小，我们考虑二分。 统计以某个点为端点的$\\leq mid$的路径数量可以想到用点分治，但一次点分治是$\\Theta(n\\log n)$的，那么每个点都要二分$\\log$次，那么效率就是$\\Theta(n^2\\log^2 n)$的。肯定TLE了。 注意到我们一次点分治可以分别求出以每个点为端点的合法路径数量，那么我们考虑一起二分然后再点分治统计路径数。 记第$i$个点的当前答案范围为$\[L\_i,R\_i\]$，记$mid\_i=\\left \\lfloor \\frac{L\_i,R\_i}{2}\\right \\rfloor$。 然后我们跑一遍点分治，每次求出重心后对于点$i$求以点$i$为起点且边权和$\\leq mid\_i$的路径数。 即对于每个点求出重心到它的距离，然后排序一下距离数组，对于每个点在距离数组里二分一下算另一个端点的方案数即可。 时间复杂度$\\Theta(n\\log ^2n)$。常数比动态点分治的解法大很多。