---
title: " DTOJ2594字符串\t\t"
tags:
  - 二分
  - 字符串
  - 思路
url: 3994.html
id: 3994
categories:
  - DTOJ
  - Solution
date: 2018-09-21 15:45:39
---

显然被删掉的长度是不会减小的，也就是说我们先删掉长度为$1$的，然后在新的字符串中删掉长度为$2$的，如此重复下去。 那么我们可以枚举被删掉的长度，然后找到把该删的删掉。 但是这样如果一直都不用删，那么对于每个长度都要在字符串中找一遍，时间复杂度就变成$\\Theta(n^2)$了。这显然不能接受。 假如当前枚举的长度为$x$，考虑如何判断能否删掉至少一个长度为$x$的子串。 要能删就一定会有一个长度为$2x$的串，且前$x$个和后$x$个是相同的。 这个长度为$2x$的串一定会经过两个是$x$倍数的位置。假设是位置$kx$和$(k+1)x$。 那么我们会发现，$kx$往前和$(k+1)x$往前最长公共前缀（LCP）的长度加上$kx$往后和$(k+1)x$往后最长公共后缀（LCS）的长度一定是$>x$的。 反过来也是成立的，如果LCP的长度加上LCS的长度$>x$，就一定存在一个可以删的串。 长度从$1$枚举到$n$，求LCP和LCS的位置个数根据调和级数可以知道是$\\Theta(n\\log n)$的。 我们可以用二分求LCP和LCS，那么时间复杂度就是$\\Theta(n\\log^2 n)$。