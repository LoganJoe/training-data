---
title: " DTOJ3914因数\t\t"
tags:
  - 思路
  - 数学
url: 3968.html
id: 3968
categories:
  - Solution
date: 2018-09-16 20:34:07
---

大概发现询问的数并不是很多，所以好的数也没有几个。

一个玄妙的不知道怎么证明的结论：一个好数必然是由另一个好数乘上一个质数得到的。

于是我们用小根堆维护所有好数，然后将他们取出来乘个质数丢回去。由于这些数此时取出来是最小的，于是我们判定它是不是好数，只需要维护所有数因数最大值和次大值，大于等于次大值的都是好数。那么我们还要顺便用类似线性筛的方法维护一下这个数的因数个数就可以了。

然后考虑证明一下最大需要枚举到哪个质数。只需要枚举到大约100的质数就够用了。这个证明比较玄妙，在这里不做展开。