---
title: " DTOJ2407orzzcz\t\t"
tags:
  - 博弈
url: 3903.html
id: 3903
categories:
  - Solution
date: 2018-09-09 20:37:29
---

首先，我们考虑两堆相等的情况。这一定是先手必败的，因为先手每走一步，后手都可以做镜像操作来抵消先手。那么我们猜想一下，对于所有对称的局面，都是先手必败。因为在先手取石子的对称堆中取相同多的石子，并把和先手等量的石子分给先手分配给的堆的对称堆来抵消先手一定可行。

那么我们考虑其他的情况。我们可以一步归纳到一对一，也就是必败的情况，那么当前这一步就是先手必胜的。分类讨论如下：

*   总堆数为奇数，可以把石子最多的一堆的石子分配给其它堆，使得其它堆两两相等。最多一堆的石子一定足够多可以补齐。
*   堆数为偶数，把最多的一堆减少到和最少堆一样多，并把拿掉的石子分给别的堆，使其一对一相等

可以证明，上述两步一定可以做出，于是我们可以一步转化到必败态，当前就是必胜的。

于是，我们只需要判断，所有堆数的出现次数是否为偶数即可。

你明显不可以直接简单的判断异或和是否为0。