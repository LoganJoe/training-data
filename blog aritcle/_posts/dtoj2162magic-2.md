---
title: " DTOJ2162magic\t\t"
url: 816.html
id: 816
categories:
  - Solution
date: 2018-02-26 23:06:24
tags:
---

我们思考一个点向外连边可以访问到的所有的aj。考虑一个aj如果他要被选，前提是所有比他大的aj都不被选。那么我们都有一个点将其有，连边的所有的a从小到大排序。可以看出，这就是要求一个最大权闭合图。那么我们可以应用最大权闭合图的建边方法。对于每一个点向汇点连一条容量为bi的边。对于每个点向外联的点，由源点向最小的点连一条容量为a\[i\]的边，之后的点由原点向该点连一条容量为a\[i\]-a\[i-1\]的边。这些虚拟点向本点连一条容量为inf的边，相邻虚拟点之间也连一条容量为inf的边。跑出最大流即为最小割，那么也就是最大权闭合图的最大权值了。