---
title: " DTOJ4114sub\t\t"
tags:
  - FWT
  - 思路
url: 6062.html
id: 6062
categories:
  - DTOJ
  - Solution
date: 2019-01-16 18:43:07
---

显然成对的数和$0$我们可以直接取掉。考虑剩下的数。 相当于我们在一个集合中选一个最大的子集，使得子集异或和为$0$。 子集异或问题，我们考虑线性基。 对于不属于基中的数，我们随意取，如果异或和不为$0$的话，可以通过选一些基中的数使得异或和为$0$。 我们是想取尽量多的数，也就是说，不在基中的数，我们一定可以全部取了。 线性基中最多有$\\log n$个数，那么答案就一定$\\geq n-\\log n$。 那我们转换一下思路，我们可以去求最少删掉几个数，使得剩下的数的异或和为$0$。 记所有数的异或和为$val$，问题就变成了最少选多少个数能异或出$val$。 我们可以用FWT，每FWT一次看一下能不能异或出$val$即可。 时间复杂度$\\Theta(n\\log ^2 n)$。大多时候并不会跑$\\log n$次FWT。 还可以通过预处理+二分做到$\\Theta(n\\log n\\log \\log n)$。实际效率没有差多少。