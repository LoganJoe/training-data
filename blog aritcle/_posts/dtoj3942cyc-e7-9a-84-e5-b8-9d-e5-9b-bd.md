---
title: " DTOJ3942CYC的帝国\t\t"
tags:
  - 最小生成树
url: 4234.html
id: 4234
categories:
  - Solution
date: 2018-10-19 16:25:49
---

不妨将其放到mst上面考虑。

一条关键边，假设其不在最小生成树上，那么其一定是$inf$。否则我们考虑那条边会影响这条边的答案。对于所有非树边，肯定会影响到的部分是其端点所在的那一条链上的所有边，存在了一个最多不能增加超过该边边权的限制。

因为拿关键边去替换没有意义。那么我们考虑不是关键边的所有非树边。将这些边从小到大排序依次处理。每次选取一条边，将其两端点在树上的路径都赋上这条边的边权作为限制，同时将这条路径上的所有点缩起来，因为边权比他大的边都在接下来处理，对这些边没有意义。这样做就可以求出每条关键边的答案了。