---
title: " DTOJ3062礼物\t\t"
tags:
  - 分数规划
  - 单调队列
url: 5735.html
id: 5735
categories:
  - Solution
date: 2018-12-23 12:13:08
---

考虑二分答案$mid$，转化为分数规划问题。那么即求$\\max\\{M(i,j)-m(i,j)+i\\cdot mid-j\\cdot mid\\}$的最大值。 由于题目有所选区间长度在$\[L,R\]$的限制。两个一起处理不太好做，我们考虑将这两个东西拆开处理。 考虑下限。分别维护$A\_i$单调递增和递减的两个单调队列，保证队列元素的位置差小于$L$。那么我们可以在队首取到极差的合法最大值$S$。显然此处最大值必须大于$S - (L - 1) \\cdot mid) > K \\cdot mid$。否则对于任意二分的答案一定满足$L$的限制。 接下来考虑在$j-i+1 \\leq R$下取得$\\max\\{M(i,j)-m(i,j)+i\\cdot mid-j\\cdot mid\\}$的最大值。 考虑当极差不在端点的情况都是没有用的。我们只考虑极差在端点取到。 首先令$i < j, m(i,j)=i,M(i,j)=j$。此时我们要让$A\_j-A\_i+ i\\cdot mid-j\\cdot mid$最大，那么就是要取$A\_i - i \\cdot mid $的极差。那么我们枚举其中一端，另外一端用单调队列维护就好了。 那么当$i < j,M(i,j)=i,m(i,j)=j$的情况也是同理，只不过要取到的极差变为了$A_i+i \\cdot mid$而已。 用一个单调队列就可以维护了。