---
title: " DTOJ3939水壶\t\t"
tags:
  - 倍增
  - 最小生成树
url: 4200.html
id: 4200
categories:
  - Solution
date: 2018-10-18 18:53:54
---

将所有的建筑物看做一个点。点与点之间的最短距离一定在这些点形成的最小生成树上面。

由于是在网格图上，将所有的边全部连上是不现实的。但是考虑网格图的最短路性质。我们将所有点都压进队列里面，然后做bfs增广。

由于是同时拓展，所以这个时候走过的边权是一样的。那么我们可以按照这样拓展，碰到一个已经被拓展过一次的点就加到边集之中，这样连边仍然满足“边的最小集”性质，总边数在$O(4wh)$左右。

然后我们直接建出最小生成树，在最小生成树中倍增跑出边权的最大值在$O(n log \ n)$内解决询问。