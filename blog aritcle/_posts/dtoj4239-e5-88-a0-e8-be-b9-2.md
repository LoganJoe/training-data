---
title: " DTOJ4239删边\t\t"
tags:
  - 思路
url: 7102.html
id: 7102
categories:
  - Solution
date: 2019-03-24 12:46:56
---

我们考虑删去的边的性质：

*   假设删去的边有至少一条为桥，那么一定不合法。
    
*   否则，我们跑出原图的dfs树，删去的边一定为两条树边，或者一条树边一条返祖边。
    

下面我们考虑第二个case，并且跑出dfs树，在树上考虑问题。

考虑每个返祖边，与其两端点在树上构成路径形成一个环。那么让图不连通首先要断掉这个环的两个环边，并且保证没有返祖边沟通这两部分。

于是可以发现一个很显然的结论：对于每条返祖边，令其两端点之间路径上的每条边都加进这条返祖边，那么对于两条树边断开可以使得图不连通的充要条件是，这两个点的返祖边集合相同。类似的，对于一条树边一条返祖边的情况，其充要条件是这条树边仅属于该条返祖边。

证明显然。

考虑求出每个返祖边集合中点的数量。我们对于每条返祖边，给定一个随机hash值，并且将这个hash值作用在该点的两端点上。考虑将边拿出来当做点，原来的点作为边，做树形dp。那么该条边的返祖边集合的hash值，相当于其子树内所有点的hash值异或和。

考虑一条返祖边的路径。其在一端点记录hash值，即代表这条返祖边被计算一次。在这个hash值被异或掉之前，这条返祖边一定跨过当前子树根。否则遇到另外一个端点并异或掉这个值，说明这条返祖边路径完全在这个子树内，并没有跨过当前点。那么这样就可以计算出每条边的返祖边集合了。

那么这个时候，桥的hash值肯定为​。hash值排序并计数即可。