---
title: " DTOJ3567Building Bridges\t\t"
tags:
  - CDQ分治
  - 斜率dp
url: 1390.html
id: 1390
categories:
  - DTOJ
  - Solution
date: 2018-04-10 18:46:15
---

容易想到dp。记$f\[i\]$为最后一个桥梁在$i$的最小代价，$f\[n\]$即为答案。 考虑从$j$转移过来的代价，有 $$f\[i\]=min\\{f\[j\]+(h\_i-h\_j)^2+\\sum_{k=j+1}^{i-1}w\_i\\}$$ 记$Sum\_i=\\sum_{j=1}^{i}w\_i$，考虑化简式子 $$f\[i\]=min\\{f\[j\]+h\_i^2+h\_j^2-2h\_ih\_j+Sum\_{i-1}-Sum\_j\\}$$ $$f\[i\]=min\\{f\[j\]-Sum\_j+h\_j^2-2h\_ih\_j\\}+Sum\_{i-1}+h\_i^2$$ 将$f\[i\]$看成截距，$h\_i$看成斜率，$2h\_j$看成$x$，$f\[j\]-Sum\_j+h_j^2$看成$y$，每个$j$就可以用一个点$(x,y)$表示，那么就是要最小化过一个点的直线截距。容易发现最优决策的$j$一定是在下凸壳上的点。 那么就是要对于每个$i$维护所有的$j$的下凸壳。 此题斜率和点的坐标都不单调，可以用CDQ分治解决。类似[DTOJ1161货币兑换](http://www.dtenomde.com/2018/01/author=jiangyutong/article=177/)。 考虑一个分治过程$\[l,r\]$，我们要求出在$\[l,r\]$中的$f$。可以先通过分治求出在$\[l,mid\]$中的$f$，然后用$\[l,mid\]$中的点建凸壳，去更新$\[mid+1,r\]$中的$f$，然后再通过分治求出在$\[mid+1,r\]$的$f$。 更新时要在凸壳上二分。总时间复杂度$\\Theta(nlog^2\\space n)$。 初始按斜率排序后可以去掉二分的$log$，但是会难写一点。