---
title: " 行列式与矩阵树定理\t\t"
url: 3161.html
id: 3161
categories:
  - Algorithm
date: 2018-07-30 11:54:15
tags:
---

### 前置知识

#### 排列

对于一个大小为$n$的排列,定义由$1,2,...,n$组成的有序数组$i\_1,i\_2,...,i_n$为$1,2,...,n$的一个排列。

排列的对换是相邻两位交换。每次对换会使得逆序对数，也就是排列对换成标准排列的次数变动1。

我们称，逆序对数为奇数的排列为奇排列，反之为偶排列。记一个排列的逆序对数为$t$。那么一个排列的delta函数为  
$$  
\\delta(i\_1,i\_2,...,i_n)=(-1)^{t}  
$$

#### 行列式

行列式是对于$n$阶矩阵定义的一个函数。$n$阶矩阵$A$的行列式是一个实数，定义为$det(A)$.  
$$  
det(A)=\\sum\\limits_{(i\_1,i\_2,...,i\_n)}\\delta(i\_1,i\_2,..,i\_n)a_{1,i\_1}a\_{2,i\_2}...a\_{n,i_n}=|A|  
$$  
行列式也可以写成  
$$  
det(A)=|A|=\\left|  \\begin{matrix} a_{1,1} & a_{1,2} & \\cdots & a_{1,n} \\\  \\vdots & \\vdots & \\ddots & \\vdots \\\ a_{n,1} & a_{n,2} & \\cdots & a_{n,n} \\end{matrix}  \\right|  
$$  
就是每行每列只选一个元素的所有情况乘起来再乘上排列的delta函数的和。

另外，二阶矩阵的行列式是所表示的两个二维向量的叉积，三阶矩阵的行列式是所表示的三个三维向量的混合积。

下面给出行列式的一些性质：

**性质1**

设_A_是_n_阶矩阵，则

$$  
det(A^T)=det(A)  
$$

其中，$T$是矩阵转置符号。

考虑定义式子即可证明。

这个定理的重要意义在于，它告诉我们行列式的行和列的地位是平等的。确切地说，每个关于行的性质，对列必然成立；反之亦然。

**性质2**

行列式的任两行（或两列）互换，行列式变号。

证明：两行互换后相当于排列中两个元素交换，逆序对必定改变奇数个，正负改变 。设交换的两个元素为$i,j$，则相当于对换了$2∗(j−i)−1$次

*   **推论**：行列式的某两行（或两列）相同时，行列式的值为0。

**性质3**

用实数$\\lambda$乘以一行（或列）后，所得到的行列式等于原来的行列式乘以$\\lambda$。

*   **推论**：行列式两行成比例或一行全0，值为0

**性质4**

两个行列式只有一行不同，他们的行列式和等于不同的行相加后的行列式。  
$$  
\\left| \\begin{matrix}  
{ {a}_{1,1}}_{ {}} & \\cdots & { {a}_{1,n}} \\\  
\\vdots & \\ddots & \\vdots \\\  
{ {a}_{j-1,1}} & \\cdots & { {a}_{j-1,n}} \\\  
{ {a}_{j1}}+{ {b}_{j1}} & \\cdots & { {a}_{jn}}+{ {b}_{jn}} \\\  
{ {a}_{j+1,1}} & \\cdots & { {a}_{j+1,n}} \\\  
\\vdots & \\ddots & \\vdots \\\  
{ {a}_{n,1}} & \\cdots & { {a}_{n,n}} \\\  
\\end{matrix} \\right|=\\left| \\begin{matrix}  
{ {a}_{1,1}}_{ {}} & \\cdots & { {a}_{1,n}} \\\  
\\vdots & \\ddots & \\vdots \\\  
{ {a}_{j-1,1}} & \\cdots & { {a}_{j-1,n}} \\\  
{ {a}_{j,1}} & \\cdots & { {a}_{j,n}} \\\  
{ {a}_{j+1,1}} & \\cdots & { {a}_{j+1,n}} \\\  
\\vdots & \\ddots & \\vdots \\\  
{ {a}_{n,1}} & \\cdots & { {a}_{n,n}} \\\  
\\end{matrix} \\right|+\\left| \\begin{matrix}  
{ {a}_{1,1}}_{ {}} & \\cdots & { {a}_{1,n}} \\\  
\\vdots & \\ddots & \\vdots \\\  
{ {a}_{j-1,1}} & \\cdots & { {a}_{j-1,n}} \\\  
{ {b}_{j,1}} & \\cdots & { {b}_{j,n}} \\\  
{ {a}_{j+1,1}} & \\cdots & { {a}_{j+1,n}} \\\  
\\vdots & \\ddots & \\vdots \\\  
{ {a}_{n,1}} & \\cdots & { {a}_{n,n}} \\\  
\\end{matrix} \\right|  
$$  
对于列也有同样的性质。

据说很显然但是我看不出来。考虑定义式，把加的那一行展开，化简后就可以得到了。

*   **推论** 将行列式的任意行乘以实数$\\lambda$，再相应地加到另一行上去，行列式的值不变 。
*   证明：拆成两个行列式的和，一个有两行成比例。

$$  
\\left| \\begin{matrix}  
{ {a}_{1,1}}+\\text{ }\\!\\!\\lambda\\!\\!\\text{ }{ {a}_{j,1}} & \\cdots & { {a}_{1,n}}+\\text{ }\\!\\!\\lambda\\!\\!\\text{ }{ {a}_{j,n}} \\\  
{ {a}_{2,1}} & \\cdots & { {a}_{2,n}} \\\  
\\vdots & {} & \\vdots \\\  
{ {a}_{n,1}} & \\cdots & { {a}_{n,n}} \\\  
\\end{matrix} \\right|=\\left| \\begin{matrix}  
{ {a}_{1,1}} & \\cdots & { {a}_{1,n}} \\\  
{ {a}_{2,1}} & \\cdots & { {a}_{2,n}} \\\  
\\vdots & {} & \\vdots \\\  
{ {a}_{n,1}} & \\cdots & { {a}_{n,n}} \\\  
\\end{matrix} \\right|  
$$  
由以上性质我们可以高斯消去在$O(n^3)$下解出行列式的值。

**引理**

每行每列和均为$0$的矩阵行列式为$0$。

#### 行列式的解法

我们将行列式$B$消成上三角形式$B'$,同时记录行的交换次数$S$，那么有  
$$  
\\det (B)={ {\\left( -1 \\right)}^{S}}\\det (B')=\\left| \\begin{matrix}  
b'_{1,1} & b'_{1,2} & \\cdots & b'_{1,n} \\\  
0 & b'_{2,2} & \\cdots & b'_{2,n} \\\  
\\vdots & \\ddots & \\ddots & \\vdots \\\  
0 & \\cdots & 0 & b'_{n,n} \\\  
\\end{matrix} \\right|  
$$

由于$B'$是上三角形式的，可以得到，$det(B')$的值即为中间那条对角线的乘积。那么会有：$\\det B={ {\\left( -1 \\right)}^{S}}\\prod\\limits_{i=1}^{n}{b'_{i,i}}$

#### 余子式

一个行列式的$K$阶子式，定义为原行列式选取$k$行$k$列组成的$K$阶行列式。

行列式的余子式，或者$n-1$阶主子式，为原行列式去掉第$k$行和第$k$列所组成的新$n-1$阶行列式。

#### Binet-Cauchy公式

设$A$和$B$各为$p\*q$及$q\*p$矩阵，则有:

![](http://www.dtenomde.com/wp-content/uploads/2018/07/捕获-1.png)

我也不知道这是什么鬼东西，所以不做介绍。

### 基尔霍夫矩阵与矩阵树定理

![img](https://gss2.bdstatic.com/-fo3dSag_xI4khGkpoWK1HF6hhy/baike/w%3D268%3Bg%3D0/sign=179aa044828ba61edfeecf29790ff037/b3fb43166d224f4a860bd59d09f790529922d1aa.jpg)

好像这人还挺牛逼的样子...

1.  [主要成就](https://baike.baidu.com/item/%E5%8F%A4%E6%96%AF%E5%A1%94%E5%A4%AB%C2%B7%E7%BD%97%E4%BC%AF%E7%89%B9%C2%B7%E5%9F%BA%E5%B0%94%E9%9C%8D%E5%A4%AB/2371618?fromtitle=%E5%9F%BA%E5%B0%94%E9%9C%8D%E5%A4%AB&fromid=639565&fr=aladdin#2)
2.   [电路设计](https://baike.baidu.com/item/%E5%8F%A4%E6%96%AF%E5%A1%94%E5%A4%AB%C2%B7%E7%BD%97%E4%BC%AF%E7%89%B9%C2%B7%E5%9F%BA%E5%B0%94%E9%9C%8D%E5%A4%AB/2371618?fromtitle=%E5%9F%BA%E5%B0%94%E9%9C%8D%E5%A4%AB&fromid=639565&fr=aladdin#2_1)
3.   [热辐射](https://baike.baidu.com/item/%E5%8F%A4%E6%96%AF%E5%A1%94%E5%A4%AB%C2%B7%E7%BD%97%E4%BC%AF%E7%89%B9%C2%B7%E5%9F%BA%E5%B0%94%E9%9C%8D%E5%A4%AB/2371618?fromtitle=%E5%9F%BA%E5%B0%94%E9%9C%8D%E5%A4%AB&fromid=639565&fr=aladdin#2_2)
4.   [化学](https://baike.baidu.com/item/%E5%8F%A4%E6%96%AF%E5%A1%94%E5%A4%AB%C2%B7%E7%BD%97%E4%BC%AF%E7%89%B9%C2%B7%E5%9F%BA%E5%B0%94%E9%9C%8D%E5%A4%AB/2371618?fromtitle=%E5%9F%BA%E5%B0%94%E9%9C%8D%E5%A4%AB&fromid=639565&fr=aladdin#2_3)
5.   [光学理论](https://baike.baidu.com/item/%E5%8F%A4%E6%96%AF%E5%A1%94%E5%A4%AB%C2%B7%E7%BD%97%E4%BC%AF%E7%89%B9%C2%B7%E5%9F%BA%E5%B0%94%E9%9C%8D%E5%A4%AB/2371618?fromtitle=%E5%9F%BA%E5%B0%94%E9%9C%8D%E5%A4%AB&fromid=639565&fr=aladdin#2_4)
6.  [薄板直法线理论](https://baike.baidu.com/item/%E5%8F%A4%E6%96%AF%E5%A1%94%E5%A4%AB%C2%B7%E7%BD%97%E4%BC%AF%E7%89%B9%C2%B7%E5%9F%BA%E5%B0%94%E9%9C%8D%E5%A4%AB/2371618?fromtitle=%E5%9F%BA%E5%B0%94%E9%9C%8D%E5%A4%AB&fromid=639565&fr=aladdin#2_5)

不扯了。对于原图的生成树计数：

*   度数矩阵：_G_的度数矩阵$D\[G\]$是一个$n*n$的矩阵，并且满足：当$i≠j$时，$d_{ij}=0$；当$i=j$时，$d_{ij}=degree(v_i)$。
*   邻接矩阵：_G_的邻接矩阵$A\[G\]$也是一个$n*n$的矩阵， 并且满足：如果$vi$,$vj$之间有边直接相连，则$a_{ij}=1$，否则为$0$。

我们定义$G$的$Kirchhoff$矩阵(也称为拉普拉斯算子)$C\[G\]$为$C\[G\]=D\[G\]-A\[G\]$，即度数矩阵减去邻接矩阵。$Matrix-Tree$定理可以描述为：$G$的所有不同的生成树的个数等于其$Kirchhoff$矩阵$C\[G\]$任一余子式的行列式的绝对值。

什么你问我证明？显然我是不会证明的。于是我很贴心的为你提供了论文。  
能不能看懂就靠你造化了。下面内容与我无关。（好像上面很多也与我无关）

* * *

我们不难看出，这个定理的关键是图的Kirchhoff矩阵。这个矩阵有什么特殊的性质呢？经过分析，我们可以发现：

*   对于任何一个图_$G$_，它的Kirchhoff矩阵_$C$_的行列式总是$0$。这是因为_$C$_每行每列所有元素的和均为$0$。
*   如果_$G$_是不连通的，则它的Kirchhoff矩阵_$C$_的任一个主子式的行列式均为$0$。

#### 证明：

如果$_G$_中存在$_k_(_k_>1)$个连通分量_G_1，_G_2，…，_Gk_，那么，我们可以重新安排_C_的行和列使得属于_G_1的顶点首先出现，然后是_G_2……。  回忆行列式的性质2，设我们一共进行了_t_次行交换，显然，我们同样需要进行_t_次列交换。因此，我们总共进行了2_t_次交换，所以，行列式的符号没有改变。

重新安排后的矩阵如下图所示：

![](http://www.dtenomde.com/wp-content/uploads/2018/07/A.png)

带方框的_Gi_表示了_C_\[_Gi_\]。注意在方框以外的地方都是0因为任意两个连通分量之间没有边相连。

设_r_是第_i_个连通分量中的第_j_个顶点，那么

*   如果_G_是一颗树，那么它的Kirchhoff矩阵_C_的任一个_n_-1阶主子式的行列式均为1。

证明：

为了证明这条重要的性质，我们通过不断的变换_Cr_\[_G_\]从而得到一个上三角矩阵并且使得主对角线上所有的数字都是1。

第一步：我们把所有的顶点按照在树上离_vr_的距离从近至远排列。首先是_vr_，然后是离_vr_距离为1的点，接下来是离_vr_距离为2的点……。距离相同的点可以任意排列。我们按照这个顺序将所有的定点重新编号。同时，把以_r_为根的有根树上_vi_的父结点_vj_称为_vi_的父亲，显然，在刚才得到的顺序中，_vj_出现在_vi_之前。

第二步：将_Cr_\[_G_\]的_n_-1行和_n_-1列按照刚才得到的顺序重新排列。因为行列都需要交换，所有总交换次数是偶数，_Cr_\[_G_\]的行列式不变。

第三步：按照刚才得到的顺序的逆序处理，对于每个_i_，如果_vi_的父亲_vj_不等于_vr_，则把第_i_列加到第_j_列上去。

这样处理过之后，我们来看一下现在的_Cr_\[_G_\]是否和我们的希望相同。我们通过归纳法来证明。显然，最后一列符合要求，因为最后一个点只和它的父亲之间有边，它的度为1。假设当前处理的是第_i_列，并且第_i_+1至第_n_-1列都符合要求。我们设_vi_的父亲是_vj_，它有_k_个孩子，显然，只有第_i_1，_i_2，…，_ik_列才会加到第_i_列上来。所有这些列，都在第_i_行有个-1而在对角线上有个1，而第_i_列在第_j_、_i_1，_i_2，…，_ik_行上为-1而在第_i_行上为_k_+1。每一列加上来的时候，第_i_行第_i_列减一同时与之相对的那一列加一变为0。最后第第_i_行第_i_列变为1，第_i_1，_i_2，…，_ik_行变为0。也就是说，最后_Cr_\[_G_\]会变成上三角矩阵并且主对角线上所有的数字都是1。这就证明了我们的结论。

在证明_Matrix-Tree_定理的过程中，我们使用了无向图_G_的关联矩阵_B_。_B_是一个_n_行_m_列的矩阵，行对应点而列对应边。_B_满足，如果存在一条边_e_={_vi_,_vj_}，那在_e_所对应的列中，_vi_和_vj_所对应的那两行，一个为1、另一个为-1，其他的均为0。至于谁是1谁是-1并不重要，如下图所示。

![](http://www.dtenomde.com/wp-content/uploads/2018/07/B.png)

接下来，我们考察_BBT_。容易证明，(_BBT_)_ij_等于_B_的第_i_行与第_j_列的点积。所以，当_i_=_j_时，(_BBT_)_ij_等于与_vi_相连的边的个数，即_vi_的度数；而当_i_≠_j_时，如果有一条连接_vi_、_vj_的边，则(_BBT_)_ij_等于-1，否则等于0。这与Kirchhoff矩阵的定义完全相同！因此，我们得出：_C_=_BBT_！也就是说，我们可以将_C_的问题转化到_BBT_上来，这样做有什么用呢？

设_Br_为_B_去掉第_r_行后得到的新矩阵，易知_Cr_=_BrBrT_。根据_Binet_-_Cauchy_公式，我们可以得到：

是把_Br_中属于_x_的列抽出后形成的新矩阵。我们注意到，当_x_中的边形成环时，总有。例如，如果新图中存在一个大小为3的环，那么我们可以重新安排如下图所示：

![](http://www.dtenomde.com/wp-content/uploads/2018/07/C.png)

这样，等于左上角3阶子式的行列式乘以右下角_n_-4阶矩阵的行列式。而左上角的3阶子式是退化的，它每行每列的和都是0。因此也等于0。类似的证明可以推广到环的大小任意的情况。

显然，可以看成是仅由所有的顶点和属于_x_的边构成的新图的Kirchhoff矩阵的一个_n_-1阶主子式。根据图的Kirchhoff矩阵的性质，如果将所有属于_x_的_n_-1条边加入图中后形成一颗树，那么为1；而如果没有形成树，则必然存在一个环，那么。也就是说，我们考察**边集所有大小为****_n_****-1****的子集，如果这个子集中的边能够形成一颗树，那么我们的答案加****1****，否则不变**。这就恰好等于原图生成树的个数！因此，我们成功地证明了_Matrix-Tree_定理！

如果图中有重边，_Matrix-Tree_定理同样适用，具体的证明方法类似，请读者自己思考。因为计算行列式的时间复杂度为O(_n_3)，因此，生成树的计数也可以在O(_n_3)的时间内完成。

#### 理解

刚才的分析可能有些“深奥”，下面让我们从直观上来理解一下这个定理。

我们首先来看一道简单的数学问题：试求方程所有非负整数解的个数。

这是我们大家都很熟悉的一道组合计数问题。我们通常的做法是设有2个_1_和两个△，我们将这4个元素任意排列，那么不同的排列的个数就等于原方程解的个数，即。为什么要这样做呢？

我们将所有6种排列列出后发现，一种排列就对应了原方程的一个解：

△△11对应_x_1=0，_x_2=0，_x_3=2；

△1△1对应_x_1=0，_x_2=1，_x_3=1；

△11△对应_x_1=0，_x_2=2，_x_3=0；

……

也就是说，我们通过模型的转化，找出了原问题和新问题之间的对应关系，并利用有关的数学知识解决了转化后的新问题，也就同时解决了原问题。这种转化的重要意义在于：在不同问题之间的架起了互相联系的桥梁。

回到我们讨论的_Matrix-Tree_定理上来。我们同样是经过模型的转化后（将图模型转化为矩阵模型），发现_Binet-Cauchy_公式展开式中的每一项对应着边集一个大小为_n_-1的子集。其中，值为1的项对应一颗生成树，而没有对应生成树的项值为0。这样，将问题转化为求展开式中所有项之和。再利用已有的数学知识，就可以成功解决这个问题。