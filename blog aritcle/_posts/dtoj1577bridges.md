---
title: " DTOJ1577bridges\t\t"
tags:
  - 二分图
  - 最大流
  - 欧拉回路
url: 4684.html
id: 4684
categories:
  - Solution
date: 2018-10-28 14:10:51
---

考虑二分答案。二分的答案不能大于每条边两个边权最大值的最小值。 大于答案的方向不能走。然后考虑判定这张图是否存在欧拉回路。由于这是一张混合图，而要存在欧拉回路，我们需要给每条边定向，使得所有点入度等于出度。而这个是有向图情况下的充要条件。 首先可以对于每条有两个方向的边随意定向。由于改变一条边的朝向会使得一个点的入度-出度加减2，所以随意定向后，仅当每个点入度-出度是个偶数时才有可能形成欧拉回路。 那么现在去掉所有原本有向的边，问题转化成了每条边的匹配问题。每条边可以匹配一个点，要求这张图是否存在一个带限制的完全匹配。限制是关于某个点的最多匹配数目。 那么按照如下方式连边：

*   若一个点的入度大于出度则从$S$向该点连流量为(入度-出度)/2的边。
*   若一个点的出度大于入度则从$T$向该点连流量为(出度-入度)/2的边。
*   沿着每条无向边与刚才随意定向相反的方向连一条流量为$1$的边。

若所有边满流，则说明存在完全匹配，才存在欧拉回路。