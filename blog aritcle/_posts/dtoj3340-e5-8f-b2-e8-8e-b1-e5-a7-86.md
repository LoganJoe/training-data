---
title: " DTOJ3340史莱姆\t\t"
tags:
  - dp
  - NTT
  - 卷积
url: 1176.html
id: 1176
categories:
  - DTOJ
  - Solution
date: 2018-03-21 23:09:45
---

考虑dp。$f\[i\]\[j\]$表示初始有一个棱长为$2^i$的史莱姆，打$j$次的方案数。 打第一次一定会将这个棱长$2^i$的史莱姆分成$8$个棱长$2^{i-1}$的史莱姆，接下来在这$8$个史莱姆上总共打$j-1$次。 也就是说 $$f\[i\]\[j\]=\\sum \\prod_{k=1}^{8}f\[i-1\]\[A\_k\]$$ 其中，$A\_k$是在第$k$只史莱姆上打的次数，保证$\\sum_{k=1}^{8}A_k=j-1$ 这是一个卷积的形式。 把$f\[i\]$看作一个多项式，$f\[i\]\[j\]$看成系数。 那么$f\[i+1\]$其实就是$f\[i\]^8$。快速幂优化后我们只要$3$次ntt就可以了。 计算完每个$f\[i\]$的多项式后就可以$O(1)$回答询问了。 注意每次NTT前的初始化。