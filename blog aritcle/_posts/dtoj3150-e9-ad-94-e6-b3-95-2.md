---
title: " DTOJ3150魔法\t\t"
tags:
  - 数学
url: 5912.html
id: 5912
categories:
  - Solution
date: 2019-01-01 11:10:13
---

很容易观察到每个数对于答案的贡献是一个组合数。 但是模数不为质数，模意义下的组合数需要求出逆元来计算。 由于每次我们递推组合数某一行，需要$\\times \\frac{n-i}{i}$。 只有当$gcd(i,k)=1$时$i$才有逆元。我们可以把$i$和$k$的所有公因子提出来，然后动态维护每个质因子在组合数中的次幂。剩下的部分乘的就直接乘。每次相当于对于一个幂在维护，用exgcd求出对应逆元即可。