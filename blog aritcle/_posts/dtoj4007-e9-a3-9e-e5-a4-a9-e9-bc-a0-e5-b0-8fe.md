---
title: " DTOJ4007飞天鼠小E\t\t"
tags:
  - 最短路
url: 4775.html
id: 4775
categories:
  - Solution
date: 2018-10-29 21:27:51
---

首先有一个结论：一定存在一个最优解使得对于任意可在$X$时间内到达的点，从起点到这个点的路程中不向上爬；对于大于$X$时间的部分，一定不向下爬。 所以我们只需要知道到某一个点的最短时间，即可确定到这个点时飞天鼠在树上的高度，这个高度是唯一的（在满足上面的结论的情况下）。因为在后面哪一段我们肯定是飞到某棵树的根，然后再考虑向上爬。 并且这个状态有一个优秀的性质——若s到t的最短路经过了k，则其中s到k的路径一定是s到k的最短路径。 这样我们就可以知道从一个点飞到另外一个点的真正耗时了。又因为整个过程“边权”都是非负的，所以我们可以用dijkstra_heap求出最短路，即最优解。 注意每次的边权是动态算出来的。 总复杂度$\\Theta((n+m)\\log m)$。 小E与博客域名有着千丝万缕的联系