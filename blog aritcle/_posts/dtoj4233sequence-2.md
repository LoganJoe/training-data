---
title: " DTOJ4233sequence\t\t"
tags:
  - 思路
url: 7050.html
id: 7050
categories:
  - Solution
date: 2019-03-17 20:30:28
---

这题为啥子$k \\le 3$啊？ 考虑离线询问，同时预处理出区间与的倍增表。 考虑固定左端点，向后推右端点。很显然，区间与的值只会变化$\\log$次。我们可以对于一个值，倍增推出区间与相同的右端点位置。那么这些区间对于与其相含的询问区间都有一次贡献。 那么考虑在$l$的位置扣掉前缀区间的答案，在$r$的位置加上前缀区间的答案，就是包含当前询问区间的答案了。 答案的统计可以用树状数组。考虑当前右端点在$\[a,b\]$间的区间贡献是递增的，那么就是区间加上一个等差数列，和区间加上一个值。用树状数组维护即可。