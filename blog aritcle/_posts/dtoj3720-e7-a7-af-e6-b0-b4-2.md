---
title: " DTOJ3720积水\t\t"
tags:
  - 思路
  - 线段树
url: 2663.html
id: 2663
categories:
  - Solution
date: 2018-07-03 21:09:07
---

我们发现，只有使得墙面增高的操作，而对于灌入积水后的部分，整个图是单峰的。 也就是说对于图上的最高点，到两边单调递减。 那么我们只需要维护所有砖块的面积，与整个单调图形的面积。 砖块的面积很好维护，问题在于单调的图形。 我们考虑一次修改操作对于现有形状的影响。

*   如果当前拔高到比最高点高的位置，那么最高点会被改变到当前位置，当前-最高点之间会被填满水。
*   假设拔高的高度比当前的单调高度小，那么只会更新到砖块的面积。
*   将单调的区列“整体拔高”。考虑这个的影响。首先肯定要向着最高点的方向找到单调增\\减的变化点。这段区间内的积水会被抬高到当前高度。这些都可以用线段树维护：相当于区间覆盖，区间求和，查询第一个比v大/小的位置。