---
title: " DTOJ4083逐梦逐梦逐梦\t\t"
tags:
  - 可持久化线段树
url: 5914.html
id: 5914
categories:
  - Solution
date: 2019-01-01 11:16:09
---

我们先在$\[l:r\]$中取出最大的$k$个数。 假设这$k$个数中奇数和偶数的个数都为偶，那么这本身就是最优解了。 考虑个数为奇的情况。这个时候我们考虑用一个还未选中的数去换，使得选出的$k$个数满足条件。 那么我们就找到最大的未被选奇数，去换掉最小的被选偶数，或者到最大的未被选偶数，去换掉最小的被选奇数，两种情况取最大值就好了。 具体实现可以用主席树+线段树二分，主席树按照序列下标开，每棵树按权值维护下标。一个线段树二分出$k$大树的位置，另外两个分别$\\leq k$最大奇数\\偶数，$\\geq k$最小奇数\\偶数。