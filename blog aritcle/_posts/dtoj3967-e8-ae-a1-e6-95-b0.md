---
title: " DTOJ3967计数\t\t"
tags:
  - dp
url: 4188.html
id: 4188
categories:
  - Solution
date: 2018-10-18 14:29:43
---

题目大意是要求有多少颗二叉树，满足二叉树的前序遍历为$1~N$的升序排列，中序遍历满足某些大小性质。

由于观察数据范围，就想到要dp。设计状态$F\[i\]\[j\]$表示前序遍历的编号为$i\\sim j$，且$i\\sim j$作为一颗单独的子树的二叉树个数。由于前序遍历的性质，这颗子树一定是以$i$为根，左子树为$i+1\\sim k$，右子树为$k+1\\sim j$。由中序遍历的性质可以知道，右子树的中序遍历大于根的中序遍历，而根的中序遍历大于左子树的中序遍历。所以如果位置k满足没有$k+1\\sim j$的中序遍历小于$i$，没有$i+1\\sim k$的中序遍历大于$i$，且没有$k+1\\sim j$的中序遍历小于$i+1\\sim k$，那么$k$就是一个合法位置。

那么dp式子就是$F\[i\]\[j\]=\\Sigma_{k=i+1}^{j+1}F\[i+1\]\[k\]*F\[k+1\]\[j\]$。其中$k$需要合法。