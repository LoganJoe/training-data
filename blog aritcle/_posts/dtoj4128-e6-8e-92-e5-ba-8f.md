---
title: " DTOJ4128排序\t\t"
tags:
  - 思路
url: 6513.html
id: 6513
categories:
  - DTOJ
  - Solution
date: 2019-02-21 21:40:31
---

我们可以将整个算法的过程分成若干整轮和一个不完整的轮。 记一共进行了$k$个整轮。 如果我们可以求出前面$k$个整轮后的序列，那么我们可以用暴力跑完最后一个不完整的轮得到答案。 那么问题就在于如何快速求出$k$个整轮后的序列。 我们观察一下一轮变化后序列发生了什么变化。 下文我们认为每轮操作后排在最前面的数被删掉了（序列长度$-1$），因为这个数不会对后面的算法造成影响。 这个算法的实质是每次贪心找一个下降子序列，然后将这个子序列循环右移一位。 如果一个数前面有比它小的数，那么这个数不会移动，因为基于贪心的下降子序列一定会选到它前面某个比它小的数。 如果一个数前面有比它小的数，那么一轮操作后，比它小的数个数$-1$。 如果一个数前面没有比它小的数，那么这个数会到它后面第一个比它小的数的位置上去，同时前面最小的比它大的数会到它的位置上，这也是基于贪心的下降子序列的选法。 如果一个数开始移动，那么它会一直移动到它归位或者结束，因为一轮过后这个数前面还是没有比它小的数。 对于原序列中的第$i$个数，如果它前面有$\\geq k$个比它小的数，那么这个数的位置就不变。 否则这个位置上的数会变成前面第$k$小的数。 我们用一个大小为$k$的大根堆动态维护第$k$小即可。