---
title: " DTOJ2164Utopia Policy\t\t"
tags:
  - LIS
  - 计算几何
url: 780.html
id: 780
categories:
  - DTOJ
  - Solution
date: 2018-02-25 21:23:03
---

同DTOJ1987Crazy Rabbit。 首先圆内的点是不会成为答案的。 对于圆外的点$P$，过$P$作圆$O$的切线，两条切线在圆$O$上会截出一段劣弧。发现这段劣弧与两条切线中间封闭的区域及两条切线另一个方向形成的夹角区域里的点，和$P$之间都没有连边。 通过画图可以发现，如果两个点按切线映射到圆$O$上的弧是相交且不包含的话，这两个点之间就有边。 按照点$P$和圆$O$的切点的极角代表对应的圆弧，也可以看作一段区间$\[l,r\]$。其中较小的极角当作区间左端点，大的当作区间右端点。因为一段劣弧对应的优弧是不会改变它和其他圆弧的相交关系的。 发现团中每个点对应的区间$\[l\_i,r\_i\]$，一定满足

$l\_1<l\_2<l\_3<…<l\_m<r\_1<r\_2<r\_3<…<r\_m$

区间先按$l$排序后，枚举第一个区间，发现剩下的区间即为满足$l<r_1$的区间中关于$r$的最长上升子序列，即变成了LIS问题。 O(nlog\\space n)内求解LIS问题有很多种方法，比如说记每种长度的LIS的最前结尾，单调栈维护，树状数组维护。求LIS的时候同时维护一下从哪里转移的就可以输出方案了。