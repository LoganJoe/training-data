---
title: " DTOJ3180反质数序列\t\t"
tags:
  - 二分图
  - 最大流
url: 4343.html
id: 4343
categories:
  - DTOJ
  - Solution
date: 2018-10-22 18:53:56
---

我们需要发现一些性质。 由于$2$是质数，所以不可能同时出现两个$1$。因此我们可以把序列中多余的$1$删掉。 对于新的序列，如果两个数相加是质数，那么这个质数一定$>2$，也就是说它是奇数，那么这两个数的奇偶性就不同。 那么如果$x+y$为质数，$y+z$为质数，那么$x+z$一定不为质数，因为$x,z$奇偶性相同，$x+z$一定是$>2$的偶数。 我们根据数的奇偶性二分图染色，如果两个数相加为质数就连一条边。 那么答案就是二分图的最大独立集。 根据二分图的性质：最大独立集=点数-最大匹配。那么我们求出最大匹配即可。 （听说匈牙利跑不过我就写了个最大流