---
title: " DTOJ1747最短路径树问题\t\t"
tags:
  - 点分治
url: 5936.html
id: 5936
categories:
  - DTOJ
  - Solution
date: 2019-01-01 22:16:58
---

我们肯定要先求出最短路径树。 最短路径树的边一定在最短路网上的边，我们先求出从$1$出发的最短路网。 考虑如何处理字典序最小的限制。 我们从$1$开始dfs，每次优先走没走过的所有点中最小的点，那么我们就得到了一棵dfs树。 容易发现，这棵dfs树就是我们要求的最短路径树。 那么问题就变成了求树上最长的包含$K$个点的路径长度以及路径数了。 这是点分治的模板题。 对于重心$x$，记$f\[i\]$为到$x$经过$i$个点的最长路径长度，$g\[i\]$为到$x$经过$i$个点且路径长度为$f\[i\]$的路径数量。 将从重心出发的两条路径拼起来更新答案即可。