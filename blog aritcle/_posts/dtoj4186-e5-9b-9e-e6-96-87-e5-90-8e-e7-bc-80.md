---
title: " DTOJ4186回文后缀\t\t"
tags:
  - dp
url: 6684.html
id: 6684
categories:
  - DTOJ
  - Solution
date: 2019-02-26 13:14:47
---

我们将字符串reverse，就变成了回文前缀了，显然不影响答案。 记$f\[i\]$为$N=i$时的答案。 $f\[1\],f\[2\],f\[3\]$比较特殊，我们直接初始化掉。显然$f\[1\]=S,f\[2\]=S(S-1),f\[3\]=S(S-1)^2$。 对于$i>3$的$f\[i\]$，我们考虑由$f\[i-1\]$递推得到。 显然加一位后，最后一位最多有$S$种可能，但加一位后可能会出现新的回文串，这样的回文串的个数是$f\[\\left \\lceil \\frac{i}{2}\\right \\rceil\]$的，扣掉即可。 至于为什么是$f\[\\left \\lceil \\frac{i}{2}\\right \\rceil\]$，稍微解释一下。 我们要扣掉的回文串，是长度为$i$，且除了本身没有一个回文前缀的回文串。 对于一个长度为$\\left \\lceil \\frac{i}{2}\\right \\rceil$的答案串，它是一个没有一个回文前缀的字符串。我们将它对称成长度为$i$的回文串后，它不会有除了本身外的回文前缀。 可以考虑反证法。如果有，不断对称一定能对称出一个长度$\\leq \\left \\lceil \\frac{i}{2}\\right \\rceil$的回文前缀。