---
title: " DTOJ2921Freight\t\t"
tags:
  - dp
  - 奇技淫巧
  - 找规律
url: 4453.html
id: 4453
categories:
  - DTOJ
  - Solution
  - 不会证
date: 2018-10-23 22:44:46
---

我们需要发现一些性质。 火车肯定是一批一批出去（每批指的是所有火车发车时间相隔1min），然后同批出去的一定是同一批回来。 那么如果知道了最后一批出去的火车有几辆，我们就能算出到达时间了。 记$a\_i$为第$i$辆车的发车时间，由于每分钟只能发一辆车，所以我们可以令$a\_i=\\min(a\_i,a\_{i-1}+1)$，这样就能保证每辆车都能在$a\_i$发车了。 我们要让最后一批（保证最后一辆车是准时发车的）出去的火车尽可能少，这样回来的时候等的时间就短。 我们记$f\[i\]$为前$i$辆火车出去又回来，最后一批出去的火车数量最小值。 那么$f\[i\]$等于$i$减去满足$a\_j+2m+f\[j\]-1\\leq a\_i-i+j+1$最大的$j$。$a\_j+2m+f\[j\]-1$是计算前$j$辆车，最后一批有$f\[j\]$辆，回来的最小时间。$a\_i-i+j+1$是如果前$i$辆最后$i-j$辆一起发车，最早那辆发车时间。显然一定要保证发车时间$\\geq$到达时间。 打几个表可以发现，这个最大的$j$好像可以二分。 再打几个表可以发现，好像这个$j$是单调不减的。 然后就写出来了。 最后答案是$a\_n+2m+f\[n\]-1$。 正常的dp可能是这样的。 ![](http://www.dtenomde.com/wp-content/uploads/2018/10/C68979AB-9645-4DA0-8DEA-0BE95E66D1C4.jpg) （最后一行，最优点好像是单调后移的）