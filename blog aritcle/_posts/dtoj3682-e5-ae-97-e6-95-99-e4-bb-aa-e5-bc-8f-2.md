---
title: " DTOJ3682宗教仪式\t\t"
tags:
  - 后缀数组
url: 2636.html
id: 2636
categories:
  - Solution
date: 2018-07-01 21:27:04
---

考虑容许失配k次的字符串匹配。 首先我们可以将串翻转后做26次fft，但是常数太大了。 那么我们可以考虑下面一个问题。对于一个模式串从某个位置开始匹配，当失配超过k次时即失败。 注意到K并不是很大。 那么我们需要的就是快速处理“下一次失配位置”的问题。 回顾SA中height数组的定义，即为两个相邻后缀的最长公共前缀长度。上面的问题就会转化成求两个串的最长公共前缀，也就是匹配串i位置开始的一个后缀与模式串的最长公共前缀。 这个可以在height数组上RMQ，然后$O(1)$解决。 于是我们枚举一个开始位置i，然后在height数组上RMQ，失配不超过k次即存在一个匹配。