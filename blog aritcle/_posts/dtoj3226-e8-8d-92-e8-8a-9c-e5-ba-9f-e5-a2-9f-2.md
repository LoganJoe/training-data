---
title: " DTOJ3226荒芜废墟\t\t"
tags:
  - dp
  - 思路
  - 矩阵
url: 5768.html
id: 5768
categories:
  - Solution
date: 2018-12-23 16:09:34
---

看一下题目限制：

“保证$ti,k$可以写成$2^a \\times 3^b$的形式，其中$a,b \\leq 5$。”

这已经是在明示“我有循环节”这件事实了。可以发现，循环节是$lcm(t_i,k)$。我们按照循环节将所有整个数轴划分成多块，每块大小是$lcm$。 首先考虑简单的dp。记$f\[i\]\[j\]$为从某块的第$i$个位置，走到下一块第$j$个位置的方案数。为了不重复计算，我们要求第一步走到的位置一定要$>k$。 $f\[i\]\[j\]$随便dp一下就出来了。 然后我们发现，其实这个dp的转移是一个矩阵。那么矩阵转移可以用矩阵快速幂优化计算从第$1$块的$i$位置走到最后一块的$j$位置的方案数。 然后乘上$1$走到第一块位置$i$的方案数就可以算出答案了。