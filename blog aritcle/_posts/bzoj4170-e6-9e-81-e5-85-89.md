---
title: " BZOJ4170极光\t\t"
tags:
  - CDQ分治
  - 思路
url: 6680.html
id: 6680
categories:
  - BZOJ
  - Solution
date: 2019-02-25 17:58:13
---

将$(i,A\[i\])$看成平面上的一个点，那么两个位置的$graze$就相当于两点的曼哈顿距离。 那么询问就是查询与$(x,A\[x\])$距离$\\leq k$的点的个数。 放在二维平面上看就是一个菱形里的点的个数。 菱形比较难计算，我们考虑将它转成正方形。 将曼哈顿距离换成切比雪夫距离，就变成了正方形。 具体地，将$(x,y)$变成$(x+y,x-y)$即可。 那么现在问题就是查询一个正方形区域里的点的个数了。 可以用K-D Tree。 也可以看成三维偏序（时间，$x$坐标，$y$坐标三维），然后CDQ分治即可。