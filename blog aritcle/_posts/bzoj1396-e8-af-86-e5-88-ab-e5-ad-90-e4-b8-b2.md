---
title: " BZOJ1396识别子串\t\t"
tags:
  - 后缀自动机
  - 线段树
url: 5744.html
id: 5744
categories:
  - BZOJ
  - Solution
date: 2018-12-23 15:02:23
---

只有在$S$中只出现一次的串能成为识别子串。 考虑建出$S$的后缀自动机，那么只有在后缀自动机上right集合大小为$1$的点对应的串才能成为识别子串。 对于一个right集合大小为$1$的点，不妨记它在$S$中对应的串为右端点在$p$，左端点在区间$\[l,r\]$的子串。 考虑这$r-l+1$个子串会对答案的影响。 首先，第$r+1$位到第$p$位的答案可以被更新成$p-r+1$。 其次，对于$x\\in\[l,r\]$，第$x$位的答案可以被更新成$p-x+1$。 第一种情况是区间取$\\min$的操作，很容易用线段树完成。 第二种情况，我们只要对位置$x$维护$p+1$的最小值即可。那么这同样变成了区间取$\\min$的操作，也用线段树完成即可。